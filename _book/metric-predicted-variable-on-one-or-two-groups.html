<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>16 Metric-Predicted Variable on One or Two Groups | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="16 Metric-Predicted Variable on One or Two Groups | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="16 Metric-Predicted Variable on One or Two Groups | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="overview-of-the-generalized-linear-model.html"/>
<link rel="next" href="metric-predicted-variable-with-one-metric-predictor.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#weve-come-so-far"><i class="fa fa-check"></i>We’ve come so far!</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-20"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#reference-21"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#reference-22"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#reference-23"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reference-24"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metric-predicted-variable-on-one-or-two-groups" class="section level1">
<h1><span class="header-section-number">16</span> Metric-Predicted Variable on One or Two Groups</h1>
<blockquote>
<p>In the context of the generalized linear model (GLM) introduced in the previous chapter, this chapter’s situation involves the most trivial cases of the linear core of the GLM, as indicated in the left cells of Table 15.1 (p. 434), with a link function that is the identity along with a normal distribution for describing noise in the data, as indicated in the first row of Table 15.2 (p. 443). We will explore options for the prior distribution on parameters of the normal distribution, and methods for Bayesian estimation of the parameters. We will also consider alternative noise distributions for describing data that have outliers. (pp. 449–450)</p>
</blockquote>
<p>Although I agree this chapter covers the “most trivial cases of the linear core of the GLM”, Kruschke’s underselling himself a bit, here. In addition to “trivial” Gaussian models, Kruschke went well beyond and introduced robust Student’s <span class="math inline">\(t\)</span> modeling. It’s a testament to Kruschke’s rigorous approach that he did so so early in the text. IMO, we could use more robust Student’s <span class="math inline">\(t\)</span> models in the social sciences. So heed well, friends.</p>
<div id="estimating-the-mean-and-standard-deviation-of-a-normal-distribution" class="section level2">
<h2><span class="header-section-number">16.1</span> Estimating the mean and standard deviation of a normal distribution</h2>
<p>The Gaussian probability density function follows the form</p>
<p><span class="math display">\[p(y | \mu, \sigma) = \frac{1}{\sigma \sqrt{2 \pi}} \exp \Bigg (-\frac{1}{2} \frac{(y - \mu)^2}{\sigma^2} \Bigg ),\]</span></p>
<p>where the two parameters to estimate are <span class="math inline">\(\mu\)</span> (i.e., the mean) and <span class="math inline">\(\sigma\)</span> (i.e., the standard deviation). If you prefer to think in terms of <span class="math inline">\(\sigma^2\)</span>, that’s the variance. In case is wasn’t clear, <span class="math inline">\(\pi\)</span> is the actual number <span class="math inline">\(\pi\)</span>, not a parameter to be estimated.</p>
<p>We’ll divide Figure 16.1 into data and plot steps. I came up with the primary data like so:</p>
<div class="sourceCode" id="cb1269"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1269-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1269-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1269-3" data-line-number="3">sequence_length &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1269-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1269-5" data-line-number="5">d &lt;-</a>
<a class="sourceLine" id="cb1269-6" data-line-number="6"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">y     =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">50</span>, <span class="dt">to =</span> <span class="dv">150</span>, <span class="dt">length.out =</span> sequence_length),</a>
<a class="sourceLine" id="cb1269-7" data-line-number="7">           <span class="dt">mu    =</span> <span class="kw">c</span>(<span class="fl">87.8</span>, <span class="dv">100</span>, <span class="dv">112</span>),</a>
<a class="sourceLine" id="cb1269-8" data-line-number="8">           <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="fl">7.35</span>, <span class="fl">12.2</span>, <span class="fl">18.4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1269-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(y, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma),</a>
<a class="sourceLine" id="cb1269-10" data-line-number="10">         <span class="dt">mu      =</span> <span class="kw">factor</span>(mu, <span class="dt">labels =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu==&quot;</span>, <span class="kw">c</span>(<span class="fl">87.8</span>, <span class="dv">100</span>, <span class="dv">112</span>))),</a>
<a class="sourceLine" id="cb1269-11" data-line-number="11">         <span class="dt">sigma   =</span> <span class="kw">factor</span>(sigma, <span class="dt">labels =</span> <span class="kw">str_c</span>(<span class="st">&quot;sigma==&quot;</span>, <span class="kw">c</span>(<span class="fl">7.35</span>, <span class="fl">12.2</span>, <span class="fl">18.4</span>))))</a>
<a class="sourceLine" id="cb1269-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1269-13" data-line-number="13"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##       y mu       sigma        density
##   &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;          &lt;dbl&gt;
## 1    50 mu==87.8 sigma==7.35 9.80e- 8
## 2    50 mu==87.8 sigma==12.2 2.69e- 4
## 3    50 mu==87.8 sigma==18.4 2.63e- 3
## 4    50 mu==100  sigma==7.35 4.85e-12
## 5    50 mu==100  sigma==12.2 7.37e- 6
## 6    50 mu==100  sigma==18.4 5.40e- 4</code></pre>
<p>Instead of putting the coordinates for the three data points in our <code>d</code> tibble, I just threw them into their own tibble in the <code>geom_point()</code> function.</p>
<div class="sourceCode" id="cb1271"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1271-1" data-line-number="1"><span class="co"># here we suppress grid lines for all plots in this chapter</span></a>
<a class="sourceLine" id="cb1271-2" data-line-number="2"><span class="kw">theme_set</span>(<span class="kw">theme_grey</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-3" data-line-number="3"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a>
<a class="sourceLine" id="cb1271-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1271-5" data-line-number="5"><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb1271-6" data-line-number="6">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1271-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> density),</a>
<a class="sourceLine" id="cb1271-9" data-line-number="9">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(<span class="dv">85</span>, <span class="dv">100</span>, <span class="dv">115</span>), </a>
<a class="sourceLine" id="cb1271-11" data-line-number="11">             <span class="dt">linetype =</span> <span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">85</span>, <span class="dv">100</span>, <span class="dv">115</span>)),</a>
<a class="sourceLine" id="cb1271-13" data-line-number="13">             <span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1271-14" data-line-number="14">             <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;p(y|&quot;</span>, mu, <span class="st">&quot;, &quot;</span>, sigma, <span class="st">&quot;)&quot;</span>)), <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-16" data-line-number="16"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Competing Gaussian likelihoods given the same data&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-17" data-line-number="17"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">60</span><span class="op">:</span><span class="dv">140</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1271-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_grid</span>(sigma <span class="op">~</span><span class="st"> </span>mu, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /></p>
<div id="solution-by-mathematical-analysis-heads-up-on-precision." class="section level3">
<h3><span class="header-section-number">16.1.1</span> <del>Solution by mathematical analysis</del> Heads up on precision.</h3>
<p>Not much for us, here. But we might reiterate that sometimes we talk about the <em>precision</em> (see page 453), which is the reciprocal of the variance (i.e., <span class="math inline">\(\frac{1}{\sigma^2}\)</span>). As we’ll see, the <strong>brms</strong> package doesn’t use priors parameterized in terms of precision. But JAGS does, which means we’ll need to be able to translate Kruschke’s precision-laden JAGS code into <span class="math inline">\(\sigma\)</span>-oriented <strong>brms</strong> code in many of the remaining chapters. Proceed with caution.</p>
</div>
<div id="approximation-by-mcmc-in-jags-hmc-in-brms." class="section level3">
<h3><span class="header-section-number">16.1.2</span> Approximation by <del>MCMC in JAGS</del> HMC in brms.</h3>
<p>Let’s load and <code>glimpse()</code> at the data.</p>
<div class="sourceCode" id="cb1272"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1272-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/TwoGroupIQ.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1272-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1272-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 120
## Variables: 2
## $ Score &lt;dbl&gt; 102, 107, 92, 101, 110, 68, 119, 106, 99, 103, 90, 93, 79, 89, 137, 119, 126, 110, …
## $ Group &lt;chr&gt; &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;,…</code></pre>
<p>The data file included values from two groups.</p>
<div class="sourceCode" id="cb1274"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1274-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1274-2" data-line-number="2"><span class="st">  </span><span class="kw">distinct</span>(Group)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 1
##   Group     
##   &lt;chr&gt;     
## 1 Smart Drug
## 2 Placebo</code></pre>
<p>Kruschke clarified that for the following example, “the data are IQ (intelligence quotient) scores from a group of people who have consumed a ‘smart drug’” (p. 456). That means we’ll want to subset the data.</p>
<div class="sourceCode" id="cb1276"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1276-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1276-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1276-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(Group <span class="op">==</span><span class="st"> &quot;Smart Drug&quot;</span>)</a></code></pre></div>
<p>It’s a good idea to take a look at the data before modeling.</p>
<div class="sourceCode" id="cb1277"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1277-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1277-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Score)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1277-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1277-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_rug</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1277-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1277-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;The ticks show individual data points.&quot;</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /></p>
<p>Here are the mean and <span class="math inline">\(SD\)</span> of the <code>Score</code> data.</p>
<div class="sourceCode" id="cb1278"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1278-1" data-line-number="1">(mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Score))</a></code></pre></div>
<pre><code>## [1] 107.8413</code></pre>
<div class="sourceCode" id="cb1280"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1280-1" data-line-number="1">(sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Score))</a></code></pre></div>
<pre><code>## [1] 25.4452</code></pre>
<p>Those values will come in handy in just a bit. But first, let’s load <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1282"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1282-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>If we want to pass user-defined values into our <code>brm()</code> prior code, we’ll need to define them first in using <code>brms::stanvar()</code>.</p>
<div class="sourceCode" id="cb1283"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1283-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1283-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1283-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a></code></pre></div>
<p>It’s been a while since we used the <code>stanvar()</code> function, so we should review. Though we’ve saved that as <code>stanvars</code>, you could name it whatever you want. The main trick is to them tell <code>brms::brm()</code> about your values in a <code>stanvars</code> statement.</p>
<p>Kruschke mentioned that the “the conventional noncommittal gamma prior [for the precision] has shape and rate constants that are close to zero, such as Sh = 0.01 and R = 0.01” (p. 456). Here’s what that looks like.</p>
<div class="sourceCode" id="cb1284"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1284-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x   =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">12</span>, <span class="dt">by =</span> <span class="fl">.05</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1284-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dgamma</span>(x, <span class="dt">shape =</span> <span class="fl">0.01</span>, <span class="dt">rate =</span> <span class="fl">0.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1284-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1284-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1284-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1284-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sd_y, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1284-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The grey density in the background is the conventional gamma prior for precision.</span><span class="ch">\n</span><span class="st">The dashed vertical line is our precision value.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1284-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1284-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-11-1.png" style="display: block; margin: auto;" /></p>
<p>The thing is, with <strong>brms</strong> we typically estimate <span class="math inline">\(\sigma\)</span> rather than precision. Though gamma is also a feasible prior distribution for <span class="math inline">\(\sigma\)</span>, we won’t use it here. But we won’t be using Kruschke’s uniform prior, either. The Stan team <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">discourages uniform priors for variance parameters</a>, such as our <span class="math inline">\(\sigma\)</span>. I’m not going to get into the details of why, but you’ve got that hyperlink above and the good old <a href="https://mc-stan.org/users/documentation/">Stan User’s Guide</a> if you’d like to dive deeper.</p>
<p>Here we’ll use the half normal. By “half normal,” we mean that the mean is zero and it’s bounded from zero to positive infinity–no negative <span class="math inline">\(\sigma\)</span> values for us! By the “half normal,” we also mean to suggest that smaller values are more credible than those approaching infinity. When working with unstandardized data, an easy default for a weakly-regularizing half normal is to set the <span class="math inline">\(\sigma\)</span> hyperparameter (i.e., <em>S</em>) to the standard deviation of the criterion variable (i.e., <span class="math inline">\(s_Y\)</span>). Here’s that that looks like for this example.</p>
<div class="sourceCode" id="cb1285"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1285-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x   =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">110</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1285-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sd_y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1285-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1285-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1285-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1285-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> sd_y, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1285-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1285-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The gray density in the background is the half-normal prior for sigma.</span><span class="ch">\n</span><span class="st">The dashed vertical line is our &#39;sd_y&#39; value.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1285-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">100</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /></p>
<p>This prior isn’t quite as non-committal as the conventional gamma prior for precision. It discourages the HMC algorithm from exploring <span class="math inline">\(\sigma\)</span> values much larger than two or three times the standard deviation in the data themselves. In practice, I’ve found it to have a minimal influence on the posterior. If you’d like to make it even less committal, try setting that <span class="math inline">\(\sigma\)</span> hyperparameter to some multiple of <span class="math inline">\(s_Y\)</span> like <span class="math inline">\(2 \times s_Y\)</span> or <span class="math inline">\(10 \times s_Y\)</span>. Compare this to Kruschke’s recommendations for setting a noncommittal uniform prior for <span class="math inline">\(\sigma\)</span>. When using the uniform distribution, <span class="math inline">\(\operatorname{uniform} (L, H)\)</span>,</p>
<blockquote>
<p>we will set the high value <span class="math inline">\(H\)</span> of the uniform prior on <span class="math inline">\(\sigma\)</span> to a huge multiple of the standard deviation in the data, and set the low value <span class="math inline">\(L\)</span> to a tiny fraction of the standard deviation in the data. Again, this means that the prior is vague no matter what the scale of the data happens to be. (p. 455)</p>
</blockquote>
<p>On page 456, Kruschke gave an example of such a uniform prior with the code snip <code>dunif( sdY/1000 , sdY*1000 )</code>. Here’s what that would look like with our data.</p>
<div class="sourceCode" id="cb1286"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1286-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x   =</span> <span class="dv">0</span><span class="op">:</span>(sd_y <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1286-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dunif</span>(x, <span class="dt">min =</span> sd_y <span class="op">/</span><span class="st"> </span><span class="dv">1000</span>, <span class="dt">max =</span> sd_y <span class="op">*</span><span class="st"> </span><span class="dv">1000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1286-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1286-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1286-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1286-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> sd_y, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1286-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1286-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The gray density in the background is Kruschke&#39;s uniform prior for sigma.</span><span class="ch">\n</span><span class="st">The dashed vertical line is our &#39;sd_y&#39; value.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1286-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>()</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /></p>
<p>That’s really noncommittal. I’ll stick with my half normal. You do you. Kruschke has this to say about the prior for the mean:</p>
<blockquote>
<p>In this application we seek broad priors relative to typical data, so that the priors have minimal influence on the posterior. One way to discover the constants is by asking an expert in the domain being studied. But in lieu of that, we will use the data themselves to tell us what the typical scale of the data is. We will set <span class="math inline">\(M\)</span> to the mean of the data, and set <span class="math inline">\(S\)</span> to a huge multiple (e.g., 100) of the standard deviation of the data. This way, no matter what the scale of the data is, the prior will be vague. (p. 455)</p>
</blockquote>
<p>In case you’re not following along closely in the text, we often use the normal distribution for the intercept and slope parameters in a simple regression model. By <span class="math inline">\(M\)</span> and <span class="math inline">\(S\)</span>, Kruschke was referring to the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> parameters of the normal prior for our intercept. Here’s what that prior looks like in this data example.</p>
<div class="sourceCode" id="cb1287"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1287-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-10000</span>, <span class="dt">to =</span> <span class="dv">10000</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1287-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dnorm</span>(x, <span class="dt">mean =</span> mean_y, <span class="dt">sd =</span> sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1287-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1287-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1287-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1287-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> mean_y, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1287-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1287-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;The grey density in the background is the normal prior for mu.</span><span class="ch">\n</span><span class="st">The dashed vertical line is our &#39;mean_y&#39; value.&quot;</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-14-1.png" style="display: block; margin: auto;" /></p>
<p>Yep, Kruschke’s right. That is one non-committal prior given our data. We could tighten that up by an order of magnitude and still have little influence on the posterior. Anyway, here’s how to put our priors to use with <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1288"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1288-1" data-line-number="1">fit16<span class="fl">.1</span> &lt;-</a>
<a class="sourceLine" id="cb1288-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1288-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1288-4" data-line-number="4">      Score <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1288-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1288-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1288-7" data-line-number="7">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1288-8" data-line-number="8">      <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb1288-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb1288-10" data-line-number="10">      <span class="dt">file =</span> <span class="st">&quot;fits/fit16.01&quot;</span>)</a></code></pre></div>
<p>To be more explicit, the <code>stanvars = stanvars</code> argument at the bottom of our code is what allowed us to define our intercept prior as <code>normal(mean_y, sd_y * 100)</code> instead of requiring us to type in the parameters as <code>normal(107.8413, 25.4452 * 100)</code>. The same basic point goes for our <span class="math inline">\(\sigma\)</span> prior.</p>
<p>Also, notice our prior code for <span class="math inline">\(\sigma\)</span>, <code>prior(normal(0, sd_y), class = sigma)</code>. Nowhere in there did we actually say we wanted a half normal as opposed to a typical normal. That’s because the <strong>brms</strong> default is to set the lower bound for priors of <code>class = sigma</code> to zero. There’s no need for us to fiddle with it.</p>
<p>Let’s examine the chains.</p>
<div class="sourceCode" id="cb1289"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1289-1" data-line-number="1"><span class="kw">plot</span>(fit16<span class="fl">.1</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-15-1.png" style="display: block; margin: auto;" /></p>
<p>They look good! The model summary looks sensible, too.</p>
<div class="sourceCode" id="cb1290"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1290-1" data-line-number="1"><span class="kw">print</span>(fit16<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Score ~ 1 
##    Data: my_data (Number of observations: 63) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   107.78      3.32   101.05   114.23 1.00     3269     2484
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    25.78      2.33    21.66    30.88 1.00     3315     2518
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Compare those values with <code>mean_y</code> and <code>sd_y</code>.</p>
<div class="sourceCode" id="cb1292"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1292-1" data-line-number="1">mean_y</a></code></pre></div>
<pre><code>## [1] 107.8413</code></pre>
<div class="sourceCode" id="cb1294"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1294-1" data-line-number="1">sd_y</a></code></pre></div>
<pre><code>## [1] 25.4452</code></pre>
<p>Good times. Let’s extract the posterior draws and save them in a data frame <code>post</code>.</p>
<div class="sourceCode" id="cb1296"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1296-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit16<span class="fl">.1</span>, <span class="dt">add_chain =</span> T)</a></code></pre></div>
<p>Here’s the leg work required to make our version of the three histograms in Figure 16.3.</p>
<div class="sourceCode" id="cb1297"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1297-1" data-line-number="1"><span class="co"># we&#39;ll need this for `stat_pointintervalh()`</span></a>
<a class="sourceLine" id="cb1297-2" data-line-number="2"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb1297-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1297-4" data-line-number="4"><span class="co"># we&#39;ll use this to mark off the ROPEs as white strips in the background</span></a>
<a class="sourceLine" id="cb1297-5" data-line-number="5">rope &lt;-</a>
<a class="sourceLine" id="cb1297-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">key  =</span> <span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Standard Deviation&quot;</span>, <span class="st">&quot;Effect Size&quot;</span>), </a>
<a class="sourceLine" id="cb1297-7" data-line-number="7">         <span class="dt">xmin =</span> <span class="kw">c</span>(<span class="dv">99</span>, <span class="dv">14</span>, <span class="fl">-.1</span>),</a>
<a class="sourceLine" id="cb1297-8" data-line-number="8">         <span class="dt">xmax =</span> <span class="kw">c</span>(<span class="dv">101</span>, <span class="dv">16</span>, <span class="fl">.1</span>))</a>
<a class="sourceLine" id="cb1297-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1297-10" data-line-number="10"><span class="co"># here are the primary data</span></a>
<a class="sourceLine" id="cb1297-11" data-line-number="11">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1297-12" data-line-number="12"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Mean                 =</span> b_Intercept, </a>
<a class="sourceLine" id="cb1297-13" data-line-number="13">            <span class="st">`</span><span class="dt">Standard Deviation</span><span class="st">`</span> =<span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1297-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span> =<span class="st"> </span>(Mean <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">/</span><span class="st"> `</span><span class="dt">Standard Deviation</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1297-15" data-line-number="15"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1297-16" data-line-number="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb1297-17" data-line-number="17"><span class="st">  </span><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb1297-18" data-line-number="18"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1297-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> rope,</a>
<a class="sourceLine" id="cb1297-20" data-line-number="20">            <span class="kw">aes</span>(<span class="dt">xmin =</span> xmin, <span class="dt">xmax =</span> xmax,</a>
<a class="sourceLine" id="cb1297-21" data-line-number="21">                <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb1297-22" data-line-number="22">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1297-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value),</a>
<a class="sourceLine" id="cb1297-24" data-line-number="24">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1297-25" data-line-number="25">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1297-26" data-line-number="26"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1297-27" data-line-number="27">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1297-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1297-29" data-line-number="29"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1297-30" data-line-number="30"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /></p>
<p>If we wanted those exact 95% HDIs, we’d execute this.</p>
<div class="sourceCode" id="cb1298"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1298-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Mean                 =</span> b_Intercept, </a>
<a class="sourceLine" id="cb1298-3" data-line-number="3">            <span class="st">`</span><span class="dt">Standard Deviation</span><span class="st">`</span> =<span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span> =<span class="st"> </span>(Mean <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">/</span><span class="st"> `</span><span class="dt">Standard Deviation</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-5" data-line-number="5"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1298-7" data-line-number="7"><span class="st">  </span><span class="kw">mode_hdi</span>(value)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 7
##   key                  value   .lower  .upper .width .point .interval
##   &lt;chr&gt;                &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 Effect Size          0.299   0.0510   0.566   0.95 mode   hdi      
## 2 Mean               108.    102.     115.      0.95 mode   hdi      
## 3 Standard Deviation  25.4    21.3     30.4     0.95 mode   hdi</code></pre>
<p>For the next part, we should look at the structure of the posterior draws, <code>post</code>.</p>
<div class="sourceCode" id="cb1300"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1300-1" data-line-number="1"><span class="kw">head</span>(post)</a></code></pre></div>
<pre><code>##   b_Intercept    sigma      lp__ chain iter
## 1    104.4952 27.43337 -303.1645     1 1001
## 2    109.1532 23.62915 -302.6664     1 1002
## 3    105.2486 23.75718 -302.8977     1 1003
## 4    102.3687 26.10857 -303.7315     1 1004
## 5    111.5466 24.77262 -303.0047     1 1005
## 6    109.2983 22.53756 -303.2961     1 1006</code></pre>
<p>By default, <code>head()</code> returned six rows, each one corresponding to the credible parameter values from a given posterior draw. Following our model equation <span class="math inline">\(\text{Score}_i \sim N(\mu, \sigma)\)</span>, we might reformat the first two columns as:</p>
<ol style="list-style-type: decimal">
<li><code>Score</code> ~ <span class="math inline">\(N\)</span>(104.495, 27.433)</li>
<li><code>Score</code> ~ <span class="math inline">\(N\)</span>(109.153, 23.629)</li>
<li><code>Score</code> ~ <span class="math inline">\(N\)</span>(105.249, 23.757)</li>
<li><code>Score</code> ~ <span class="math inline">\(N\)</span>(102.369, 26.109)</li>
<li><code>Score</code> ~ <span class="math inline">\(N\)</span>(111.547, 24.773)</li>
<li><code>Score</code> ~ <span class="math inline">\(N\)</span>(109.298, 22.538)</li>
</ol>
<p>Each row of <code>post</code> yields a full model equation with which we might credibly describe the data–or at least as credibly as we can within the limits of the model. We can give voice to a subset of these credible distributions with our version of the upper right panel of Figure 16.3.</p>
<p>Before I show that plotting code, it might make sense to slow down on the preparatory data wrangling steps. There are several ways to overlay multiple posterior predictive density lines like those in our upcoming plots. We’ll practice a few over the next few chapters. For the method we’ll use in this chapter, it’s handy to first determine how many you’d like. Here we’ll follow Kruschke and choose 63, which we’ll save as <code>n_lines</code>.</p>
<div class="sourceCode" id="cb1302"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1302-1" data-line-number="1"><span class="co"># how many credible density lines would you like?</span></a>
<a class="sourceLine" id="cb1302-2" data-line-number="2">n_lines &lt;-<span class="st"> </span><span class="dv">63</span></a></code></pre></div>
<p>Now we’ve got our <code>n_lines</code> value, we’ll use it to subset the rows in <code>post</code> with the <code>slice()</code> function. We’ll then use <code>expand()</code> to include a sequence of <code>Score</code> values to correspond to the formula implied in each of the remaining rows of <code>post</code>. Notice how we also kept the <code>iter</code> index in the game. That will help us with the plot in a bit. But the main event is how we used <code>Score</code>, <code>b_Intercept</code>, and <code>sigma</code> as the input for the arguments in the <code>dnorm()</code>. The output is a column of the corresponding density values.</p>
<div class="sourceCode" id="cb1303"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1303-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb1303-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1303-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span>n_lines) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1303-4" data-line-number="4"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(b_Intercept, sigma, iter),</a>
<a class="sourceLine" id="cb1303-5" data-line-number="5">         <span class="dt">Score =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">40</span>, <span class="dt">to =</span> <span class="dv">250</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1303-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(<span class="dt">x =</span> Score, <span class="dt">mean =</span> b_Intercept, <span class="dt">sd =</span> sigma))</a>
<a class="sourceLine" id="cb1303-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1303-8" data-line-number="8"><span class="kw">str</span>(post)</a></code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    13293 obs. of  5 variables:
##  $ b_Intercept: num  99.3 99.3 99.3 99.3 99.3 ...
##  $ sigma      : num  26.1 26.1 26.1 26.1 26.1 ...
##  $ iter       : num  1008 1008 1008 1008 1008 ...
##  $ Score      : num  40 41 42 43 44 45 46 47 48 49 ...
##  $ density    : num  0.00115 0.00126 0.00137 0.00149 0.00162 ...</code></pre>
<p>Note that after using <code>expand()</code>, we have a rather long data frame. Anyway, we’re ready to plot.</p>
<div class="sourceCode" id="cb1305"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1305-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1305-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Score)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1305-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1305-4" data-line-number="4">                 <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb1305-5" data-line-number="5">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1305-6" data-line-number="6">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1305-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> density, <span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1305-8" data-line-number="8">            <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey25&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1305-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">50</span>, <span class="dv">210</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1305-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1305-11" data-line-number="11"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with Post. Pred.&quot;</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-24-1.png" style="display: block; margin: auto;" /></p>
<p>Note the <code>stat(density)</code> argument in the <code>geom_histogram()</code> function. That’s what rescaled the histogram to the density metric. If you leave that part out, all the density lines will drop to the bottom of the plot. Also, did you see how we used <code>iter</code> to group the density lines within the <code>geom_line()</code> function? That’s why we kept that information. Without that <code>group = iter</code> argument, the resulting lines are a mess.</p>
<p>Kruschke pointed out this last plot</p>
<blockquote>
<p>constitutes a form of posterior-predictive check, by which we check whether the model appears to be a reasonable description of the data. With such a small amount of data, it is difficult to visually assess whether normality is badly violated, but there appears to be a hint that the normal model is straining to accommodate some outliers: The peak of the data protrudes prominently above the normal curves, and there are gaps under the shoulders of the normal curves. (p. 458)</p>
</blockquote>
<p>We can perform a similar posterior-predictive check with the <code>brms::pp_check()</code> function. By default, it will return 10 simulated density lines. Like we did above, we’ll increase that by setting the <code>nsamples</code> argument to our <code>n_lines</code> value.</p>
<div class="sourceCode" id="cb1306"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1306-1" data-line-number="1"><span class="kw">pp_check</span>(fit16<span class="fl">.1</span>, <span class="dt">nsamples =</span> n_lines)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-25-1.png" style="display: block; margin: auto;" /></p>
<p>Before we move on, we should talk a little about effect sizes, which we all but glossed over in our code.</p>
<blockquote>
<p><em>Effect size</em> is simply the amount of change induced by the treatment relative to the standard deviation: <span class="math inline">\((\mu - 100) / \sigma\)</span>. In other words, the effect size is the “standardized” change… A conventionally “small” effect size in psychological research is 0.2 (<a href="https://www.taylorfrancis.com/books/9780203771587">Cohen, 1988</a>), and the ROPE limits are set at half that size for purposed of illustration. (p. 457, <em>emphasis</em> in the original).</p>
</blockquote>
<p>Another way to describe this kind of effect size is as a <em>standardized mean difference</em>. In addition to the seminal work by Cohen, you might brush up on effect sizes with Kelley and Preacher’s (2012) <a href="https://www3.nd.edu/~kkelley/publications/articles/Kelley_and_Preacher_Psychological_Methods_2012.pdf"><em>On effect size</em></a>.</p>
</div>
</div>
<div id="outliers-and-robust-estimation-the-t-distribution" class="section level2">
<h2><span class="header-section-number">16.2</span> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</h2>
<p>Here’s the code for our version of Figure 16.4.</p>
<div class="sourceCode" id="cb1307"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1307-1" data-line-number="1"><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb1307-2" data-line-number="2"><span class="kw">crossing</span>(<span class="dt">nu =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1307-3" data-line-number="3">         <span class="dt">y  =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">8</span>, <span class="dt">length.out =</span> <span class="dv">500</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1307-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dt</span>(<span class="dt">x =</span> y, <span class="dt">df =</span> nu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1307-5" data-line-number="5"><span class="st">  </span><span class="co"># this line is unnecessary, but will help with the plot legend</span></a>
<a class="sourceLine" id="cb1307-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">nu =</span> <span class="kw">factor</span>(nu, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Inf&quot;</span>, <span class="st">&quot;4&quot;</span>, <span class="st">&quot;2&quot;</span>, <span class="st">&quot;1&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1307-7" data-line-number="7"><span class="st">  </span></a>
<a class="sourceLine" id="cb1307-8" data-line-number="8"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1307-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> density, <span class="dt">group =</span> nu, <span class="dt">color =</span> nu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1307-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1307-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="kw">italic</span>(t)[nu])), <span class="dt">option =</span> <span class="st">&quot;B&quot;</span>, <span class="dt">direction =</span> <span class="dv">1</span>, <span class="dt">end =</span> <span class="fl">.8</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1307-12" data-line-number="12"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;p(y)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1307-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1307-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;grey92&quot;</span>),</a>
<a class="sourceLine" id="cb1307-15" data-line-number="15">        <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>),</a>
<a class="sourceLine" id="cb1307-16" data-line-number="16">        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">92</span>, <span class="fl">.75</span>))</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-26-1.png" style="display: block; margin: auto;" /></p>
<blockquote>
<p>Although the <span class="math inline">\(t\)</span> distribution is usually conceived as a sampling distribution for the NHST <span class="math inline">\(t\)</span> test, we will use it instead as a convenient descriptive model of data with outliers… Outliers are simply data values that fall unusually far from a model’s expected value. Real data often contain outliers relative to a normal distribution. Sometimes the anomalous values can be attributed to extraneous influences that can be explicitly identified, in which case the affected data values can be corrected or removed. But usually we have no way of knowing whether a suspected outlying value was caused by an extraneous influence, or is a genuine representation of the target being measured. Instead of deleting suspected outliers from the data according to some arbitrary criterion, we retain all the data but use a noise distribution that is less affected by outliers than is the normal distribution. (p. 459)</p>
</blockquote>
<p>Here’s Figure 16.5.a.</p>
<div class="sourceCode" id="cb1308"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1308-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-10</span>, <span class="dt">to =</span> <span class="dv">20</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1308-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1308-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1308-4" data-line-number="4">                  <span class="dt">ymax =</span> <span class="kw">dnorm</span>(y, <span class="dt">mean =</span> <span class="fl">2.5</span>, <span class="dt">sd =</span> <span class="fl">5.73</span>)),</a>
<a class="sourceLine" id="cb1308-5" data-line-number="5">              <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1308-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1308-7" data-line-number="7">                  <span class="dt">ymax =</span> metRology<span class="op">::</span><span class="kw">dt.scaled</span>(y, <span class="dt">df =</span> <span class="fl">1.14</span>, <span class="dt">mean =</span> <span class="fl">.12</span>, <span class="dt">sd =</span> <span class="fl">1.47</span>)),</a>
<a class="sourceLine" id="cb1308-8" data-line-number="8">              <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1308-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">c</span>(.<span class="dv">12</span>, <span class="fl">2.5</span>), <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1308-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>, <span class="dv">15</span>)),</a>
<a class="sourceLine" id="cb1308-11" data-line-number="11">             <span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1308-12" data-line-number="12">             <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1308-13" data-line-number="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Maximum Likelihood Estimates&quot;</span>,</a>
<a class="sourceLine" id="cb1308-14" data-line-number="14">       <span class="dt">y =</span> <span class="st">&quot;p(y)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1308-15" data-line-number="15"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-5</span><span class="op">:</span><span class="dv">15</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /></p>
<p>I’m not aware that we have the data for the bottom panel of Figure 16.5. However, we can simulate similar data with the <code>rt.scaled()</code> function from the <a href="https://sourceforge.net/projects/metrology/"><strong>metRology</strong> package</a>.</p>
<div class="sourceCode" id="cb1309"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1309-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">145</span>)</a>
<a class="sourceLine" id="cb1309-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1309-3" data-line-number="3"><span class="co"># simulate the data</span></a>
<a class="sourceLine" id="cb1309-4" data-line-number="4">d &lt;-</a>
<a class="sourceLine" id="cb1309-5" data-line-number="5"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">y =</span> metRology<span class="op">::</span><span class="kw">rt.scaled</span>(<span class="dt">n =</span> <span class="dv">177</span>, <span class="dt">df =</span> <span class="fl">2.63</span>, <span class="dt">mean =</span> <span class="fl">1.11</span>, <span class="dt">sd =</span> <span class="fl">0.15</span>))</a>
<a class="sourceLine" id="cb1309-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1309-7" data-line-number="7"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1309-8" data-line-number="8"><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">12</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1309-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1309-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb1309-11" data-line-number="11">                 <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb1309-12" data-line-number="12">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1309-13" data-line-number="13">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="fl">.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1309-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">dnorm</span>(y, <span class="dt">mean =</span> <span class="fl">1.16</span>, <span class="dt">sd =</span> <span class="fl">0.63</span>)),</a>
<a class="sourceLine" id="cb1309-15" data-line-number="15">              <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1309-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> metRology<span class="op">::</span><span class="kw">dt.scaled</span>(y, <span class="dt">df =</span> <span class="fl">2.63</span>, <span class="dt">mean =</span> <span class="fl">1.11</span>, <span class="dt">sd =</span> <span class="fl">0.15</span>)),</a>
<a class="sourceLine" id="cb1309-17" data-line-number="17">              <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1309-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-2</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1309-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Maximum Likelihood Estimates&quot;</span>,</a>
<a class="sourceLine" id="cb1309-20" data-line-number="20">       <span class="dt">y =</span> <span class="st">&quot;p(y)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1309-21" data-line-number="21"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">10.25</span>))</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /></p>
<p>In case you were curious, this is how I selected the seed for the plot. Run the code yourself to get a sense of how it works.</p>
<div class="sourceCode" id="cb1310"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1310-1" data-line-number="1"><span class="co"># in the R Notebook code block settings, I used: fig.width = 2, fig.height = 8</span></a>
<a class="sourceLine" id="cb1310-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1310-3" data-line-number="3">t_maker &lt;-<span class="st"> </span><span class="cf">function</span>(seed) {</a>
<a class="sourceLine" id="cb1310-4" data-line-number="4">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb1310-5" data-line-number="5">  <span class="kw">tibble</span>(<span class="dt">y =</span> metRology<span class="op">::</span><span class="kw">rt.scaled</span>(<span class="dt">n =</span> <span class="dv">177</span>, <span class="dt">df =</span> <span class="fl">2.63</span>, <span class="dt">mean =</span> <span class="fl">1.11</span>, <span class="dt">sd =</span> <span class="fl">0.15</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1310-6" data-line-number="6"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">min =</span> <span class="kw">min</span>(y),</a>
<a class="sourceLine" id="cb1310-7" data-line-number="7">              <span class="dt">max =</span> <span class="kw">max</span>(y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1310-8" data-line-number="8"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">spread =</span> max <span class="op">-</span><span class="st"> </span>min)</a>
<a class="sourceLine" id="cb1310-9" data-line-number="9">}</a>
<a class="sourceLine" id="cb1310-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1310-11" data-line-number="11"><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1310-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">t =</span> <span class="kw">map</span>(seed, t_maker)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1310-13" data-line-number="13"><span class="st">  </span><span class="kw">unnest</span>(t) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1310-14" data-line-number="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb1310-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">reorder</span>(seed, spread), <span class="dt">ymin =</span> min, <span class="dt">ymax =</span> max)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1310-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1310-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_linerange</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1310-18" data-line-number="18"><span class="st">  </span><span class="kw">coord_flip</span>()</a></code></pre></div>
<blockquote>
<p>It is important to understand that the scale parameter <span class="math inline">\(\sigma\)</span> in the <span class="math inline">\(t\)</span> distribution is not the standard deviation of the distribution. (Recall that the standard deviation is the square root of the variance, which is the expected value of the squared deviation from the mean, as defined back in Equation 4.8, p. 86.) The standard deviation is actually larger than <span class="math inline">\(\sigma\)</span> because of the heavy tails… While this value of the scale parameter is not the standard deviation of the distribution, it does have an intuitive relation to the spread of the data. Just as the range <span class="math inline">\(\pm \sigma\)</span> covers the middle 68% of a <em>normal</em> distribution, the range <span class="math inline">\(\pm \sigma\)</span> covers the middle 58% of a <span class="math inline">\(t\)</span> distribution when <span class="math inline">\(\nu = 2\)</span>, and the middle 50% when <span class="math inline">\(\nu = 1\)</span>. These areas are illustrated in the left column of Figure 16.6. The right column of Figure 16.6 shows the width under the middle of a <span class="math inline">\(t\)</span> distribution that is needed to span 68.27% of the distribution, which is the area under a normal distribution for <span class="math inline">\(\sigma = \pm 1\)</span>. (pp. 460–461, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Speaking of which, here’s the code for the left column for Figure 16.6.</p>
<div class="sourceCode" id="cb1311"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1311-1" data-line-number="1"><span class="co"># the primary data</span></a>
<a class="sourceLine" id="cb1311-2" data-line-number="2">d &lt;-</a>
<a class="sourceLine" id="cb1311-3" data-line-number="3"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">y  =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">8</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>),</a>
<a class="sourceLine" id="cb1311-4" data-line-number="4">           <span class="dt">nu =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1311-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">str_c</span>(<span class="st">&quot;nu == &quot;</span>, nu) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1311-6" data-line-number="6"><span class="st">           </span><span class="kw">factor</span>(., <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;nu == Inf&quot;</span>, <span class="st">&quot;nu == 5&quot;</span>, <span class="st">&quot;nu == 2&quot;</span>, <span class="st">&quot;nu == 1&quot;</span>)))</a>
<a class="sourceLine" id="cb1311-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1311-8" data-line-number="8"><span class="co"># the subplot</span></a>
<a class="sourceLine" id="cb1311-9" data-line-number="9">p1 &lt;-</a>
<a class="sourceLine" id="cb1311-10" data-line-number="10"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1311-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dt</span>(y, <span class="dt">df =</span> nu)),</a>
<a class="sourceLine" id="cb1311-13" data-line-number="13">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1311-15" data-line-number="15"><span class="st">                </span><span class="kw">filter</span>(y <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-1</span> <span class="op">&amp;</span><span class="st"> </span>y <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1311-16" data-line-number="16">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dt</span>(y, <span class="dt">df =</span> nu)),</a>
<a class="sourceLine" id="cb1311-17" data-line-number="17">              <span class="dt">fill =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-18" data-line-number="18"><span class="st">  </span><span class="co"># note how this function has its own data</span></a>
<a class="sourceLine" id="cb1311-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb1311-20" data-line-number="20">    <span class="dt">y     =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1311-21" data-line-number="21">    <span class="dt">text  =</span> <span class="kw">c</span>(<span class="st">&quot;68%&quot;</span>, <span class="st">&quot;64%&quot;</span>, <span class="st">&quot;58%&quot;</span>, <span class="st">&quot;50%&quot;</span>),</a>
<a class="sourceLine" id="cb1311-22" data-line-number="22">    <span class="dt">label =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;nu == Inf&quot;</span>, <span class="st">&quot;nu == 5&quot;</span>, <span class="st">&quot;nu == 2&quot;</span>, <span class="st">&quot;nu == 1&quot;</span>))),</a>
<a class="sourceLine" id="cb1311-23" data-line-number="23">    <span class="kw">aes</span>(<span class="dt">y =</span> <span class="fl">.175</span>, <span class="dt">label =</span> text),</a>
<a class="sourceLine" id="cb1311-24" data-line-number="24">    <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-25" data-line-number="25"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;p(y)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.2</span>, <span class="fl">.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-26" data-line-number="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Shaded from y = - 1 to y = 1&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-27" data-line-number="27"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1311-28" data-line-number="28"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>label, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p>Here’s the code for the right column.</p>
<div class="sourceCode" id="cb1312"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1312-1" data-line-number="1"><span class="co"># the primary data</span></a>
<a class="sourceLine" id="cb1312-2" data-line-number="2">d &lt;-</a>
<a class="sourceLine" id="cb1312-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">nu   =</span> <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1312-4" data-line-number="4">         <span class="dt">ymin =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1.84</span>, <span class="fl">-1.32</span>, <span class="fl">-1.11</span>, <span class="dv">-1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1312-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ymax =</span> <span class="op">-</span>ymin) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1312-6" data-line-number="6"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(nu, ymin, ymax),</a>
<a class="sourceLine" id="cb1312-7" data-line-number="7">         <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-8</span>, <span class="dt">to =</span> <span class="dv">8</span>, <span class="dt">length.out =</span> <span class="fl">1e3</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1312-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">factor</span>(<span class="kw">str_c</span>(<span class="st">&quot;nu==&quot;</span>, nu), </a>
<a class="sourceLine" id="cb1312-9" data-line-number="9">                        <span class="dt">levels =</span> <span class="kw">str_c</span>(<span class="st">&quot;nu==&quot;</span>, <span class="kw">c</span>(<span class="ot">Inf</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb1312-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1312-11" data-line-number="11"><span class="co"># the subplot</span></a>
<a class="sourceLine" id="cb1312-12" data-line-number="12">p2 &lt;-</a>
<a class="sourceLine" id="cb1312-13" data-line-number="13"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1312-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dt</span>(y, <span class="dt">df =</span> nu)),</a>
<a class="sourceLine" id="cb1312-16" data-line-number="16">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1312-18" data-line-number="18"><span class="st">                </span><span class="co"># notice our `filter()` argument has changed</span></a>
<a class="sourceLine" id="cb1312-19" data-line-number="19"><span class="st">                </span><span class="kw">filter</span>(y <span class="op">&gt;=</span><span class="st"> </span>ymin <span class="op">&amp;</span><span class="st"> </span>y <span class="op">&lt;=</span><span class="st"> </span>ymax),</a>
<a class="sourceLine" id="cb1312-20" data-line-number="20">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dt</span>(y, <span class="dt">df =</span> nu)),</a>
<a class="sourceLine" id="cb1312-21" data-line-number="21">              <span class="dt">fill =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-22" data-line-number="22"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">.175</span>, </a>
<a class="sourceLine" id="cb1312-23" data-line-number="23">           <span class="dt">label =</span> <span class="st">&quot;68%&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-24" data-line-number="24"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;p(y)&quot;</span>, <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.2</span>, <span class="fl">.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-25" data-line-number="25"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Shaded for the middle 68.27%&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-26" data-line-number="26"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-6</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1312-27" data-line-number="27"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>label, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p>Now we’ll bind the two ggplots together with the <strong>patchwork</strong> package to make the full version of Figure 16.6.</p>
<div class="sourceCode" id="cb1313"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1313-1" data-line-number="1"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb1313-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1313-3" data-line-number="3">p1 <span class="op">+</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-32-1.png" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The use of a heavy-tailed distribution is often called <em>robust estimation</em> because the estimated value of the central tendency is stable, that is, “robust,” against outliers. The <span class="math inline">\(t\)</span> distribution is useful as a likelihood function for modeling outliers at the level of observed data. But the <span class="math inline">\(t\)</span> distribution is also useful for modeling outliers at higher levels in a hierarchical prior. We will encounter several applications. (p. 462, <em>emphasis</em> in the original)</p>
</blockquote>
<div id="using-the-t-distribution-in-jags-brms." class="section level3">
<h3><span class="header-section-number">16.2.1</span> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</h3>
<p>It’s easy to use Student’s <span class="math inline">\(t\)</span> in <strong>brms</strong>. Make sure to specify <code>family = student</code>. By default, <strong>brms</strong> already sets the lower bound for <span class="math inline">\(\nu\)</span> to 1. But we do still need to use 1/29. To get a sense, let’s simulate exponential data using the <code>rexp()</code> function. Like Kruschke covered in the text (p. 462), the <code>rexp()</code> function has one parameter, <code>rate</code>, which is the reciprocal of the mean. Here we’ll set the mean to 29.</p>
<div class="sourceCode" id="cb1314"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1314-1" data-line-number="1">n_draws &lt;-<span class="st"> </span><span class="fl">1e7</span></a>
<a class="sourceLine" id="cb1314-2" data-line-number="2">mu      &lt;-<span class="st"> </span><span class="dv">29</span></a>
<a class="sourceLine" id="cb1314-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1314-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb1314-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1314-6" data-line-number="6"><span class="kw">tibble</span>(<span class="dt">y =</span> <span class="kw">rexp</span>(<span class="dt">n =</span> n_draws, <span class="dt">rate =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>mu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1314-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y_at_least_1 =</span> <span class="kw">ifelse</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>, <span class="ot">NA</span>, y)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1314-8" data-line-number="8"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1314-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(key) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1314-10" data-line-number="10"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(value, <span class="dt">na.rm =</span> T))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   key           mean
##   &lt;chr&gt;        &lt;dbl&gt;
## 1 y             29.0
## 2 y_at_least_1  30.0</code></pre>
<p>The simulation showed that when we define the exponential rate as 1/29 and use the typical boundary at 0, the mean of our samples converges to 29. But when we only consider the samples of 1 or greater, the mean converges to 30. Thus, our exponential(1/29) prior with a boundary at 1 is how we get a shifted exponential distribution when we use it as our prior for <span class="math inline">\(\nu\)</span> in <strong>brms</strong>. Just make sure to remember that if you want the mean to be 30, you’ll need to specify the rate of 1/29.</p>
<p>Also, Stan will bark if you simply try to set that exponential prior with the code <code>prior(exponential(1/29), class = nu)</code>:</p>
<blockquote>
<p>DIAGNOSTIC(S) FROM PARSER:
Info: integer division implicitly rounds to integer. Found int division: 1 / 29
Positive values rounded down, negative values rounded up or down in platform-dependent way.</p>
</blockquote>
<p>To avoid this, just do the division beforehand and save the results with <code>stanvar()</code>.</p>
<div class="sourceCode" id="cb1316"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1316-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1316-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1316-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1316-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>,   <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</a></code></pre></div>
<p>Here’s the <code>brm()</code> code. Note that we set the prior for our new <span class="math inline">\(\nu\)</span> parameter by specifying <code>class = nu</code> within the last <code>prior()</code> line.</p>
<div class="sourceCode" id="cb1317"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1317-1" data-line-number="1">fit16<span class="fl">.2</span> &lt;-</a>
<a class="sourceLine" id="cb1317-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1317-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1317-4" data-line-number="4">      Score <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1317-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1317-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1317-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1317-8" data-line-number="8">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1317-9" data-line-number="9">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1317-10" data-line-number="10">      <span class="dt">seed =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb1317-11" data-line-number="11">      <span class="dt">file =</span> <span class="st">&quot;fits/fit16.02&quot;</span>)</a></code></pre></div>
<p>We can make the shifted exponential distribution (i.e., Figure 16.7) with simple addition.</p>
<div class="sourceCode" id="cb1318"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1318-1" data-line-number="1"><span class="co"># how many draws would you like?</span></a>
<a class="sourceLine" id="cb1318-2" data-line-number="2">n_draws &lt;-<span class="st"> </span><span class="fl">1e6</span></a>
<a class="sourceLine" id="cb1318-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1318-4" data-line-number="4"><span class="co"># here are the data</span></a>
<a class="sourceLine" id="cb1318-5" data-line-number="5">d &lt;-</a>
<a class="sourceLine" id="cb1318-6" data-line-number="6"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">exp =</span> <span class="kw">rexp</span>(n_draws, <span class="dt">rate =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">29</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1318-7" data-line-number="7"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">exp_plus_1        =</span> exp <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1318-8" data-line-number="8">            <span class="dt">log_10_exp_plus_1 =</span> <span class="kw">log10</span>(exp <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb1318-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb1318-10" data-line-number="10"><span class="co"># this is the plot in the top panel</span></a>
<a class="sourceLine" id="cb1318-11" data-line-number="11">p1 &lt;-</a>
<a class="sourceLine" id="cb1318-12" data-line-number="12"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1318-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> exp_plus_<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1318-15" data-line-number="15">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-16" data-line-number="16"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1318-17" data-line-number="17">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-19" data-line-number="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">expression</span>(<span class="kw">exponential</span>(lambda<span class="op">==</span><span class="dv">29</span>)<span class="op">~</span>shifted<span class="op">~+</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1318-20" data-line-number="20">       <span class="dt">x =</span> <span class="kw">expression</span>(nu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-21" data-line-number="21"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">150</span>)</a>
<a class="sourceLine" id="cb1318-22" data-line-number="22"></a>
<a class="sourceLine" id="cb1318-23" data-line-number="23"><span class="co"># the bottom panel plot</span></a>
<a class="sourceLine" id="cb1318-24" data-line-number="24">p2 &lt;-</a>
<a class="sourceLine" id="cb1318-25" data-line-number="25"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1318-26" data-line-number="26"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> log_<span class="dv">10</span>_exp_plus_<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-27" data-line-number="27"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1318-28" data-line-number="28">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="fl">.1</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-29" data-line-number="29"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1318-30" data-line-number="30">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-31" data-line-number="31"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-32" data-line-number="32"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">log10</span>(nu))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1318-33" data-line-number="33"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>))</a>
<a class="sourceLine" id="cb1318-34" data-line-number="34"></a>
<a class="sourceLine" id="cb1318-35" data-line-number="35"><span class="co"># bind them together</span></a>
<a class="sourceLine" id="cb1318-36" data-line-number="36">p1 <span class="op">/</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-35-1.png" style="display: block; margin: auto;" /></p>
<p>Here are the scatter plots of Figure 16.8.</p>
<div class="sourceCode" id="cb1319"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1319-1" data-line-number="1"><span class="kw">pairs</span>(fit16<span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb1319-2" data-line-number="2">      <span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>))</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-36-1.png" style="display: block; margin: auto;" /></p>
<p>I’m not aware of an easy way to use <code>log10(nu)</code> instead of <code>nu</code> with <code>brms::pairs()</code>. However, you can get those plots with <code>posterior_samples()</code> and a little wrangling.</p>
<div class="sourceCode" id="cb1320"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1320-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit16<span class="fl">.2</span>)</a>
<a class="sourceLine" id="cb1320-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1320-3" data-line-number="3">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">log10(nu)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">log10</span>(nu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-5" data-line-number="5"><span class="st">  </span><span class="kw">select</span>(b_Intercept, sigma, <span class="st">`</span><span class="dt">log10(nu)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-6" data-line-number="6"><span class="st">  </span><span class="kw">gather</span>(key, value, <span class="op">-</span><span class="st">`</span><span class="dt">log10(nu)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1320-7" data-line-number="7"><span class="st">  </span></a>
<a class="sourceLine" id="cb1320-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">log10(nu)</span><span class="st">`</span>, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1320-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1320-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">log10</span>(nu)),</a>
<a class="sourceLine" id="cb1320-11" data-line-number="11">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1320-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_grid</span>(key<span class="op">~</span>., <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">switch =</span> <span class="st">&quot;y&quot;</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-37-1.png" style="display: block; margin: auto;" /></p>
<p>If you want the Pearson’s correlation coefficients, you can use base <strong>R</strong> <code>cor()</code>.</p>
<div class="sourceCode" id="cb1321"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1321-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1321-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">log10(nu)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">log10</span>(nu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1321-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(b_Intercept, sigma, <span class="st">`</span><span class="dt">log10(nu)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1321-4" data-line-number="4"><span class="st">  </span><span class="kw">cor</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1321-5" data-line-number="5"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##             b_Intercept sigma log10(nu)
## b_Intercept       1.000 0.003     0.008
## sigma             0.003 1.000     0.732
## log10(nu)         0.008 0.732     1.000</code></pre>
<p>The correlations among our parameters are a similar magnitude as those Kruschke presented in the text. Here are four of the panels for Figure 16.9.</p>
<div class="sourceCode" id="cb1323"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1323-1" data-line-number="1"><span class="co"># we&#39;ll use this to mark off the ROPEs as white strips in the background</span></a>
<a class="sourceLine" id="cb1323-2" data-line-number="2">rope &lt;-</a>
<a class="sourceLine" id="cb1323-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">key  =</span> <span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Scale&quot;</span>, <span class="st">&quot;Effect Size&quot;</span>), </a>
<a class="sourceLine" id="cb1323-4" data-line-number="4">         <span class="dt">xmin =</span> <span class="kw">c</span>(<span class="dv">99</span>, <span class="dv">14</span>, <span class="fl">-.1</span>),</a>
<a class="sourceLine" id="cb1323-5" data-line-number="5">         <span class="dt">xmax =</span> <span class="kw">c</span>(<span class="dv">101</span>, <span class="dv">16</span>, <span class="fl">.1</span>))</a>
<a class="sourceLine" id="cb1323-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1323-7" data-line-number="7"><span class="co"># here are the primary data</span></a>
<a class="sourceLine" id="cb1323-8" data-line-number="8">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1323-9" data-line-number="9"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Mean      =</span> b_Intercept, </a>
<a class="sourceLine" id="cb1323-10" data-line-number="10">            <span class="dt">Scale     =</span> sigma,</a>
<a class="sourceLine" id="cb1323-11" data-line-number="11">            <span class="dt">Normality =</span> <span class="kw">log10</span>(nu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1323-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span> =<span class="st"> </span>(Mean <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">/</span><span class="st"> </span>Scale) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1323-13" data-line-number="13"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1323-14" data-line-number="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb1323-15" data-line-number="15"><span class="st">  </span><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb1323-16" data-line-number="16"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1323-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> rope,</a>
<a class="sourceLine" id="cb1323-18" data-line-number="18">            <span class="kw">aes</span>(<span class="dt">xmin =</span> xmin, <span class="dt">xmax =</span> xmax,</a>
<a class="sourceLine" id="cb1323-19" data-line-number="19">                <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb1323-20" data-line-number="20">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1323-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value),</a>
<a class="sourceLine" id="cb1323-22" data-line-number="22">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1323-23" data-line-number="23">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1323-24" data-line-number="24"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1323-25" data-line-number="25">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1323-26" data-line-number="26"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1323-27" data-line-number="27"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1323-28" data-line-number="28"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-39-1.png" style="display: block; margin: auto;" /></p>
<p>For the final panel of Figure 16.9, we’ll make our <span class="math inline">\(t\)</span> lines in much the same way we did, earlier. But last time, we just took the first <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> values from the first 63 rows of the <code>post</code> tibble. This time we’ll use <code>dplyr::sample_n()</code> to take <em>random draws</em> from the <code>post</code> rows instead. We tell <code>sample_n()</code> how many draws we’d like with the <code>size</code> argument. Since <code>sample_n()</code> tells us which rows it drew from in the form of rownames, we then use the <code>tibble::rownames_to_column()</code> function to save those rownames in an actual column named <code>draw</code>–this is the variable we group the lines by in <code>geom_line()</code>.</p>
<p>In addition to the change in our row selection strategy, this time we’ll slightly amend the code within the last <code>mutate()</code> line. Since we’d like to work with the <span class="math inline">\(t\)</span> distribution, we specified <code>metRology::dt.scaled()</code> function instead of <code>dnorm()</code>.</p>
<div class="sourceCode" id="cb1324"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1324-1" data-line-number="1"><span class="co"># how many credible density lines would you like?</span></a>
<a class="sourceLine" id="cb1324-2" data-line-number="2">n_lines &lt;-<span class="st"> </span><span class="dv">63</span></a>
<a class="sourceLine" id="cb1324-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1324-4" data-line-number="4"><span class="co"># setting the seed makes the results from `sample_n()` reproducible</span></a>
<a class="sourceLine" id="cb1324-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb1324-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1324-7" data-line-number="7"><span class="co"># wragle</span></a>
<a class="sourceLine" id="cb1324-8" data-line-number="8">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-9" data-line-number="9"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_lines) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-10" data-line-number="10"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;draw&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-11" data-line-number="11"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(b_Intercept, sigma, nu, draw),</a>
<a class="sourceLine" id="cb1324-12" data-line-number="12">         <span class="dt">Score =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">40</span>, <span class="dt">to =</span> <span class="dv">250</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> metRology<span class="op">::</span><span class="kw">dt.scaled</span>(<span class="dt">x =</span> Score, <span class="dt">df =</span> nu, <span class="dt">mean =</span> b_Intercept, <span class="dt">sd =</span> sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-14" data-line-number="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb1324-15" data-line-number="15"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1324-16" data-line-number="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Score)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1324-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1324-18" data-line-number="18">                 <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb1324-19" data-line-number="19">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1324-20" data-line-number="20">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1324-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> density, <span class="dt">group =</span> draw),</a>
<a class="sourceLine" id="cb1324-22" data-line-number="22">            <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey25&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1324-23" data-line-number="23"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1324-24" data-line-number="24"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Post. Pred.&quot;</span>,</a>
<a class="sourceLine" id="cb1324-25" data-line-number="25">       <span class="dt">x =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1324-26" data-line-number="26"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">50</span><span class="op">:</span><span class="dv">210</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-40-1.png" style="display: block; margin: auto;" /></p>
<p>Much like Kruschke mused in the text, this plot</p>
<blockquote>
<p>shows that the posterior predictive <span class="math inline">\(t\)</span> distributions appear to describe the data better than the normal distribution in Figure 16.3, insofar as the data histogram does not poke out at the mode and the gaps under the shoulders are smaller. (p. 464)</p>
</blockquote>
<p>In case you were wondering, here’s the model <code>summary()</code>.</p>
<div class="sourceCode" id="cb1325"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1325-1" data-line-number="1"><span class="kw">summary</span>(fit16<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = identity; nu = identity 
## Formula: Score ~ 1 
##    Data: my_data (Number of observations: 63) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   107.21      2.73   101.94   112.58 1.00     2282     2198
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    19.44      3.39    13.15    26.63 1.00     1359     2053
## nu        8.89     12.82     1.83    41.30 1.00     1528     2063
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>It’s easy to miss how</p>
<blockquote>
<p><span class="math inline">\(\sigma\)</span> in the robust estimate is much smaller than in the normal estimate. What we had interpreted as increased standard deviation induced by the smart drug might be better described as increased outliers. Both of these differences, that is, <span class="math inline">\(\mu\)</span> more tightly estimated and <span class="math inline">\(\sigma\)</span> smaller in magnitude, are a result of there being outliers in the data. The only way a normal distribution can accommodate the outliers is to use a large value for <span class="math inline">\(\sigma\)</span>. In turn, that leads to “slop” in the estimate of <span class="math inline">\(\mu\)</span> because there is a wider range of <span class="math inline">\(\mu\)</span> values that reasonably fit the data when the standard deviation is large. (p. 464)</p>
</blockquote>
<p>We can use the <code>brms::VarCorr()</code> function to pull the summary statistics for <span class="math inline">\(\sigma\)</span> from both models.</p>
<div class="sourceCode" id="cb1327"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1327-1" data-line-number="1"><span class="kw">VarCorr</span>(fit16<span class="fl">.1</span>)<span class="op">$</span>residual__<span class="op">$</span>sd</a></code></pre></div>
<pre><code>##  Estimate Est.Error     Q2.5    Q97.5
##  25.77896  2.326489 21.66347 30.88419</code></pre>
<div class="sourceCode" id="cb1329"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1329-1" data-line-number="1"><span class="kw">VarCorr</span>(fit16<span class="fl">.2</span>)<span class="op">$</span>residual__<span class="op">$</span>sd</a></code></pre></div>
<pre><code>##  Estimate Est.Error    Q2.5    Q97.5
##  19.44218  3.391467 13.1486 26.63353</code></pre>
<p>It is indeed the case that estimate for <span class="math inline">\(\sigma\)</span> is smaller in the <span class="math inline">\(t\)</span> model. That smaller <span class="math inline">\(\sigma\)</span> resulted in a more precise estimate for <span class="math inline">\(\mu\)</span>, as can be seen in the ‘Est.Error’ columns from the <code>fixef()</code> output.</p>
<div class="sourceCode" id="cb1331"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1331-1" data-line-number="1"><span class="kw">fixef</span>(fit16<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##           Estimate Est.Error     Q2.5    Q97.5
## Intercept 107.7823  3.317812 101.0451 114.2292</code></pre>
<div class="sourceCode" id="cb1333"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1333-1" data-line-number="1"><span class="kw">fixef</span>(fit16<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##           Estimate Est.Error     Q2.5    Q97.5
## Intercept 107.2099  2.731697 101.9441 112.5784</code></pre>
<p>Here that is in a coefficient plot using <code>tidybayes::stat_intervalh()</code>.</p>
<div class="sourceCode" id="cb1335"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1335-1" data-line-number="1"><span class="kw">bind_rows</span>(<span class="kw">posterior_samples</span>(fit16<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(b_Intercept),</a>
<a class="sourceLine" id="cb1335-2" data-line-number="2">          <span class="kw">posterior_samples</span>(fit16<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(b_Intercept)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1335-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;fit16.1&quot;</span>, <span class="st">&quot;fit16.2&quot;</span>), <span class="dt">each =</span> <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1335-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1335-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Intercept, <span class="dt">y =</span> fit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1335-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_intervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.8</span>, <span class="fl">.95</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1335-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_color_grey</span>(<span class="st">&quot;HDI&quot;</span>, <span class="dt">start =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">end =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1335-8" data-line-number="8">                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;95%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;50%&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1335-9" data-line-number="9"><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1335-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.45</span>, <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-44-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="using-the-t-distribution-in-stan." class="section level3">
<h3><span class="header-section-number">16.2.2</span> Using the <span class="math inline">\(t\)</span> distribution in Stan.</h3>
<p>Kruschke expressed concern about high autocorrelations in the chains of his JAGS model. Here are the results of our Stan/<strong>brms</strong> attempt.</p>
<div class="sourceCode" id="cb1336"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1336-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit16<span class="fl">.2</span>, <span class="dt">add_chain =</span> T)</a>
<a class="sourceLine" id="cb1336-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1336-3" data-line-number="3"><span class="kw">library</span>(bayesplot)</a>
<a class="sourceLine" id="cb1336-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1336-5" data-line-number="5"><span class="kw">mcmc_acf</span>(post, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;b_Intercept&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;nu&quot;</span>), <span class="dt">lags =</span> <span class="dv">35</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-45-1.png" style="display: block; margin: auto;" /></p>
<p>For all three parameters, the autocorrelations were near zero by lag 3 or 4. Not bad. The <span class="math inline">\(N_{eff}/N\)</span> ratios are okay.</p>
<div class="sourceCode" id="cb1337"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1337-1" data-line-number="1"><span class="kw">neff_ratio</span>(fit16<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1337-2" data-line-number="2"><span class="st">  </span><span class="kw">mcmc_neff</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1337-3" data-line-number="3"><span class="st">  </span><span class="kw">yaxis_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-46-1.png" style="display: block; margin: auto;" /></p>
<p>The trace plots look fine.</p>
<div class="sourceCode" id="cb1338"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1338-1" data-line-number="1"><span class="kw">plot</span>(fit16<span class="fl">.2</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-47-1.png" style="display: block; margin: auto;" /></p>
<p>The values for <code>nu</code> are pretty skewed, but hopefully it makes sense to you why that might be the case. Here are the overlaid density plots.</p>
<div class="sourceCode" id="cb1339"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1339-1" data-line-number="1"><span class="kw">mcmc_dens_overlay</span>(post, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;b_Intercept&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;nu&quot;</span>))</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-48-1.png" style="display: block; margin: auto;" /></p>
<p>The <span class="math inline">\(\hat R\)</span> values are right where we like them.</p>
<div class="sourceCode" id="cb1340"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1340-1" data-line-number="1"><span class="kw">rhat</span>(fit16<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>## b_Intercept       sigma          nu        lp__ 
##    1.000481    1.004534    1.001197    1.002847</code></pre>
<p>If you peer into the contents of a <code>brm()</code> fit object (e.g., <code>fit16.2 %&gt;% str()</code>), you’ll discover it contains the Stan code. Here it is for our <code>fit16.2</code>.</p>
<div class="sourceCode" id="cb1342"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1342-1" data-line-number="1">fit16<span class="fl">.2</span><span class="op">$</span>fit<span class="op">@</span>stanmodel</a></code></pre></div>
<pre><code>## S4 class stanmodel &#39;492bc3ca2c99d9c80c80ca16542cd5bb&#39; coded as follows:
## // generated with brms 2.11.5
## functions {
## 
##   /* compute the logm1 link 
##    * Args: 
##    *   p: a positive scalar
##    * Returns: 
##    *   a scalar in (-Inf, Inf)
##    */ 
##    real logm1(real y) { 
##      return log(y - 1);
##    }
##   /* compute the inverse of the logm1 link 
##    * Args: 
##    *   y: a scalar in (-Inf, Inf)
##    * Returns: 
##    *   a positive scalar
##    */ 
##    real expp1(real y) { 
##      return exp(y) + 1;
##    }
## }
## data {
##   int&lt;lower=1&gt; N;  // number of observations
##   vector[N] Y;  // response variable
##   int prior_only;  // should the likelihood be ignored?
##   real mean_y;
##   real sd_y;
##   real one_over_twentynine;
## }
## transformed data {
## }
## parameters {
##   real Intercept;  // temporary intercept for centered predictors
##   real&lt;lower=0&gt; sigma;  // residual SD
##   real&lt;lower=1&gt; nu;  // degrees of freedom or shape
## }
## transformed parameters {
## }
## model {
##   // initialize linear predictor term
##   vector[N] mu = Intercept + rep_vector(0, N);
##   // priors including all constants
##   target += normal_lpdf(Intercept | mean_y, sd_y * 100);
##   target += normal_lpdf(sigma | 0, sd_y)
##     - 1 * normal_lccdf(0 | 0, sd_y);
##   target += exponential_lpdf(nu | one_over_twentynine)
##     - 1 * exponential_lccdf(1 | one_over_twentynine);
##   // likelihood including all constants
##   if (!prior_only) {
##     target += student_t_lpdf(Y | nu, mu, sigma);
##   }
## }
## generated quantities {
##   // actual population-level intercept
##   real b_Intercept = Intercept;
## }
## </code></pre>
<p>Note the last line in the parameters block, “real&lt;lower=1&gt; nu; // degrees of freedom or shape.” By default, <strong>brms</strong> set the lower bound for <span class="math inline">\(\nu\)</span> to 1.</p>
<p>Just for kicks and giggles, the <code>pp_check()</code> offers us a handy way to compare the performance of our Gaussian <code>fit16.2</code> and our Student’s <span class="math inline">\(t\)</span> <code>fit16.2</code>. If we set <code>type = &quot;ecdf_overlay&quot;</code> within <code>pp_check()</code>, we’ll get the criterion <code>Score</code> displayed as a cumulative distribution function (CDF) rather than a typical density. Then, <code>pp_check()</code> presents CDF’s based on draws from the posterior for comparison. Just like with the default <code>pp_check()</code> plots, we like it when those simulated distributions mimic the one from the original data.</p>
<div class="sourceCode" id="cb1344"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1344-1" data-line-number="1"><span class="co"># fit16.1 with Gaus</span></a>
<a class="sourceLine" id="cb1344-2" data-line-number="2"><span class="kw">set.seed</span>(<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb1344-3" data-line-number="3">p1 &lt;-</a>
<a class="sourceLine" id="cb1344-4" data-line-number="4"><span class="st">  </span><span class="kw">pp_check</span>(fit16<span class="fl">.1</span>, <span class="dt">nsamples =</span> n_lines, <span class="dt">type =</span> <span class="st">&quot;ecdf_overlay&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1344-5" data-line-number="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;fit16.1 with `family = gaussian`&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1344-6" data-line-number="6"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Score)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1344-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb1344-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1344-9" data-line-number="9"><span class="co"># fit16.2 with Student&#39;s t</span></a>
<a class="sourceLine" id="cb1344-10" data-line-number="10">p2 &lt;-</a>
<a class="sourceLine" id="cb1344-11" data-line-number="11"><span class="st">  </span><span class="kw">pp_check</span>(fit16<span class="fl">.2</span>, <span class="dt">nsamples =</span> n_lines, <span class="dt">type =</span> <span class="st">&quot;ecdf_overlay&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1344-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;fit16.2 with `family = student`&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1344-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Score))</a>
<a class="sourceLine" id="cb1344-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1344-15" data-line-number="15"><span class="co"># combine the subplots</span></a>
<a class="sourceLine" id="cb1344-16" data-line-number="16">p1 <span class="op">+</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-51-1.png" style="display: block; margin: auto;" /></p>
<p>It’s subtle, but you might notice that the simulated CDFs from <code>fit16.1</code> have steeper slopes in the middle when compared to the original data in the dark blue. However, the <code>fit16.2</code>-based simulated CDFs match up more closely with the original data. This suggests an edge for <code>fit16.2</code>. Revisiting our skills from Chapter 10, we might also compare their model weights.</p>
<div class="sourceCode" id="cb1345"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1345-1" data-line-number="1"><span class="kw">model_weights</span>(fit16<span class="fl">.1</span>, fit16<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1345-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">6</span>)</a></code></pre></div>
<pre><code>##  fit16.1  fit16.2 
## 0.000004 0.999996</code></pre>
<p>Almost all the <a href="http://www.stat.columbia.edu/~gelman/research/published/stacking_paper_discussion_rejoinder.pdf">stacking weight</a> went to <code>fit16.2</code>, our robust Student’s <span class="math inline">\(t\)</span> model.</p>
</div>
</div>
<div id="two-groups" class="section level2">
<h2><span class="header-section-number">16.3</span> Two groups</h2>
<blockquote>
<p>When there are two groups, we estimate the mean and scale for each group. When using <span class="math inline">\(t\)</span> distributions for robust estimation, we could also estimate the normality of each group separately. But because there usually are relatively few outliers, we will use a single normality parameter to describe both groups, so that the estimate of the normality is more stably estimated. (p. 468)</p>
</blockquote>
<p>Since we subset the data, earlier, we’ll just reload it to get the full data set.</p>
<div class="sourceCode" id="cb1347"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1347-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/TwoGroupIQ.csv&quot;</span>)</a></code></pre></div>
<p>This time, we’ll compute <code>mean_y</code> and <code>sd_y</code> from the full data.</p>
<div class="sourceCode" id="cb1348"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1348-1" data-line-number="1">(mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Score))</a></code></pre></div>
<pre><code>## [1] 104.1333</code></pre>
<div class="sourceCode" id="cb1350"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1350-1" data-line-number="1">(sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Score))</a></code></pre></div>
<pre><code>## [1] 22.43532</code></pre>
<div class="sourceCode" id="cb1352"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1352-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1352-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1352-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1352-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>,   <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</a></code></pre></div>
<p>Within the <strong>brms</strong> framework, Bürkner calls it distributional modeling when you model more than the mean. Since we’re now modeling both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>, we’re fitting a distributional model. When doing so with <strong>brms</strong>, you typically wrap your <code>formula</code> syntax into the <code>bf()</code> function. It’s also important to know that when modeling <span class="math inline">\(\sigma\)</span>, <strong>brms</strong> defaults to modeling its log. So we’ll use <code>log(sd_y)</code> in its prior. For more on all this, see Bürkner&quot;s <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_distreg.html"><em>Estimating Distributional Models with brms</em></a>.</p>
<div class="sourceCode" id="cb1353"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1353-1" data-line-number="1">fit16<span class="fl">.3</span> &lt;-</a>
<a class="sourceLine" id="cb1353-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1353-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1353-4" data-line-number="4">      <span class="kw">bf</span>(Score <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Group, </a>
<a class="sourceLine" id="cb1353-5" data-line-number="5">         sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Group),</a>
<a class="sourceLine" id="cb1353-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1353-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="kw">log</span>(sd_y)), <span class="dt">class =</span> b, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1353-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1353-9" data-line-number="9">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1353-10" data-line-number="10">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1353-11" data-line-number="11">      <span class="dt">seed =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb1353-12" data-line-number="12">      <span class="dt">file =</span> <span class="st">&quot;fits/fit16.03&quot;</span>)</a></code></pre></div>
<p>Did you catch our <code>~ 0 + Group</code> syntax? That suppressed the usual intercept for our estimates of both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\log (\sigma)\)</span>. Since <code>Group</code> is a categorical variable, that results in <code>brm()</code> fitting separate intercepts for each category. This is our <strong>brms</strong> analogue to the <code>x[i]</code> syntax Kruschke mentioned on page 468. It’s what allowed us to estimate <span class="math inline">\(\mu_j\)</span> and <span class="math inline">\(\log (\sigma_j)\)</span>.</p>
<p>Let’s look at the model summary.</p>
<div class="sourceCode" id="cb1354"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1354-1" data-line-number="1"><span class="kw">print</span>(fit16<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: Score ~ 0 + Group 
##          sigma ~ 0 + Group
##    Data: my_data (Number of observations: 120) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##                      Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## GroupPlacebo            99.29      1.72    95.96   102.74 1.00     4043     3012
## GroupSmartDrug         107.11      2.65   102.03   112.41 1.00     5034     2787
## sigma_GroupPlacebo       2.38      0.16     2.06     2.67 1.00     3632     2706
## sigma_GroupSmartDrug     2.84      0.15     2.54     3.13 1.00     3238     2740
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## nu     3.56      1.42     1.81     7.12 1.00     2648     2153
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Remember that the <span class="math inline">\(\sigma\)</span>s are now in the log scale. If you want a quick conversion, you might just exponentiate the point estimates from <code>fixef()</code>.</p>
<div class="sourceCode" id="cb1356"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1356-1" data-line-number="1"><span class="kw">fixef</span>(fit16<span class="fl">.3</span>)[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>()</a></code></pre></div>
<pre><code>##   sigma_GroupPlacebo sigma_GroupSmartDrug 
##             10.75387             17.04000</code></pre>
<p>But please don’t stop there. Get your hands dirty with the full posterior. Speaking of which, if we want to make the histograms in Figure 16.12, we’ll need to first extract the posterior samples.</p>
<div class="sourceCode" id="cb1358"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1358-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit16<span class="fl">.3</span>)</a>
<a class="sourceLine" id="cb1358-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1358-3" data-line-number="3"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 6
## $ b_GroupPlacebo         &lt;dbl&gt; 95.05456, 97.65789, 100.74824, 100.35265, 98.35897, 100.39547, 97.…
## $ b_GroupSmartDrug       &lt;dbl&gt; 98.87536, 102.64673, 107.50948, 109.26261, 104.65081, 106.44534, 1…
## $ b_sigma_GroupPlacebo   &lt;dbl&gt; 2.521396, 2.296794, 2.515365, 2.304293, 2.249436, 2.596969, 2.4919…
## $ b_sigma_GroupSmartDrug &lt;dbl&gt; 2.919710, 3.028132, 2.658009, 3.026779, 2.756936, 3.010234, 2.9466…
## $ nu                     &lt;dbl&gt; 2.487891, 7.475595, 4.669025, 2.521117, 4.123748, 6.066377, 3.2276…
## $ lp__                   &lt;dbl&gt; -557.6583, -554.3776, -551.5875, -551.1064, -550.4912, -550.1686, …</code></pre>
<p>Along with transforming the metrics of a few of the parameters, we may as well rename them to match those in the text.</p>
<div class="sourceCode" id="cb1360"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1360-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb1360-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1360-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">Placebo Mean</span><span class="st">`</span>     =<span class="st"> </span>b_GroupPlacebo,</a>
<a class="sourceLine" id="cb1360-4" data-line-number="4">            <span class="st">`</span><span class="dt">Smart Drug Mean</span><span class="st">`</span>  =<span class="st"> </span>b_GroupSmartDrug,</a>
<a class="sourceLine" id="cb1360-5" data-line-number="5">            <span class="co"># we need to transform the next three parameters</span></a>
<a class="sourceLine" id="cb1360-6" data-line-number="6">            <span class="st">`</span><span class="dt">Placebo Scale</span><span class="st">`</span>    =<span class="st"> </span>b_sigma_GroupPlacebo   <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>(),</a>
<a class="sourceLine" id="cb1360-7" data-line-number="7">            <span class="st">`</span><span class="dt">Smart Drug Scale</span><span class="st">`</span> =<span class="st"> </span>b_sigma_GroupSmartDrug <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">exp</span>(),</a>
<a class="sourceLine" id="cb1360-8" data-line-number="8">            <span class="dt">Normality          =</span> nu                     <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">log10</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1360-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Difference of Means</span><span class="st">`</span>  =<span class="st"> `</span><span class="dt">Smart Drug Mean</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">Placebo Mean</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1360-10" data-line-number="10">         <span class="st">`</span><span class="dt">Difference of Scales</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">Smart Drug Scale</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">Placebo Scale</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1360-11" data-line-number="11">         <span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">Smart Drug Mean</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">Placebo Mean</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="st">`</span><span class="dt">Smart Drug Scale</span><span class="st">`</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> `</span><span class="dt">Placebo Scale</span><span class="st">`</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb1360-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1360-13" data-line-number="13"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 4,000
## Variables: 8
## $ `Placebo Mean`         &lt;dbl&gt; 95.05456, 97.65789, 100.74824, 100.35265, 98.35897, 100.39547, 97.…
## $ `Smart Drug Mean`      &lt;dbl&gt; 98.87536, 102.64673, 107.50948, 109.26261, 104.65081, 106.44534, 1…
## $ `Placebo Scale`        &lt;dbl&gt; 12.445965, 9.942252, 12.371126, 10.017089, 9.482389, 13.422995, 12…
## $ `Smart Drug Scale`     &lt;dbl&gt; 18.53591, 20.65861, 14.26785, 20.63068, 15.75150, 20.29214, 19.041…
## $ Normality              &lt;dbl&gt; 0.3958314, 0.8736458, 0.6692262, 0.4015930, 0.6152921, 0.7829294, …
## $ `Difference of Means`  &lt;dbl&gt; 3.820800, 4.988845, 6.761232, 8.909960, 6.291841, 6.049876, 6.6027…
## $ `Difference of Scales` &lt;dbl&gt; 6.089950, 10.716360, 1.896728, 10.613589, 6.269113, 6.869148, 6.95…
## $ `Effect Size`          &lt;dbl&gt; 0.2420162, 0.3077346, 0.5063376, 0.5494289, 0.4839695, 0.3516574, …</code></pre>
<p>Now we’re ready for the bulk of Figure 16.12.</p>
<div class="sourceCode" id="cb1362"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1362-1" data-line-number="1"><span class="co"># we&#39;ll use this to mark off the ROPEs as white strips in the background</span></a>
<a class="sourceLine" id="cb1362-2" data-line-number="2">rope &lt;-</a>
<a class="sourceLine" id="cb1362-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">key  =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;Difference of Means&quot;</span>, <span class="st">&quot;Difference of Scales&quot;</span>, <span class="st">&quot;Effect Size&quot;</span>),</a>
<a class="sourceLine" id="cb1362-4" data-line-number="4">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Placebo Mean&quot;</span>, <span class="st">&quot;Smart Drug Mean&quot;</span>,  <span class="st">&quot;Placebo Scale&quot;</span>, <span class="st">&quot;Difference of Means&quot;</span>, <span class="st">&quot;Smart Drug Scale&quot;</span>, <span class="st">&quot;Difference of Scales&quot;</span>, <span class="st">&quot;Normality&quot;</span>, <span class="st">&quot;Effect Size&quot;</span>)), </a>
<a class="sourceLine" id="cb1362-5" data-line-number="5">         <span class="dt">xmin =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">-1</span>, <span class="fl">-.1</span>),</a>
<a class="sourceLine" id="cb1362-6" data-line-number="6">         <span class="dt">xmax =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">.1</span>))</a>
<a class="sourceLine" id="cb1362-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1362-8" data-line-number="8"><span class="co"># here are the primary data</span></a>
<a class="sourceLine" id="cb1362-9" data-line-number="9">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1362-10" data-line-number="10"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1362-11" data-line-number="11"><span class="st">  </span><span class="co"># this isn&#39;t necessary, but it arranged our subplots like those in the text</span></a>
<a class="sourceLine" id="cb1362-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Placebo Mean&quot;</span>, <span class="st">&quot;Smart Drug Mean&quot;</span>,  <span class="st">&quot;Placebo Scale&quot;</span>, <span class="st">&quot;Difference of Means&quot;</span>, <span class="st">&quot;Smart Drug Scale&quot;</span>, <span class="st">&quot;Difference of Scales&quot;</span>, <span class="st">&quot;Normality&quot;</span>, <span class="st">&quot;Effect Size&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1362-13" data-line-number="13"><span class="st">  </span></a>
<a class="sourceLine" id="cb1362-14" data-line-number="14"><span class="st">  </span><span class="co"># the plot</span></a>
<a class="sourceLine" id="cb1362-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1362-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_rect</span>(<span class="dt">data =</span> rope,</a>
<a class="sourceLine" id="cb1362-17" data-line-number="17">            <span class="kw">aes</span>(<span class="dt">xmin =</span> xmin, <span class="dt">xmax =</span> xmax,</a>
<a class="sourceLine" id="cb1362-18" data-line-number="18">                <span class="dt">ymin =</span> <span class="op">-</span><span class="ot">Inf</span>, <span class="dt">ymax =</span> <span class="ot">Inf</span>),</a>
<a class="sourceLine" id="cb1362-19" data-line-number="19">            <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1362-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value),</a>
<a class="sourceLine" id="cb1362-21" data-line-number="21">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1362-22" data-line-number="22">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">bins =</span> <span class="dv">30</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1362-23" data-line-number="23"><span class="st">  </span><span class="kw">stat_pointintervalh</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb1362-24" data-line-number="24">                      <span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1362-25" data-line-number="25"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1362-26" data-line-number="26"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1362-27" data-line-number="27"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-59-1.png" style="display: block; margin: auto;" /></p>
<p>Now let’s make the upper two panels in the right column of Figure 16.12.</p>
<p>You might note a few things in our wrangling code. First, in the <code>mutate()</code> function, we defined the density values for the two <code>Group</code> conditions one at a time. If you look carefully within those definitions, you’ll see we used <code>10^Normality</code> for the <code>df</code> argument, rather than just <code>Normality</code>. <em>Why?</em> Remember how a few code blocks up we transformed the original <code>nu</code> column to <code>Normality</code> by placing it within <code>log10()</code>? Well, if you want to undo that, you have to take 10 to the power of <code>Normality</code>. Next, notice that we subset the <code>post</code> tibble with <code>select()</code>. This wasn’t technically necessary, but it made the next line easier. Finally, with the <code>gather()</code> function, we transformed the <code>Placebo</code> and <code>Smart Drug</code> columns into an index column strategically named <code>Group</code>, which matched up with the original <code>my_data</code> data, and a <code>density</code> column, which contained the actual density values for the lines.</p>
<p>I know. That’s a lot to take in. If you’re confused, run the lines in the code one at a time to see how they work. But anyway, here’s the final result!</p>
<div class="sourceCode" id="cb1363"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1363-1" data-line-number="1"><span class="co"># how many credible density lines would you like?</span></a>
<a class="sourceLine" id="cb1363-2" data-line-number="2">n_lines &lt;-<span class="st"> </span><span class="dv">63</span></a>
<a class="sourceLine" id="cb1363-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1363-4" data-line-number="4"><span class="co"># setting the seed makes the results from `sample_n()` reproducible</span></a>
<a class="sourceLine" id="cb1363-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">16</span>)</a>
<a class="sourceLine" id="cb1363-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1363-7" data-line-number="7"><span class="co"># wragle</span></a>
<a class="sourceLine" id="cb1363-8" data-line-number="8">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-9" data-line-number="9"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_lines) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-10" data-line-number="10"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;draw&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-11" data-line-number="11"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(draw, <span class="st">`</span><span class="dt">Placebo Mean</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Smart Drug Mean</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Placebo Scale</span><span class="st">`</span>, <span class="st">`</span><span class="dt">Smart Drug Scale</span><span class="st">`</span>, Normality),</a>
<a class="sourceLine" id="cb1363-12" data-line-number="12">         <span class="dt">Score =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">40</span>, <span class="dt">to =</span> <span class="dv">250</span>, <span class="dt">by =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-13" data-line-number="13"><span class="st">  </span></a>
<a class="sourceLine" id="cb1363-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Placebo      =</span> metRology<span class="op">::</span><span class="kw">dt.scaled</span>(<span class="dt">x =</span> Score, <span class="dt">df =</span> <span class="dv">10</span><span class="op">^</span>Normality, <span class="dt">mean =</span> <span class="st">`</span><span class="dt">Placebo Mean</span><span class="st">`</span>,    <span class="dt">sd =</span> <span class="st">`</span><span class="dt">Placebo Scale</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb1363-15" data-line-number="15">         <span class="st">`</span><span class="dt">Smart Drug</span><span class="st">`</span> =<span class="st"> </span>metRology<span class="op">::</span><span class="kw">dt.scaled</span>(<span class="dt">x =</span> Score, <span class="dt">df =</span> <span class="dv">10</span><span class="op">^</span>Normality, <span class="dt">mean =</span> <span class="st">`</span><span class="dt">Smart Drug Mean</span><span class="st">`</span>, <span class="dt">sd =</span> <span class="st">`</span><span class="dt">Smart Drug Scale</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-16" data-line-number="16"><span class="st">  </span><span class="kw">select</span>(draw, Score<span class="op">:</span><span class="st">`</span><span class="dt">Smart Drug</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-17" data-line-number="17"><span class="st">  </span><span class="kw">gather</span>(Group, density, <span class="op">-</span>draw, <span class="op">-</span>Score) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-18" data-line-number="18"><span class="st">  </span></a>
<a class="sourceLine" id="cb1363-19" data-line-number="19"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1363-20" data-line-number="20"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Score)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1363-21" data-line-number="21"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1363-22" data-line-number="22">                 <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb1363-23" data-line-number="23">                 <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1363-24" data-line-number="24">                 <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">binwidth =</span> <span class="dv">5</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1363-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> density, <span class="dt">group =</span> draw),</a>
<a class="sourceLine" id="cb1363-26" data-line-number="26">            <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">color =</span> <span class="st">&quot;grey25&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1363-27" data-line-number="27"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1363-28" data-line-number="28"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Post. Pred.&quot;</span>,</a>
<a class="sourceLine" id="cb1363-29" data-line-number="29">       <span class="dt">x =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1363-30" data-line-number="30"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">50</span><span class="op">:</span><span class="dv">210</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1363-31" data-line-number="31"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Group)</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-60-1.png" style="display: block; margin: auto;" /></p>
<div id="analysis-by-nhst." class="section level3">
<h3><span class="header-section-number">16.3.1</span> Analysis by NHST.</h3>
<p>Here’s how we might perform a <span class="math inline">\(t\)</span>-test.</p>
<div class="sourceCode" id="cb1364"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1364-1" data-line-number="1"><span class="kw">t.test</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1364-2" data-line-number="2">       Score <span class="op">~</span><span class="st"> </span>Group)</a></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Score by Group
## t = -1.958, df = 111.44, p-value = 0.05273
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -15.70602585   0.09366161
## sample estimates:
##    mean in group Placebo mean in group Smart Drug 
##                 100.0351                 107.8413</code></pre>
<p>To help with the comparison, notice how the 95% CIs from the <span class="math inline">\(t\)</span>-test range from -15.7 to 0.1. That indicates that the <span class="math inline">\(t\)</span>-test subtracted the <code>Smart Drug</code> from <code>Placebo</code>. I point this out because the difference scores we computed along with Kruschke for Figure 16.12 did the subtraction in the other direction. But don’t fret. The magnitude of the difference stays the same either way. Only the signs changed. For example:</p>
<div class="sourceCode" id="cb1366"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1366-1" data-line-number="1"><span class="kw">fixef</span>(fit16<span class="fl">.3</span>)[<span class="st">&quot;GroupPlacebo&quot;</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">fixef</span>(fit16<span class="fl">.3</span>)[<span class="st">&quot;GroupSmartDrug&quot;</span>, <span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] -7.817559</code></pre>
<div class="sourceCode" id="cb1368"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1368-1" data-line-number="1"><span class="kw">fixef</span>(fit16<span class="fl">.3</span>)[<span class="st">&quot;GroupSmartDrug&quot;</span>, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="kw">fixef</span>(fit16<span class="fl">.3</span>)[<span class="st">&quot;GroupPlacebo&quot;</span>, <span class="dv">1</span>]</a></code></pre></div>
<pre><code>## [1] 7.817559</code></pre>
<p>But anyway, in addition to the difference distributions from Figure 16.12, we might also use the <code>brms::hypothesis()</code> function to do something of a Bayesian <span class="math inline">\(t\)</span>-test.</p>
<div class="sourceCode" id="cb1370"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1370-1" data-line-number="1"><span class="kw">hypothesis</span>(fit16<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb1370-2" data-line-number="2">           <span class="st">&quot;GroupPlacebo - GroupSmartDrug = 0&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (GroupPlacebo-Gro... = 0    -7.82      3.15   -14.18    -1.66         NA        NA    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>See how our 95% ETIs are both negative and how we have that little <code>*</code> in the <code>Star</code> column? If you like the visual approach, you can even feed the <code>hypothesis()</code> code into <code>plot()</code>.</p>
<div class="sourceCode" id="cb1372"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1372-1" data-line-number="1"><span class="kw">hypothesis</span>(fit16<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb1372-2" data-line-number="2">           <span class="st">&quot;GroupPlacebo - GroupSmartDrug = 0&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1372-3" data-line-number="3"><span class="st">  </span><span class="kw">plot</span>()</a></code></pre></div>
<p><img src="16_files/figure-gfm/unnamed-chunk-64-1.png" style="display: block; margin: auto;" /></p>
<p>Back to the text:</p>
<blockquote>
<p>The reason that the <span class="math inline">\(t\)</span> test is less sensitive than the Bayesian estimation in this example is that the <span class="math inline">\(t\)</span> test assumes normality and therefore its estimate of the within-group variances is too large when there are outliers.</p>
<p>The <span class="math inline">\(t\)</span> test has other problems. Unlike the Bayesian analysis, the <span class="math inline">\(t\)</span> test provides only a test of the equality of means, without a test of the equality of variances. To test equality of variances, we need to run an additional test, namely an <span class="math inline">\(F\)</span> test of the ratio of variances, which would inflate the <span class="math inline">\(p\)</span> values of both tests. Moreover, both tests compute <span class="math inline">\(p\)</span> values based on hypothetical normally distributed data, and the <span class="math inline">\(F\)</span> test is particularly sensitive to violations of this assumption. Therefore it would be better to use resampling methods to compute the <span class="math inline">\(p\)</span> values (and correcting them for multiple tests). (pp. 471–472)</p>
</blockquote>
<p>Don’t do all that. Use robust Bayes, instead. Just for kicks, we can compare the <span class="math inline">\(\sigma\)</span>s with <code>hypothesis()</code>, too.</p>
<div class="sourceCode" id="cb1373"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1373-1" data-line-number="1"><span class="kw">hypothesis</span>(fit16<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb1373-2" data-line-number="2">           <span class="st">&quot;exp(sigma_GroupPlacebo) - exp(sigma_GroupSmartDrug) = 0&quot;</span>)</a></code></pre></div>
<pre><code>## Hypothesis Tests for class b:
##                 Hypothesis Estimate Est.Error CI.Lower CI.Upper Evid.Ratio Post.Prob Star
## 1 (exp(sigma_GroupP... = 0    -6.35      2.72   -12.02    -1.23         NA        NA    *
## ---
## &#39;CI&#39;: 90%-CI for one-sided and 95%-CI for two-sided hypotheses.
## &#39;*&#39;: For one-sided hypotheses, the posterior probability exceeds 95%;
## for two-sided hypotheses, the value tested against lies outside the 95%-CI.
## Posterior probabilities of point hypotheses assume equal prior probabilities.</code></pre>
<p>See? We don’t need an <span class="math inline">\(F\)</span> test.</p>
</div>
</div>
<div id="other-noise-distributions-and-transforming-data" class="section level2">
<h2><span class="header-section-number">16.4</span> Other noise distributions and transforming data</h2>
<p>It’s worth repeating a portion of this section.</p>
<blockquote>
<p>If the initially assumed noise distribution does not match the data distribution, there are two ways to pursue a better description. The preferred way is to use a better noise distribution. The other way is to transform the data to a new scale so that they tolerably match the shape of the assumed noise distribution. In other words, we can either change the shoe to fit the foot, or we can squeeze the foot to fit in the shoe. Changing the shoe is preferable to squeezing the foot. In traditional statistical software, users were stuck with the pre-packaged noise distribution, and had no way to change it, so they transformed their data and squeezed them into the software. This practice can lead to confusion in interpreting the parameters because they are describing the transformed data, not the data on the original scale. In software such as [<strong>brms</strong>, we can spend less time squeezing our feet into ill-fitting shoes]. (p. 472)</p>
</blockquote>
<p>We’ll have more practice with the robust Student’s <span class="math inline">\(t\)</span> in some of the following chapters. But if you’d like even more, you might check out my blog on the topic <a href="https://solomonkurz.netlify.com/post/robust-linear-regression-with-the-robust-student-s-t-distribution/"><em>Robust Linear Regression with Student’s <span class="math inline">\(t\)</span>-Distribution</em></a> and the companion post <a href="https://solomonkurz.netlify.com/post/bayesian-robust-correlations-with-brms-and-why-you-should-love-student-s-t/"><em>Bayesian robust correlations with brms (and why you should love Student’s <span class="math inline">\(t\)</span>)</em></a>.</p>
</div>
<div id="reference-15" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-15" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb1375"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1375-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] bayesplot_1.7.1      patchwork_1.0.0      tidybayes_2.0.1.9000 brms_2.11.5         
##  [5] Rcpp_1.0.3           forcats_0.4.0        stringr_1.4.0        dplyr_0.8.4         
##  [9] purrr_0.3.3          readr_1.3.1          tidyr_1.0.2          tibble_2.1.3        
## [13] ggplot2_3.2.1        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ellipsis_0.3.0            ggridges_0.5.2           
##   [4] rsconnect_0.8.16          markdown_1.1              base64enc_0.1-3          
##   [7] fs_1.3.1                  rstudioapi_0.10           farver_2.0.3             
##  [10] rstan_2.19.2              svUnit_0.7-12             DT_0.11                  
##  [13] fansi_0.4.1               mvtnorm_1.0-12            lubridate_1.7.4          
##  [16] xml2_1.2.2                bridgesampling_0.8-1      robustbase_0.93-5        
##  [19] knitr_1.26                shinythemes_1.1.2         jsonlite_1.6.1           
##  [22] broom_0.5.3               dbplyr_1.4.2              shiny_1.4.0              
##  [25] compiler_3.6.2            httr_1.4.1                backports_1.1.5          
##  [28] assertthat_0.2.1          Matrix_1.2-18             fastmap_1.0.1            
##  [31] lazyeval_0.2.2            cli_2.0.1                 later_1.0.0              
##  [34] htmltools_0.4.0           prettyunits_1.1.1         tools_3.6.2              
##  [37] igraph_1.2.4.2            coda_0.19-3               gtable_0.3.0             
##  [40] glue_1.3.1                reshape2_1.4.3            cellranger_1.1.0         
##  [43] vctrs_0.2.2               nlme_3.1-142              crosstalk_1.0.0          
##  [46] xfun_0.12                 ps_1.3.0                  rvest_0.3.5              
##  [49] mime_0.8                  miniUI_0.1.1.1            lifecycle_0.1.0          
##  [52] gtools_3.8.1              DEoptimR_1.0-8            MASS_7.3-51.4            
##  [55] zoo_1.8-7                 scales_1.1.0              colourpicker_1.0         
##  [58] hms_0.5.3                 promises_1.1.0            Brobdingnag_1.2-6        
##  [61] parallel_3.6.2            inline_0.3.15             shinystan_2.5.0          
##  [64] yaml_2.2.1                gridExtra_2.3             loo_2.2.0                
##  [67] StanHeaders_2.19.0        stringi_1.4.5             dygraphs_1.1.1.6         
##  [70] pkgbuild_1.0.6            rlang_0.4.4               pkgconfig_2.0.3          
##  [73] matrixStats_0.55.0        HDInterval_0.2.0          evaluate_0.14            
##  [76] lattice_0.20-38           rstantools_2.0.0          htmlwidgets_1.5.1        
##  [79] labeling_0.3              tidyselect_1.0.0          processx_3.4.1           
##  [82] plyr_1.8.5                magrittr_1.5              R6_2.4.1                 
##  [85] generics_0.0.2            DBI_1.1.0                 pillar_1.4.3             
##  [88] haven_2.2.0               withr_2.1.2               xts_0.12-0               
##  [91] abind_1.4-5               metRology_0.9-28-1        modelr_0.1.5             
##  [94] crayon_1.3.4              arrayhelpers_1.0-20160527 utf8_1.1.4               
##  [97] rmarkdown_2.0             grid_3.6.2                readxl_1.3.1             
## [100] callr_3.4.1               threejs_0.3.3             reprex_0.3.0             
## [103] digest_0.6.23             xtable_1.8-4              numDeriv_2016.8-1.1      
## [106] httpuv_1.5.2              stats4_3.6.2              munsell_0.5.0            
## [109] viridisLite_0.3.0         shinyjs_1.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="overview-of-the-generalized-linear-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metric-predicted-variable-with-one-metric-predictor.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
