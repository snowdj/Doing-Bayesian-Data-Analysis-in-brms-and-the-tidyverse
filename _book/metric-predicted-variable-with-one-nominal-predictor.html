<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>19 Metric Predicted Variable with One Nominal Predictor | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="19 Metric Predicted Variable with One Nominal Predictor | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="19 Metric Predicted Variable with One Nominal Predictor | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metric-predicted-variable-with-multiple-metric-predictors.html"/>
<link rel="next" href="metric-predicted-variable-with-multiple-nominal-predictors.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#weve-come-so-far"><i class="fa fa-check"></i>We’ve come so far!</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-20"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#reference-21"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#reference-22"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#reference-23"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reference-24"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metric-predicted-variable-with-one-nominal-predictor" class="section level1">
<h1><span class="header-section-number">19</span> Metric Predicted Variable with One Nominal Predictor</h1>
<blockquote>
<p>This chapter considers data structures that consist of a metric predicted variable and a nominal predictor…. This type of data structure can arise from experiments or from observational studies. In experiments, the researcher assigns the categories (at random) to the experimental subjects. In observational studies, both the nominal predictor value and the metric predicted value are generated by processes outside the direct control of the researcher. In either case, the same mathematical description can be applied to the data (although causality is best inferred from experimental intervention).</p>
<p>The traditional treatment of this sort of data structure is called single-factor analysis of variance (ANOVA), or sometimes one-way ANOVA. Our Bayesian approach will be a hierarchical generalization of the traditional ANOVA model. The chapter will also consider the situation in which there is also a metric predictor that accompanies the primary nominal predictor. The metric predictor is sometimes called a covariate, and the traditional treatment of this data structure is called analysis of covariance (ANCOVA). The chapter also considers generalizations of the traditional models, because it is straight forward in Bayesian software to implement heavy-tailed distributions to accommodate outliers, along with hierarchical structure to accommodate heterogeneous variances in the different groups, etc. (pp. 553–554)</p>
</blockquote>
<div id="describing-multiple-groups-of-metric-data" class="section level2">
<h2><span class="header-section-number">19.1</span> Describing multiple groups of metric data</h2>
<blockquote>
<p>Figure 19.1 illustrates the conventional description of grouped metric data. Each group is represented as a position on the horizontal axis. The vertical axis represents the variable to be predicted by group membership. The data are assumed to be normally distributed within groups, with equal standard deviation in all groups. The group means are deflections from overall baseline, such that the deflections sum to zero. Figure 19.1 provides a specific numerical example, with data that were randomly generated from the model. (p. 554)</p>
</blockquote>
<p>We’ll want a custom data-generating function for our primary group data.</p>
<div class="sourceCode" id="cb1594"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1594-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1594-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1594-3" data-line-number="3">generate_data &lt;-<span class="st"> </span><span class="cf">function</span>(seed, mean) {</a>
<a class="sourceLine" id="cb1594-4" data-line-number="4">  <span class="kw">set.seed</span>(seed)</a>
<a class="sourceLine" id="cb1594-5" data-line-number="5">  <span class="kw">rnorm</span>(n, <span class="dt">mean =</span> grand_mean <span class="op">+</span><span class="st"> </span>mean, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1594-6" data-line-number="6">}</a>
<a class="sourceLine" id="cb1594-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1594-8" data-line-number="8">n          &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1594-9" data-line-number="9">grand_mean &lt;-<span class="st"> </span><span class="dv">101</span></a>
<a class="sourceLine" id="cb1594-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1594-11" data-line-number="11">d &lt;-</a>
<a class="sourceLine" id="cb1594-12" data-line-number="12"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">group     =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1594-13" data-line-number="13">         <span class="dt">deviation =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">-5</span>, <span class="dv">-2</span>, <span class="dv">6</span>, <span class="dv">-3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">map2</span>(group, deviation, generate_data)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-15" data-line-number="15"><span class="st">  </span><span class="kw">unnest</span>(d) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1594-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iteration =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">times =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1594-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1594-18" data-line-number="18"><span class="kw">glimpse</span>(d)</a></code></pre></div>
<pre><code>## Observations: 100
## Variables: 4
## $ group     &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2…
## $ deviation &lt;dbl&gt; 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, -5, -5, -5, -5, -5,…
## $ d         &lt;dbl&gt; 103.74709, 105.36729, 103.32874, 108.19056, 105.65902, 103.35906, 105.97486, 10…
## $ iteration &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 1, 2, 3,…</code></pre>
<p>Here we’ll make a tibble containing the necessary data for the rotated Gaussians. As far as I can tell, Kruschke’s Gaussians only span to the bounds of percentile-based 98% intervals. We partition off those bounds for each <code>group</code> by the <code>ll</code> and <code>ul</code> columns in the first <code>mutate()</code> function. In the second <code>mutate()</code>, we expand the dataset to include a sequence of 100 values between those lower- and upper-limit points. In the third <code>mutate()</code>, we feed those points into the <code>dnorm()</code> function, with group-specific means and a common <code>sd</code>.</p>
<div class="sourceCode" id="cb1596"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1596-1" data-line-number="1">densities &lt;-</a>
<a class="sourceLine" id="cb1596-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(group, deviation) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ll =</span> <span class="kw">qnorm</span>(.<span class="dv">01</span>, <span class="dt">mean =</span> grand_mean <span class="op">+</span><span class="st"> </span>deviation, <span class="dt">sd =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1596-5" data-line-number="5">         <span class="dt">ul =</span> <span class="kw">qnorm</span>(.<span class="dv">99</span>, <span class="dt">mean =</span> grand_mean <span class="op">+</span><span class="st"> </span>deviation, <span class="dt">sd =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">map2</span>(ll, ul, seq, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">map2</span>(d, grand_mean <span class="op">+</span><span class="st"> </span>deviation, dnorm, <span class="dt">sd =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1596-8" data-line-number="8"><span class="st">  </span><span class="kw">unnest</span>(<span class="kw">c</span>(d, density))</a>
<a class="sourceLine" id="cb1596-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1596-10" data-line-number="10"><span class="kw">head</span>(densities)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   group deviation    ll    ul     d density
##   &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1     1         4  100.  110.  100.  0.0133
## 2     1         4  100.  110.  100.  0.0148
## 3     1         4  100.  110.  101.  0.0165
## 4     1         4  100.  110.  101.  0.0183
## 5     1         4  100.  110.  101.  0.0203
## 6     1         4  100.  110.  101.  0.0224</code></pre>
<p>We’ll need two more supplementary tibbles to add the flourishes to the plot. The <code>arrow</code> tibble will specify our light-gray arrows. The <code>text</code> tibble will contain our annotation information.</p>
<div class="sourceCode" id="cb1598"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1598-1" data-line-number="1">arrow &lt;-</a>
<a class="sourceLine" id="cb1598-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">d         =</span> grand_mean,</a>
<a class="sourceLine" id="cb1598-3" data-line-number="3">         <span class="dt">group     =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1598-4" data-line-number="4">         <span class="dt">deviation =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">-5</span>, <span class="dv">-2</span>, <span class="dv">6</span>, <span class="dv">-3</span>),</a>
<a class="sourceLine" id="cb1598-5" data-line-number="5">         <span class="dt">offset    =</span> <span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb1598-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1598-7" data-line-number="7"><span class="kw">head</span>(arrow)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##       d group deviation offset
##   &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt;  &lt;dbl&gt;
## 1   101     1         4    0.1
## 2   101     2        -5    0.1
## 3   101     3        -2    0.1
## 4   101     4         6    0.1
## 5   101     5        -3    0.1</code></pre>
<div class="sourceCode" id="cb1600"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1600-1" data-line-number="1">text &lt;-</a>
<a class="sourceLine" id="cb1600-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">d         =</span> grand_mean,</a>
<a class="sourceLine" id="cb1600-3" data-line-number="3">         <span class="dt">group     =</span> <span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1600-4" data-line-number="4">         <span class="dt">deviation =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">-5</span>, <span class="dv">-2</span>, <span class="dv">6</span>, <span class="dv">-3</span>, <span class="dv">10</span>),</a>
<a class="sourceLine" id="cb1600-5" data-line-number="5">         <span class="dt">offset    =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb1600-6" data-line-number="6">         <span class="dt">angle     =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">90</span>, <span class="dv">0</span>), <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">1</span>)),</a>
<a class="sourceLine" id="cb1600-7" data-line-number="7">         <span class="dt">label     =</span> <span class="kw">c</span>(<span class="st">&quot;beta[0]==101&quot;</span>, <span class="st">&quot;beta[&#39;[1]&#39;]==4&quot;</span>,<span class="st">&quot;beta[&#39;[2]&#39;]==-5&quot;</span>, <span class="st">&quot;beta[&#39;[3]&#39;]==-2&quot;</span>, <span class="st">&quot;beta[&#39;[4]&#39;]==6&quot;</span>, <span class="st">&quot;beta[&#39;[5]&#39;]==3&quot;</span>, <span class="st">&quot;sigma[&#39;all&#39;]==2&quot;</span>))</a>
<a class="sourceLine" id="cb1600-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1600-9" data-line-number="9"><span class="kw">head</span>(text)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##       d group deviation offset angle label          
##   &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          
## 1   101     0         0   0.25    90 beta[0]==101   
## 2   101     1         4   0.25    90 beta[&#39;[1]&#39;]==4 
## 3   101     2        -5   0.25    90 beta[&#39;[2]&#39;]==-5
## 4   101     3        -2   0.25    90 beta[&#39;[3]&#39;]==-2
## 5   101     4         6   0.25    90 beta[&#39;[4]&#39;]==6 
## 6   101     5        -3   0.25    90 beta[&#39;[5]&#39;]==3</code></pre>
<p>Now we’re ready to plot.</p>
<div class="sourceCode" id="cb1602"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1602-1" data-line-number="1"><span class="kw">library</span>(ggridges)</a>
<a class="sourceLine" id="cb1602-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1602-3" data-line-number="3">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1602-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> d, <span class="dt">y =</span> group, <span class="dt">group =</span> group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> grand_mean, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-7" data-line-number="7"><span class="st">  </span><span class="co"># the Gausians</span></a>
<a class="sourceLine" id="cb1602-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_ridgeline</span>(<span class="dt">data =</span> densities,</a>
<a class="sourceLine" id="cb1602-9" data-line-number="9">                 <span class="kw">aes</span>(<span class="dt">height =</span> <span class="op">-</span>density),</a>
<a class="sourceLine" id="cb1602-10" data-line-number="10">                 <span class="dt">min_height =</span> <span class="ot">NA</span>, <span class="dt">scale =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1602-11" data-line-number="11">                 <span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-12" data-line-number="12"><span class="st">  </span><span class="co"># the small arrows</span></a>
<a class="sourceLine" id="cb1602-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">data =</span> arrow,</a>
<a class="sourceLine" id="cb1602-14" data-line-number="14">               <span class="kw">aes</span>(<span class="dt">xend =</span> d <span class="op">+</span><span class="st"> </span>deviation,</a>
<a class="sourceLine" id="cb1602-15" data-line-number="15">                   <span class="dt">y =</span> group <span class="op">+</span><span class="st"> </span>offset, <span class="dt">yend =</span> group <span class="op">+</span><span class="st"> </span>offset),</a>
<a class="sourceLine" id="cb1602-16" data-line-number="16">               <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1602-17" data-line-number="17">               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-18" data-line-number="18"><span class="st">  </span><span class="co"># the large arrow on the left</span></a>
<a class="sourceLine" id="cb1602-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">80</span>, <span class="dt">xend =</span> grand_mean,</a>
<a class="sourceLine" id="cb1602-20" data-line-number="20">                   <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1602-21" data-line-number="21">               <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1602-22" data-line-number="22">               <span class="dt">arrow =</span> <span class="kw">arrow</span>(<span class="dt">length =</span> <span class="kw">unit</span>(.<span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-23" data-line-number="23"><span class="st">  </span><span class="co"># the text</span></a>
<a class="sourceLine" id="cb1602-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> text,</a>
<a class="sourceLine" id="cb1602-25" data-line-number="25">            <span class="kw">aes</span>(<span class="dt">x =</span> grand_mean <span class="op">+</span><span class="st"> </span>deviation, <span class="dt">y =</span> group <span class="op">+</span><span class="st"> </span>offset,</a>
<a class="sourceLine" id="cb1602-26" data-line-number="26">                <span class="dt">label =</span> label, <span class="dt">angle =</span> angle), </a>
<a class="sourceLine" id="cb1602-27" data-line-number="27">            <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">parse =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb1602-29" data-line-number="29">                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;&lt;1,0,0,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,1,0,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,1,0,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,0,1,0&gt;&quot;</span>, <span class="st">&quot;&lt;0,0,0,0,1&gt;&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-30" data-line-number="30"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-31" data-line-number="31"><span class="st">  </span><span class="kw">coord_flip</span>(<span class="dt">xlim =</span> <span class="dv">90</span><span class="op">:</span><span class="dv">112</span>,</a>
<a class="sourceLine" id="cb1602-32" data-line-number="32">             <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.2</span>, <span class="fl">5.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1602-33" data-line-number="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-5-1.png" style="display: block; margin: auto;" /></p>
<blockquote>
<p>The descriptive model presented in Figure 19.1 is the traditional one used by classical ANOVA (which is described a bit more in the next section). More general models are straight forward to implement in Bayesian software. For example, outliers could be accommodated by using heavy-tailed noise distributions (such as a <span class="math inline">\(t\)</span> distribution) instead of a normal distribution, and different groups could be given different standard deviations. (p. 556)</p>
</blockquote>
</div>
<div id="traditional-analysis-of-variance" class="section level2">
<h2><span class="header-section-number">19.2</span> Traditional analysis of variance</h2>
<blockquote>
<p>The terminology, “analysis of variance,” comes from a decomposition of overall data variance into within-group variance and between-group variance (<a href="http://psycnet.apa.org/record/1925-15003-000">Fisher, 1925</a>). Algebraically, the sum of squared deviations of the scores from their overall mean equals the sum of squared deviations of the scores from their respective group means plus the sum of squared deviations of the group means from the overall mean. In other words, the total variance can be partitioned into within-group variance plus between-group variance. Because one definition of the word “analysis” is separation into constituent parts, the term ANOVA accurately describes the underlying algebra in the traditional methods. That algebraic relation is not used in the hierarchical Bayesian approach presented here. The Bayesian method can estimate component variances, however. Therefore, the Bayesian approach is not ANOVA, but is analogous to ANOVA. (p. 556)</p>
</blockquote>
</div>
<div id="hierarchical-bayesian-approach" class="section level2">
<h2><span class="header-section-number">19.3</span> Hierarchical Bayesian approach</h2>
<p>“Our goal is to estimate its parameters in a Bayesian framework. Therefore, all the parameters need to be given a meaningfully structured prior distribution” (p. 557). However, our approach will depart a little from the one in the text. All our parameters will <strong>not</strong> “have generic noncommittal prior distributions” (p. 557). Most importantly, we will not follow the example in <a href="http://www.stat.columbia.edu/~gelman/research/published/taumain.pdf">Gelman (2006)</a> of putting a broad uniform prior on <span class="math inline">\(\sigma_y\)</span>. Rather, we will continue using the half-Gaussian prior, as <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">recommended by the Stan team</a>. However, we will follow Kruschke’s lead for the overall intercept and use a Gaussian prior “made broad on the scale of the data” (p. 557). And like Kruschke, we will estimate <span class="math inline">\(\sigma_\beta\)</span> from the data.</p>
<p>Later on, Kruschke opined:</p>
<blockquote>
<p>A crucial pre-requisite for estimating <span class="math inline">\(\sigma_\beta\)</span> from all the groups is an assumption that all the groups are representative and informative for the estimate. It only makes sense to influence the estimate of one group with data from the other groups if the groups can be meaningfully described as representative of a shared higher-level distribution. (p. 559)</p>
</blockquote>
<p>Although I agree with him in spirit, this doesn’t appear to strictly be the case. As odd and paradoxical as this sounds, partial pooling can be of use even when the some of the cases are of a different kind. For more on the topic, see <a href="http://statweb.stanford.edu/~ckirby/brad/other/Article1977.pdf">Efron and Morris’s classic paper</a> and <a href="https://solomonkurz.netlify.com/post/stein-s-paradox-and-what-partial-pooling-can-do-for-you/">my blog post</a> walking out one of their examples in <strong>brms</strong>.</p>
<div id="implementation-in-jags-brms." class="section level3">
<h3><span class="header-section-number">19.3.1</span> Implementation in <del>JAGS</del> brms.</h3>
<p>The <strong>brms</strong> setup, of course, differs a bit from JAGS.</p>
<div class="sourceCode" id="cb1603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1603-1" data-line-number="1">fit &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1603-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1603-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1603-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>categirical_variable),</a>
<a class="sourceLine" id="cb1603-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, x), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1603-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, x), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1603-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, x), <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1603-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, x), <span class="dt">class =</span> sigma)))</a></code></pre></div>
<p>The noise standard deviation <span class="math inline">\(\sigma_y\)</span> is depicted in the prior statement including the argument <code>class = sigma</code>. The grand mean is depicted by the first <code>1</code> in the model formula and its prior is indicated by the <code>class = Intercept</code> argument. We indicate we’d like group-based deviations from the grand mean with the <code>(1 | categirical_variable)</code> syntax, where the <code>1</code> on the left side of the bar indicates we’d like our intercepts to vary by group and the <code>categirical_variable</code> part simply represents the name of a given categorical variable we’d like those intercepts to vary by. The <strong>brms</strong> default is to do this with deviance scores, the mean for which will be zero. Although it’s not obvious in the formula syntax, the model presumes the group-based deviations are normally distributed with a mean of zero and a standard deviation, which Kruschke termed <span class="math inline">\(\sigma_\beta\)</span>. There is no prior for the mean. It’s set at zero. But there is a prior for <span class="math inline">\(\sigma_\beta\)</span>, which is denoted by the argument <code>class = sd</code>. We, of course, are not using a uniform prior on any of our variance parameters. But in order to be weakly informative, we will use the half-Cauchy. Recall that since the <strong>brms</strong> default is to set the lower bound for any variance parameter to 0, there’s no need to worry about doing so ourselves. So even though the syntax only indicates <code>cauchy</code>, it’s understood to mean Cauchy with a lower bound at zero; since the mean is usually 0, that makes is a half-Cauchy.</p>
<p>Kruschke set the upper bound for his <span class="math inline">\(\sigma_y\)</span> to 10 times the standard deviation of the criterion variable. The tails of the half-Cauchy are sufficiently fat that, in practice, I’ve found it doesn’t matter much what you set the <span class="math inline">\(SD\)</span> of its prior to. One is often a sensible default for reasonably-scaled data. But if we want to take a more principled approach, we can set it to the size of the criterion’s <span class="math inline">\(SD\)</span> or perhaps even 10 times that.</p>
<p>Kruschke suggested using a gamma on <span class="math inline">\(\sigma_\beta\)</span>, which is a sensible alternative to half-Cauchy often used within the Stan universe. Especially in situations in which you would like to (a) keep the variance parameter above zero, but (b) still allow it to be arbitrarily close to zero, and also (c) let the likelihood dominate the posterior, the Stan team recommends the gamma(2, 0) prior, based on the <a href="http://www.stat.columbia.edu/~gelman/research/published/chung_etal_Pmetrika2013.pdf">paper by Chung and colleagues</a>. But you should note that I don’t mean a literal 0 for the second parameter in the gamma distribution, but rather some small value like 0.1 or so. This is all clarified in <a href="http://www.stat.columbia.edu/~gelman/research/published/chung_etal_Pmetrika2013.pdf">Chung et al</a>. Here’s what <span class="math inline">\(\operatorname{gamma} (2, 0.1)\)</span> looks like.</p>
<div class="sourceCode" id="cb1604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1604-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">110</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1604-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb1604-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dgamma</span>(x, <span class="dv">2</span>, <span class="fl">0.1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1604-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1604-5" data-line-number="5"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="fl">14.25</span>, <span class="dt">y =</span> <span class="fl">0.015</span>, <span class="dt">label =</span> <span class="st">&quot;&#39;gamma&#39;~(2*&#39;, &#39;*0.1)&quot;</span>, </a>
<a class="sourceLine" id="cb1604-6" data-line-number="6">           <span class="dt">parse =</span> T, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">size =</span> <span class="fl">4.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1604-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1604-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">100</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1604-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /></p>
<p>If you’d like that prior be even less informative, just reduce it to like <span class="math inline">\(\operatorname{gamma} (2, 0.01)\)</span> or so. Kruschke goes further to recommend “the shape and rate parameters of the gamma distribution are set so its mode is <code>sd(y)/2</code> and its standard deviation is <code>2*sd(y)</code>, using the function <code>gammaShRaFromModeSD</code> explained in Section 9.2.2.” (pp. 560–561). Let’s make that function.</p>
<div class="sourceCode" id="cb1605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1605-1" data-line-number="1">gamma_a_b_from_omega_sigma &lt;-<span class="st"> </span><span class="cf">function</span>(mode, sd) {</a>
<a class="sourceLine" id="cb1605-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb1605-3" data-line-number="3">  <span class="cf">if</span> (mode <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;mode must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb1605-4" data-line-number="4">  <span class="cf">if</span> (sd   <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span>) <span class="kw">stop</span>(<span class="st">&quot;sd must be &gt; 0&quot;</span>)</a>
<a class="sourceLine" id="cb1605-5" data-line-number="5">  rate &lt;-<span class="st"> </span>(mode <span class="op">+</span><span class="st"> </span><span class="kw">sqrt</span>(mode<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>sd<span class="op">^</span><span class="dv">2</span>)) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1605-6" data-line-number="6">  shape &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>mode <span class="op">*</span><span class="st"> </span>rate</a>
<a class="sourceLine" id="cb1605-7" data-line-number="7">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">shape =</span> shape, <span class="dt">rate =</span> rate))</a>
<a class="sourceLine" id="cb1605-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb1605-9" data-line-number="9">}</a></code></pre></div>
<p>So in the case of standardized data where <code>sd(1)</code> = 1, we’d use our <code>gamma_a_b_from_omega_sigma()</code> function like so.</p>
<div class="sourceCode" id="cb1606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1606-1" data-line-number="1">sd_y  &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb1606-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1606-3" data-line-number="3">omega &lt;-<span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1606-4" data-line-number="4">sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y</a>
<a class="sourceLine" id="cb1606-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1606-6" data-line-number="6">(s_r &lt;-<span class="st"> </span><span class="kw">gamma_a_b_from_omega_sigma</span>(<span class="dt">mode =</span> omega, <span class="dt">sd =</span> sigma))</a></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.5663911</code></pre>
<p>And that produces the following gamma distribution.</p>
<div class="sourceCode" id="cb1608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1608-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">50</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1608-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb1608-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dgamma</span>(x, s_r<span class="op">$</span>shape, s_r<span class="op">$</span>rate))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1608-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1608-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1608-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1608-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">20</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1608-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-10-1.png" style="display: block; margin: auto;" /></p>
<p>In the parameter space that matters, from zero to one, that gamma is pretty noninformative. It peaks between the two, slopes very gently rightward, but has the nice steep slope on the left keeping the estimates off the zero boundary. And even though that right slope is very gentle given the scale of the data, it’s aggressive enough that it should keep the MCMC chains from spending a lot of time in ridiculous parts of the parameter space. I.e., when working with finite numbers of iterations, we want our MCMC chains wasting exactly zero iterations investigating what the density might be for <span class="math inline">\(\sigma_\beta \approx 1e10\)</span> for standardized data.</p>
</div>
<div id="example-sex-and-death." class="section level3">
<h3><span class="header-section-number">19.3.2</span> Example: Sex and death.</h3>
<p>Let’s load and <code>glimpse()</code> at <a href="http://jse.amstat.org/v2n1/datasets.hanley.html">Hanley and Shapiro’s (1994)</a> fruit-fly data.</p>
<div class="sourceCode" id="cb1609"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1609-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/FruitflyDataReduced.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1609-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1609-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 125
## Variables: 3
## $ Longevity       &lt;dbl&gt; 35, 37, 49, 46, 63, 39, 46, 56, 63, 65, 56, 65, 70, 63, 65, 70, 77, 81, 8…
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnan…
## $ Thorax          &lt;dbl&gt; 0.64, 0.68, 0.68, 0.72, 0.72, 0.76, 0.76, 0.76, 0.76, 0.76, 0.80, 0.80, 0…</code></pre>
<p>We can use <code>geom_density_ridges()</code> to help get a sense of how our criterion <code>Longevity</code> is distributed across groups of <code>CompanionNumber</code>.</p>
<div class="sourceCode" id="cb1611"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1611-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">group_mean =</span> <span class="kw">mean</span>(Longevity)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-4" data-line-number="4"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">CompanionNumber =</span> <span class="kw">fct_reorder</span>(CompanionNumber, group_mean)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1611-6" data-line-number="6"><span class="st">  </span></a>
<a class="sourceLine" id="cb1611-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Longevity, <span class="dt">y =</span> CompanionNumber, <span class="dt">fill =</span> group_mean)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1611-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">scale =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="fl">.2</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1611-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">end =</span> <span class="fl">.92</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1611-10" data-line-number="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1611-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1611-12" data-line-number="12">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1611-13" data-line-number="13">        <span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb1611-14" data-line-number="14">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /></p>
<p>Let’s fire up <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1612-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>We’ll want to do the preparatory work to define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1613"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1613-1" data-line-number="1">(mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Longevity))</a></code></pre></div>
<pre><code>## [1] 57.44</code></pre>
<div class="sourceCode" id="cb1615"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1615-1" data-line-number="1">(sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Longevity))</a></code></pre></div>
<pre><code>## [1] 17.56389</code></pre>
<div class="sourceCode" id="cb1617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1617-1" data-line-number="1">omega &lt;-<span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1617-2" data-line-number="2">sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y</a>
<a class="sourceLine" id="cb1617-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1617-4" data-line-number="4">(s_r &lt;-<span class="st"> </span><span class="kw">gamma_a_b_from_omega_sigma</span>(<span class="dt">mode =</span> omega, <span class="dt">sd =</span> sigma))</a></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.03224747</code></pre>
<p>With the prep work is done, here are our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1619-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1619-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y,    <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1619-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,      <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1619-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>shape, <span class="dt">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1619-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>rate,  <span class="dt">name =</span> <span class="st">&quot;beta&quot;</span>)</a></code></pre></div>
<p>Now fit the model, our hierarchical Bayesian alternative to an ANOVA.</p>
<div class="sourceCode" id="cb1620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1620-1" data-line-number="1">fit19<span class="fl">.1</span> &lt;-</a>
<a class="sourceLine" id="cb1620-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1620-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1620-4" data-line-number="4">      Longevity <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CompanionNumber),</a>
<a class="sourceLine" id="cb1620-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1620-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">gamma</span>(alpha, beta), <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1620-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1620-8" data-line-number="8">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1620-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1620-10" data-line-number="10">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>),</a>
<a class="sourceLine" id="cb1620-11" data-line-number="11">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1620-12" data-line-number="12">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.01&quot;</span>)</a></code></pre></div>
<p>Much like Kruschke’s JAGS chains, our <strong>brms</strong> chains are well behaved.</p>
<div class="sourceCode" id="cb1621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1621-1" data-line-number="1"><span class="kw">plot</span>(fit19<span class="fl">.1</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /></p>
<p>Also like Kruschke, our chains appear moderately autocorrelated.</p>
<div class="sourceCode" id="cb1622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1622-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit19<span class="fl">.1</span>, <span class="dt">add_chain =</span> T)</a>
<a class="sourceLine" id="cb1622-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1622-3" data-line-number="3"><span class="kw">library</span>(bayesplot)</a>
<a class="sourceLine" id="cb1622-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1622-5" data-line-number="5"><span class="kw">theme_set</span>(<span class="kw">theme_gray</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1622-6" data-line-number="6"><span class="st">            </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a>
<a class="sourceLine" id="cb1622-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1622-8" data-line-number="8"><span class="kw">mcmc_acf</span>(post, <span class="dt">pars =</span> <span class="kw">c</span>(<span class="st">&quot;b_Intercept&quot;</span>, <span class="st">&quot;sd_CompanionNumber__Intercept&quot;</span>, <span class="st">&quot;sigma&quot;</span>), <span class="dt">lags =</span> <span class="dv">10</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1623-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + (1 | CompanionNumber) 
##    Data: my_data (Number of observations: 125) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Group-Level Effects: 
## ~CompanionNumber (Number of levels: 5) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    15.03      8.04     6.24    36.42 1.00     2311     3554
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    57.59      7.51    43.03    73.39 1.00     2505     3147
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.93      0.97    13.22    16.98 1.00     5824     5872
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>With the <code>ranef()</code> function, we can get the summaries of the group-specific deflections.</p>
<div class="sourceCode" id="cb1625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1625-1" data-line-number="1"><span class="kw">ranef</span>(fit19<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## $CompanionNumber
## , , Intercept
## 
##              Estimate Est.Error       Q2.5     Q97.5
## None0       5.5794036  7.818598 -10.238748 20.800280
## Pregnant1   6.7890585  7.816206  -9.059062 22.125098
## Pregnant8   5.3766714  7.839145 -10.687290 20.717351
## Virgin1    -0.7754446  7.856840 -17.380637 14.139118
## Virgin8   -17.7177658  7.939150 -34.940259 -3.181382</code></pre>
<p>And with the <code>coef()</code> function, we can get those same group-level summaries in a non-deflection metric.</p>
<div class="sourceCode" id="cb1627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1627-1" data-line-number="1"><span class="kw">coef</span>(fit19<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>## $CompanionNumber
## , , Intercept
## 
##           Estimate Est.Error     Q2.5    Q97.5
## None0     63.17168  2.921267 57.43048 68.80815
## Pregnant1 64.38133  2.927249 58.70815 70.16666
## Pregnant8 62.96894  2.920661 57.21388 68.65320
## Virgin1   56.81683  2.934214 51.12637 62.52715
## Virgin8   39.87451  3.091971 33.85827 46.00826</code></pre>
<p>Those are all estimates of the group-specific means. Since it wasn’t modeled, all have the same parameter estimates for <span class="math inline">\(\sigma_y\)</span>.</p>
<div class="sourceCode" id="cb1629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1629-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit19<span class="fl">.1</span>)[<span class="st">&quot;sigma&quot;</span>, ]</a></code></pre></div>
<pre><code>##   Estimate  Est.Error       Q2.5      Q97.5 
## 14.9346100  0.9662639 13.2174322 16.9832791</code></pre>
<p>To prepare for our version of the top panel of Figure 19.3, we’ll use <code>sample_n()</code> to randomly sample from the posterior draws.</p>
<div class="sourceCode" id="cb1631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1631-1" data-line-number="1"><span class="co"># how many random draws from the posterior would you like?</span></a>
<a class="sourceLine" id="cb1631-2" data-line-number="2">n_draws &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1631-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1631-4" data-line-number="4"><span class="kw">set.seed</span>(<span class="dv">19</span>)</a>
<a class="sourceLine" id="cb1631-5" data-line-number="5">post_draws &lt;-</a>
<a class="sourceLine" id="cb1631-6" data-line-number="6"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1631-7" data-line-number="7"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> n_draws, <span class="dt">replace =</span> F)</a>
<a class="sourceLine" id="cb1631-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1631-9" data-line-number="9"><span class="kw">glimpse</span>(post_draws)</a></code></pre></div>
<pre><code>## Observations: 20
## Variables: 11
## $ b_Intercept                              &lt;dbl&gt; 51.37055, 42.46025, 58.43885, 56.01002, 48.52338…
## $ sd_CompanionNumber__Intercept            &lt;dbl&gt; 16.262790, 17.931260, 10.294159, 14.104043, 27.4…
## $ sigma                                    &lt;dbl&gt; 13.71128, 13.91828, 16.24448, 14.03107, 16.30758…
## $ `r_CompanionNumber[None0,Intercept]`     &lt;dbl&gt; 14.6642542, 18.4782479, 0.3908729, 6.5999786, 14…
## $ `r_CompanionNumber[Pregnant1,Intercept]` &lt;dbl&gt; 12.207309, 23.184843, 9.985389, 15.058426, 19.47…
## $ `r_CompanionNumber[Pregnant8,Intercept]` &lt;dbl&gt; 9.7663362, 15.5679928, 7.3901457, 7.7165676, 15.…
## $ `r_CompanionNumber[Virgin1,Intercept]`   &lt;dbl&gt; 6.04861233, 15.33460132, -3.33245392, 0.58641261…
## $ `r_CompanionNumber[Virgin8,Intercept]`   &lt;dbl&gt; -12.425826, -3.181759, -14.673815, -15.790020, -…
## $ lp__                                     &lt;dbl&gt; -526.6386, -528.8238, -531.0766, -528.5373, -526…
## $ chain                                    &lt;fct&gt; 3, 4, 2, 3, 1, 2, 2, 4, 1, 4, 4, 4, 2, 4, 2, 2, …
## $ iter                                     &lt;dbl&gt; 2677, 1910, 2483, 2557, 3745, 2803, 3677, 2255, …</code></pre>
<p>Before we make our version of the top panel, let’s make a corresponding plot of the fixed intercept, the grand mean. The most important lines in the code, below are the ones where we used <code>stat_function()</code> within <code>mapply()</code>.</p>
<div class="sourceCode" id="cb1633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1633-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">150</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1633-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1633-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-4" data-line-number="4"><span class="st">  </span><span class="kw">mapply</span>(<span class="cf">function</span>(mean, sd) {</a>
<a class="sourceLine" id="cb1633-5" data-line-number="5">    <span class="kw">stat_function</span>(<span class="dt">fun   =</span> dnorm, </a>
<a class="sourceLine" id="cb1633-6" data-line-number="6">                  <span class="dt">args  =</span> <span class="kw">list</span>(<span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd), </a>
<a class="sourceLine" id="cb1633-7" data-line-number="7">                  <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, </a>
<a class="sourceLine" id="cb1633-8" data-line-number="8">                  <span class="dt">size  =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1633-9" data-line-number="9">                  <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>)</a>
<a class="sourceLine" id="cb1633-10" data-line-number="10">    }, </a>
<a class="sourceLine" id="cb1633-11" data-line-number="11">    <span class="co"># enter means and standard deviations here</span></a>
<a class="sourceLine" id="cb1633-12" data-line-number="12">    <span class="dt">mean =</span> post_draws[, <span class="st">&quot;b_Intercept&quot;</span>],</a>
<a class="sourceLine" id="cb1633-13" data-line-number="13">    <span class="dt">sd   =</span> post_draws[, <span class="st">&quot;sigma&quot;</span>]</a>
<a class="sourceLine" id="cb1633-14" data-line-number="14">    ) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> my_data, <span class="kw">aes</span>(<span class="dt">x =</span> Longevity, <span class="dt">y =</span> <span class="fl">-0.001</span>),</a>
<a class="sourceLine" id="cb1633-16" data-line-number="16">              <span class="dt">height =</span> <span class="fl">.001</span>, </a>
<a class="sourceLine" id="cb1633-17" data-line-number="17">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;Longevity&quot;</span>, <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-20" data-line-number="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Posterior Predictive Distribution&quot;</span>,</a>
<a class="sourceLine" id="cb1633-21" data-line-number="21">       <span class="dt">subtitle =</span> <span class="st">&quot;The jittered dots are the ungrouped Longevity data. The</span><span class="ch">\n</span><span class="st">Gaussians are posterior draws depicting the overall</span><span class="ch">\n</span><span class="st">distribution, the grand mean.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1633-22" data-line-number="22"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">110</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /></p>
<p>Unfortunately, we can’t extend our <code>mapply(stat_function())</code> method to the group-level estimates. To my knowledge, there isn’t a way to show the group estimates at different spots along the y-axis. And our <code>mapply(stat_function())</code> approach has other limitations, too. Happily, we have some great alternatives. To use them, we’ll need a little help from <strong>tidybayes</strong>.</p>
<div class="sourceCode" id="cb1634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1634-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a></code></pre></div>
<p>For the first part, we’ll take <code>tidybayes::add_fitted_draws()</code> for a whirl.</p>
<div class="sourceCode" id="cb1635"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1635-1" data-line-number="1">densities &lt;-</a>
<a class="sourceLine" id="cb1635-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1635-4" data-line-number="4"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit19<span class="fl">.1</span>, <span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">seed =</span> <span class="dv">19</span>, <span class="dt">dpar =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>))</a>
<a class="sourceLine" id="cb1635-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1635-6" data-line-number="6"><span class="kw">glimpse</span>(densities)</a></code></pre></div>
<pre><code>## Observations: 100
## Variables: 8
## Groups: CompanionNumber, .row [5]
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnan…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw           &lt;int&gt; 1115, 2133, 2685, 2745, 4031, 4436, 4483, 4803, 5677, 5784, 7173, 7557, 7…
## $ .value          &lt;dbl&gt; 60.74737, 63.17496, 59.68698, 63.73562, 60.19609, 59.72371, 65.82900, 61.…
## $ mu              &lt;dbl&gt; 60.74737, 63.17496, 59.68698, 63.73562, 60.19609, 59.72371, 65.82900, 61.…
## $ sigma           &lt;dbl&gt; 15.11354, 14.27563, 16.01779, 16.30758, 14.23716, 15.40663, 16.24448, 14.…</code></pre>
<p>With the first two lines, we made a <span class="math inline">\(5 \times 1\)</span> tibble containing the five levels of the experimental grouping variable, <code>CompanionNumber</code>. The <a href="https://cran.r-project.org/web/packages/tidybayes/tidybayes.pdf"><code>add_fitted_draws()</code></a> function comes from <strong>tidybayes</strong>. The first argument of the <code>add_fitted_draws()</code> is <code>newdata</code>, which works much like it does in <code>brms::fitted()</code>; it took our <span class="math inline">\(5 \times 1\)</span> tibble. The next argument took our <strong>brms</strong> model fit, <code>fit19.1</code>. With the <code>n</code> argument, we indicated we just wanted 20 random draws from the posterior. The <code>seed</code> argument makes those random draws reproducible. With <code>dpar</code>, we requested distributional regression parameters in the output. In our case, those were the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> values for each level of <code>CompanionNumber</code>. Since we took 20 draws across 5 groups, we ended up with a 100-row tibble.</p>
<p>The next steps are a direct extension of the method we used to make our Gaussians for our version of Figure 19.1.</p>
<div class="sourceCode" id="cb1637"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1637-1" data-line-number="1">densities &lt;-</a>
<a class="sourceLine" id="cb1637-2" data-line-number="2"><span class="st">  </span>densities <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ll =</span> <span class="kw">qnorm</span>(.<span class="dv">025</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma),</a>
<a class="sourceLine" id="cb1637-4" data-line-number="4">         <span class="dt">ul =</span> <span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Longevity =</span> <span class="kw">map2</span>(ll, ul, seq, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-6" data-line-number="6"><span class="st">  </span><span class="kw">unnest</span>(Longevity) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1637-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(Longevity, mu, sigma))</a>
<a class="sourceLine" id="cb1637-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1637-9" data-line-number="9"><span class="kw">glimpse</span>(densities)</a></code></pre></div>
<pre><code>## Observations: 10,000
## Variables: 12
## Groups: CompanionNumber, .row [5]
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnan…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw           &lt;int&gt; 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1…
## $ .value          &lt;dbl&gt; 60.74737, 60.74737, 60.74737, 60.74737, 60.74737, 60.74737, 60.74737, 60.…
## $ mu              &lt;dbl&gt; 60.74737, 60.74737, 60.74737, 60.74737, 60.74737, 60.74737, 60.74737, 60.…
## $ sigma           &lt;dbl&gt; 15.11354, 15.11354, 15.11354, 15.11354, 15.11354, 15.11354, 15.11354, 15.…
## $ ll              &lt;dbl&gt; 31.12538, 31.12538, 31.12538, 31.12538, 31.12538, 31.12538, 31.12538, 31.…
## $ ul              &lt;dbl&gt; 90.36936, 90.36936, 90.36936, 90.36936, 90.36936, 90.36936, 90.36936, 90.…
## $ Longevity       &lt;dbl&gt; 31.12538, 31.72381, 32.32223, 32.92066, 33.51908, 34.11750, 34.71593, 35.…
## $ density         &lt;dbl&gt; 0.003867068, 0.004175850, 0.004502224, 0.004846502, 0.005208934, 0.005589…</code></pre>
<p>If you look at the code we used to make <code>ll</code> and <code>ul</code>, you’ll see we used 95% intervals, this time. Our second <code>mutate()</code> function is basically the same. After unnesting the tibble, we just needed to plug in the <code>Longevity</code>, <code>mu</code>, and <code>sigma</code> values into the <code>dnorm()</code> function to compute the corresponding density values.</p>
<div class="sourceCode" id="cb1639"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1639-1" data-line-number="1">densities <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1639-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Longevity, <span class="dt">y =</span> CompanionNumber)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1639-3" data-line-number="3"><span class="st">  </span><span class="co"># here we make our density lines</span></a>
<a class="sourceLine" id="cb1639-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ridgeline</span>(<span class="kw">aes</span>(<span class="dt">height =</span> density, <span class="dt">group =</span> <span class="kw">interaction</span>(CompanionNumber, .draw)),</a>
<a class="sourceLine" id="cb1639-5" data-line-number="5">                 <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha.f =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1639-6" data-line-number="6">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">scale =</span> <span class="dv">25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1639-7" data-line-number="7"><span class="st">  </span><span class="co"># the original data with little jitter thrown in</span></a>
<a class="sourceLine" id="cb1639-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1639-9" data-line-number="9">              <span class="dt">height =</span> <span class="fl">.04</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1639-10" data-line-number="10"><span class="st">  </span><span class="co"># pretty much everything below this line is aesthetic fluff</span></a>
<a class="sourceLine" id="cb1639-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1639-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>, </a>
<a class="sourceLine" id="cb1639-13" data-line-number="13">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1639-14" data-line-number="14"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">110</span>,</a>
<a class="sourceLine" id="cb1639-15" data-line-number="15">                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">5.25</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1639-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1639-17" data-line-number="17">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /></p>
<p>Do be aware that when you use this method, you may have to fiddle around with the <code>geom_ridgeline()</code> <code>scale</code> argument to get the Gaussian’s heights on reasonable-looking relative heights. Stick in different numbers to get a sense of what I mean. I also find that I’m often not a fan of the way the spacing on the y axis ends up with default <code>geom_ridgeline()</code>. It’s easy to overcome this with a little <code>ylim</code> fiddling.</p>
<p>To return to the more substantive interpretation, the top panel of</p>
<blockquote>
<p>Figure 19.3 suggests that the normal distributions with homogeneous variances appear to be reasonable descriptions of the data. There are no dramatic outliers relative to the posterior predicted curves, and the spread of the data within each group appears to be reasonably matched by the width of the posterior normal curves. (Be careful when making visual assessments of homogeneity of variance because the visual spread of the data depends on the sample size; for a reminder see the [see the right panel of Figure 17.1, p. 478].) The range of credible group means, indicated by the peaks of the normal curves, suggests that the group Virgin8 is clearly lower than the others, and the group Virgin1 might be lower than the controls. To find out for sure, we need to examine the differences of group means, which we do in the next section. (p. 564)</p>
</blockquote>
<p>For clarity, the “see the right panel of Figure 17.1, p. 478” part was changed following <a href="https://sites.google.com/site/doingbayesiandataanalysis/corrigenda">Kruschke’s Corrigenda</a>.</p>
</div>
<div id="contrasts." class="section level3">
<h3><span class="header-section-number">19.3.3</span> Contrasts.</h3>
<blockquote>
<p>It is straight forward to examine the posterior distribution of credible differences. Every step in the MCMC chain provides a combination of group means that are jointly credible, given the data. Therefore, every step in the MCMC chain provides a credible difference between groups…</p>
<p>To construct the credible differences of group 1 and group 2, at every step in the MCMC chain we compute</p>
<p><span class="math display">\[\begin{align*}
\mu_1 - \mu_2 &amp; =  (\beta_0 + \beta_1) - (\beta_0 + \beta_2) \\
              &amp; =  (+1) \cdot \beta_1 + (-1) \cdot \beta_2
\end{align*}\]</span></p>
<p>In other words, the baseline cancels out of the calculation, and the difference is a sum of weighted group deflections. Notice that the weights sum to zero. To construct the credible differences of the average of groups 1-3 and the average of groups 4-5, at every step in the MCMC chain we compute</p>
<p><span class="math display">\[\begin{align*}
(\mu_1 + \mu_2 + \mu_3) / 3 - (\mu_4 + \mu_5) / 2 &amp; = ((\beta_0 + \beta_1)  + (\beta_0 + \beta_2)  + (\beta_0 + \beta_3) ) / 3 - ((\beta_0 + \beta_4) + (\beta_0 + \beta_5) ) / 2 \\
&amp; = (\beta_1 + \beta_2 + \beta_3) / 3 - (\beta_4 + \beta_5) / 2 \\
&amp; = (+ 1/3) \cdot \beta_1 + (+ 1/3) \cdot \beta_2 + (+ 1/3) \cdot \beta_3 + (- 1/2) \cdot \beta_4 + (- 1/2) \cdot \beta_5
\end{align*}\]</span></p>
<p>Again, the difference is a sum of weighted group deflections. The coefficients on the group deflections have the properties that they sum to zero, with the positive coefficients summing to +1 and the negative coefficients summing to −1. Such a combination is called a contrast. The differences can also be expressed in terms of effect size, by dividing the difference by <span class="math inline">\(\sigma_y\)</span> at each step in the chain. (pp. 565–566)</p>
</blockquote>
<p>To warm up, here’s how to compute the first contrast shown in the lower portion of Kruschke’s Figure 19.3–the contrast between the two pregnant conditions and the none-control condition.</p>
<div class="sourceCode" id="cb1640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1640-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">c =</span> (<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1640-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1640-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> c, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1640-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1640-6" data-line-number="6">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1640-7" data-line-number="7">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1640-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1640-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Pregnant1.Pregnant8 vs None0&quot;</span>,</a>
<a class="sourceLine" id="cb1640-10" data-line-number="10">       <span class="dt">x =</span> <span class="st">&quot;Difference&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /></p>
<p>In case you were curious, here are the HMC-based posterior mode and 95% HDIs.</p>
<div class="sourceCode" id="cb1641"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1641-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1641-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">difference =</span> (<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1641-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1641-4" data-line-number="4"><span class="st">  </span><span class="kw">mode_hdi</span>(difference)</a></code></pre></div>
<pre><code>##   difference    .lower   .upper .width .point .interval
## 1    1.67085 -6.825623 9.071875   0.95   mode       hdi</code></pre>
<p>Little difference, there. Now let’s quantify the same contrast as an effect size.</p>
<div class="sourceCode" id="cb1643"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1643-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1643-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">es =</span> ((<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1643-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1643-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> es, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1643-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1643-6" data-line-number="6">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1643-7" data-line-number="7">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1643-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1643-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;Pregnant1.Pregnant8 vs None0&quot;</span>,</a>
<a class="sourceLine" id="cb1643-10" data-line-number="10">       <span class="dt">x =</span> <span class="st">&quot;Effect Size&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-30-1.png" style="display: block; margin: auto;" /></p>
<p>Tiny.</p>
<p>Okay, now let’s do the rest in bulk. First we’ll do the difference scores.</p>
<div class="sourceCode" id="cb1644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1644-1" data-line-number="1">differences &lt;-</a>
<a class="sourceLine" id="cb1644-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1644-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">Pregnant1.Pregnant8.None0 vs Virgin1</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1644-4" data-line-number="4">            </a>
<a class="sourceLine" id="cb1644-5" data-line-number="5">            <span class="st">`</span><span class="dt">Virgin1 vs Virgin8</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1644-6" data-line-number="6">            </a>
<a class="sourceLine" id="cb1644-7" data-line-number="7">            <span class="st">`</span><span class="dt">Pregnant1.Pregnant8.None0 vs Virgin1.Virgin8</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1644-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1644-9" data-line-number="9">differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1644-10" data-line-number="10"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1644-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1644-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1644-13" data-line-number="13"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1644-14" data-line-number="14">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1644-15" data-line-number="15">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1644-16" data-line-number="16">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1644-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1644-18" data-line-number="18"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1644-19" data-line-number="19"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-31-1.png" style="display: block; margin: auto;" /></p>
<p>Because we save our data wrangling labor from above as <code>differences</code>, it won’t take much more effort to compute and plot the corresponding effect sizes as displayed in the bottom row of Figure 19.3.</p>
<div class="sourceCode" id="cb1645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1645-1" data-line-number="1">differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1645-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span> <span class="op">~</span><span class="st"> </span>. <span class="op">/</span><span class="st"> </span>post<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1645-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1645-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1645-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1645-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1645-7" data-line-number="7">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1645-8" data-line-number="8">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1645-9" data-line-number="9">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1645-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1645-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Effect Size&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1645-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-32-1.png" style="display: block; margin: auto;" /></p>
<blockquote>
<p>In traditional ANOVA, analysts often perform a so-called omnibus test that asks whether it is plausible that all the groups are simultaneously exactly equal. I find that the omnibus test is rarely meaningful, however…. In the hierarchical Bayesian estimation used here, there is no direct equivalent to an omnibus test in ANOVA, and the emphasis is on examining all the meaningful contrasts. (p. 567)</p>
</blockquote>
<p>Speaking of all meaningful contrasts, if you’d like to make all pairwise comparisons in a hierarchical model of this form, <a href="https://mjskay.github.io/tidybayes/articles/tidy-brms.html"><strong>tidybayes</strong> offers a convenient way to do so</a>. Here we’ll demonstrate with <code>geom_halfeyeh()</code>.</p>
<div class="sourceCode" id="cb1646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1646-1" data-line-number="1">fit19<span class="fl">.1</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1646-2" data-line-number="2"><span class="st">  </span><span class="co"># these two lines are where the magic is at</span></a>
<a class="sourceLine" id="cb1646-3" data-line-number="3"><span class="st">  </span><span class="kw">spread_draws</span>(r_CompanionNumber[CompanionNumber,]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1646-4" data-line-number="4"><span class="st">  </span><span class="kw">compare_levels</span>(r_CompanionNumber, <span class="dt">by =</span> CompanionNumber) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1646-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1646-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> r_CompanionNumber, <span class="dt">y =</span> CompanionNumber)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1646-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color  =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1646-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1646-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Contrast&quot;</span>,</a>
<a class="sourceLine" id="cb1646-10" data-line-number="10">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1646-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1646-12" data-line-number="12">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-33-1.png" style="display: block; margin: auto;" /></p>
<p>But back to that omnibus test notion. If you really wanted to, I suppose one rough analogue would be to use information criteria to compare the hierarchical model to one that includes a single intercept with no group-level deflections. Here’s what the simpler model would look like.</p>
<div class="sourceCode" id="cb1647"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1647-1" data-line-number="1">fit19<span class="fl">.2</span> &lt;-</a>
<a class="sourceLine" id="cb1647-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1647-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1647-4" data-line-number="4">      Longevity <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1647-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1647-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1647-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1647-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1647-9" data-line-number="9">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1647-10" data-line-number="10">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.02&quot;</span>)</a></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1648-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 
##    Data: my_data (Number of observations: 125) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    57.42      1.59    54.32    60.56 1.00     9746     7638
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    17.69      1.16    15.56    20.12 1.00     7742     7149
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here are their LOO values and their difference score.</p>
<div class="sourceCode" id="cb1650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1650-1" data-line-number="1">fit19<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit19<span class="fl">.1</span>, <span class="dt">criterion =</span> <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1650-2" data-line-number="2">fit19<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">add_criterion</span>(fit19<span class="fl">.2</span>, <span class="dt">criterion =</span> <span class="st">&quot;loo&quot;</span>)</a>
<a class="sourceLine" id="cb1650-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1650-4" data-line-number="4"><span class="kw">loo_compare</span>(fit19<span class="fl">.1</span>, fit19<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1650-5" data-line-number="5"><span class="st">  </span><span class="kw">print</span>(<span class="dt">simplify =</span> F)</a></code></pre></div>
<pre><code>##         elpd_diff se_diff elpd_loo se_elpd_loo p_loo  se_p_loo looic  se_looic
## fit19.1    0.0       0.0  -517.7      6.9         5.5    0.6   1035.4   13.8  
## fit19.2  -19.4       5.3  -537.1      7.1         1.8    0.3   1074.1   14.1</code></pre>
<p>The hierarchical model has a better LOO. Here are the stacking-based model weights.</p>
<div class="sourceCode" id="cb1652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1652-1" data-line-number="1">(mw &lt;-<span class="st"> </span><span class="kw">model_weights</span>(fit19<span class="fl">.1</span>, fit19<span class="fl">.2</span>))</a></code></pre></div>
<pre><code>##      fit19.1      fit19.2 
## 9.999994e-01 6.438484e-07</code></pre>
<p>If you don’t like scientific notation, just <code>round()</code>.</p>
<div class="sourceCode" id="cb1654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1654-1" data-line-number="1">mw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1654-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## fit19.1 fit19.2 
##       1       0</code></pre>
<p>Yep, in complimenting the LOO difference, virtually all the stacking weight went to the hierarchical model. You might think of this another way. The conceptual question we’re asking is <em>Does it make sense to say that the</em> <span class="math inline">\(\sigma_\beta\)</span> <em>parameter is zero? Is zero a credible value?</em> We’ll, I suppose we could just look at the posterior to assess for that.</p>
<div class="sourceCode" id="cb1656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1656-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1656-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sd_CompanionNumber__Intercept, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1656-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1656-4" data-line-number="4">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1656-5" data-line-number="5">                     <span class="dt">breaks =</span> <span class="dv">100</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1656-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1656-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">50</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1656-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">expression</span>(<span class="st">&quot;Behold the fit19.1 posterior for &quot;</span><span class="op">*</span>sigma[beta]<span class="op">*</span><span class="st">&quot;.&quot;</span>),</a>
<a class="sourceLine" id="cb1656-9" data-line-number="9">       <span class="dt">subtitle =</span> <span class="st">&quot;This parameter&#39;s many things, but zero isn&#39;t one of them.&quot;</span>,</a>
<a class="sourceLine" id="cb1656-10" data-line-number="10">       <span class="dt">x =</span> <span class="ot">NULL</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-38-1.png" style="display: block; margin: auto;" /></p>
<p>Yeah, zero and other values close to zero don’t look credible for that parameter. 95% of the mass is between 5 and 30, with the bulk hovering around 10. We don’t need an <span class="math inline">\(F\)</span>-test or even a LOO model comparison to see the writing on wall.</p>
</div>
<div id="multiple-comparisons-and-shrinkage." class="section level3">
<h3><span class="header-section-number">19.3.4</span> Multiple comparisons and shrinkage.</h3>
<blockquote>
<p>The previous section suggested that an analyst should investigate all contrasts of interest. This recommendation can be thought to conflict with traditional advice in the context on null hypothesis significance testing, which instead recommends that a minimal number of comparisons should be conducted in order to maximize the power of each test while keeping the overall false alarm rate capped at 5% (or whatever maximum is desired)…. Instead, a Bayesian analysis can mitigate false alarms by incorporating prior knowledge into the model. In particular, hierarchical structure (which is an expression of prior knowledge) produces shrinkage of estimates, and shrinkage can help rein in estimates of spurious outlying data. For example, in the posterior distribution from the fruit fly data, the modal values of the posterior group means have a range of 23.2. The sample means of the groups have a range of 26.1. Thus, there is some shrinkage in the estimated means. The amount of shrinkage is dictated only by the data and by the prior structure, not by the intended tests. (p. 568)</p>
</blockquote>
<p>We may as well compute those ranges by hand. Here’s the range of the observed data.</p>
<div class="sourceCode" id="cb1657"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1657-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1657-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1657-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean  =</span> <span class="kw">mean</span>(Longevity)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1657-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">range =</span> <span class="kw">max</span>(mean) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(mean))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   range
##   &lt;dbl&gt;
## 1  26.1</code></pre>
<p>For our hierarchical model <code>fit19.1</code>, the posterior means are rank ordered in the same way as the empirical data.</p>
<div class="sourceCode" id="cb1659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1659-1" data-line-number="1"><span class="kw">coef</span>(fit19<span class="fl">.1</span>)<span class="op">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1659-2" data-line-number="2"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1659-3" data-line-number="3"><span class="st">  </span><span class="kw">rownames_to_column</span>(<span class="dt">var =</span> <span class="st">&quot;companion_number&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1659-4" data-line-number="4"><span class="st">  </span><span class="kw">arrange</span>(Estimate) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1659-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>##   companion_number Estimate Est.Error Q2.5 Q97.5
## 1          Virgin8     39.9       3.1 33.9  46.0
## 2          Virgin1     56.8       2.9 51.1  62.5
## 3        Pregnant8     63.0       2.9 57.2  68.7
## 4            None0     63.2       2.9 57.4  68.8
## 5        Pregnant1     64.4       2.9 58.7  70.2</code></pre>
<p>If we compute the range by a difference of the point estimates of the highest and lowest posterior means, we can get a quick number.</p>
<div class="sourceCode" id="cb1661"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1661-1" data-line-number="1"><span class="kw">coef</span>(fit19<span class="fl">.1</span>)<span class="op">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1661-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1661-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">range =</span> <span class="kw">max</span>(Estimate) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Estimate))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   range
##   &lt;dbl&gt;
## 1  24.5</code></pre>
<p>Note that wasn’t fully Bayesian of us. Those means and their difference carry uncertainty with them and that uncertainty can be fully expressed if we use all the posterior draws (i.e., use <code>summary = F</code> and wrangle).</p>
<div class="sourceCode" id="cb1663"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1663-1" data-line-number="1"><span class="kw">coef</span>(fit19<span class="fl">.1</span>, <span class="dt">summary =</span> F)<span class="op">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1663-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1663-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">range =</span> Pregnant1 <span class="op">-</span><span class="st"> </span>Virgin8) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1663-4" data-line-number="4"><span class="st">  </span><span class="kw">mode_hdi</span>(range)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   range .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  24.7   15.7   32.9   0.95 mode   hdi</code></pre>
<p>Happily, the central tendency of the range is near equivalent with both methods, but now we have 95% intervals, too. Do note how wide they are. This is why we work with the full set of posterior draws.</p>
</div>
<div id="the-two-group-case." class="section level3">
<h3><span class="header-section-number">19.3.5</span> The two-group case.</h3>
<blockquote>
<p>A special case of our current scenario is when there are only two groups. The model of the present section could, in principle, be applied to the two-group case, but the hierarchical structure would do little good because there is virtually no shrinkage when there are so few groups (and the top-level prior on <span class="math inline">\(\sigma_\beta\)</span> is broad as assumed here). (p. 568)</p>
</blockquote>
<p>For kicks and giggles, let’s practice. Since <code>Pregnant1</code> and <code>Virgin8</code> had the highest and lowest empirical means—making them the groups best suited to define our range, we’ll use them to fit the 2-group hierarchical model. To fit it with haste, just use <code>update()</code>.</p>
<div class="sourceCode" id="cb1665"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1665-1" data-line-number="1">fit19<span class="fl">.3</span> &lt;-</a>
<a class="sourceLine" id="cb1665-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit19<span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb1665-3" data-line-number="3">         <span class="dt">newdata =</span> my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1665-4" data-line-number="4"><span class="st">           </span><span class="kw">filter</span>(CompanionNumber <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pregnant1&quot;</span>, <span class="st">&quot;Virgin8&quot;</span>)),</a>
<a class="sourceLine" id="cb1665-5" data-line-number="5">         <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.999</span>,</a>
<a class="sourceLine" id="cb1665-6" data-line-number="6">                        <span class="dt">max_treedepth =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb1665-7" data-line-number="7">         <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1665-8" data-line-number="8">         <span class="dt">file =</span> <span class="st">&quot;fits/fit19.03&quot;</span>)</a></code></pre></div>
<p>Even with just two groups, there were no gross issues with fitting the model.</p>
<div class="sourceCode" id="cb1666"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1666-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + (1 | CompanionNumber) 
##    Data: my_data %&gt;% filter(CompanionNumber %in% c(&quot;Pregnan (Number of observations: 50) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Group-Level Effects: 
## ~CompanionNumber (Number of levels: 2) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    33.07     22.62     8.86    93.59 1.00     3269     4606
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    52.23     24.82     1.13   105.83 1.00     3447     3274
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    14.24      1.49    11.66    17.51 1.00     5500     4602
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>If you compare the posteriors for <span class="math inline">\(\sigma_\beta\)</span> across the two models, you’ll see how the one for <code>fit19.3</code> is substantially larger.</p>
<div class="sourceCode" id="cb1668"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1668-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit19<span class="fl">.1</span>)[<span class="st">&quot;sd_CompanionNumber__Intercept&quot;</span>, ]</a></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 15.031865  8.041133  6.238274 36.416484</code></pre>
<div class="sourceCode" id="cb1670"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1670-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit19<span class="fl">.3</span>)[<span class="st">&quot;sd_CompanionNumber__Intercept&quot;</span>, ]</a></code></pre></div>
<pre><code>##  Estimate Est.Error      Q2.5     Q97.5 
## 33.065688 22.615175  8.861131 93.587013</code></pre>
<p>Here that is in a coefficient plot using <code>tidybayes::stat_intervalh()</code>.</p>
<div class="sourceCode" id="cb1672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1672-1" data-line-number="1"><span class="kw">bind_rows</span>(<span class="kw">posterior_samples</span>(fit19<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sd_CompanionNumber__Intercept),</a>
<a class="sourceLine" id="cb1672-2" data-line-number="2">          <span class="kw">posterior_samples</span>(fit19<span class="fl">.3</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sd_CompanionNumber__Intercept)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1672-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fit =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;fit19.1&quot;</span>, <span class="st">&quot;fit19.3&quot;</span>), <span class="dt">each =</span> <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1672-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1672-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sd_CompanionNumber__Intercept, <span class="dt">y =</span> fit)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1672-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_intervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.8</span>, <span class="fl">.95</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1672-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_color_grey</span>(<span class="st">&quot;HDI&quot;</span>, <span class="dt">start =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">end =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1672-8" data-line-number="8">                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;95%&quot;</span>, <span class="st">&quot;80%&quot;</span>, <span class="st">&quot;50%&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1672-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(sigma[beta]),</a>
<a class="sourceLine" id="cb1672-10" data-line-number="10">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1672-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">80</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1672-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.key.size =</span> <span class="kw">unit</span>(<span class="fl">0.45</span>, <span class="st">&quot;cm&quot;</span>))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-45-1.png" style="display: block; margin: auto;" /></p>
<p>This all implies less shrinkage and a larger range.</p>
<div class="sourceCode" id="cb1673"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1673-1" data-line-number="1"><span class="kw">coef</span>(fit19<span class="fl">.3</span>, <span class="dt">summary =</span> F)<span class="op">$</span>CompanionNumber[, , <span class="st">&quot;Intercept&quot;</span>] <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1673-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1673-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">range =</span> Pregnant1 <span class="op">-</span><span class="st"> </span>Virgin8) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1673-4" data-line-number="4"><span class="st">  </span><span class="kw">mode_hdi</span>(range)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   range .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  25.9   17.6   33.4   0.95 mode   hdi</code></pre>
<p>And indeed, the range between the two groups is larger. Now the posterior mode for their difference has almost converged to that of the raw data. Kruschke then went on to recommend using a single-level model in such situations, instead.</p>
<blockquote>
<p>That is why the two-group model in Section 16.3 did not use hierarchical structure, as illustrated in Figure 16.11 (p. 468). That model also used a <span class="math inline">\(t\)</span> distribution to accommodate outliers in the data, and that model allowed for heterogeneous variances across groups. Thus, for two groups, it is more appropriate to use the model of Section 16.3. The hierarchical multi-group model is generalized to accommodate outliers and heterogeneous variances in Section 19.5. (p. 568)</p>
</blockquote>
<p>As a refresher, here’s what the <strong>brms</strong> code for that Chapter 16 model looked like.</p>
<div class="sourceCode" id="cb1675"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1675-1" data-line-number="1">fit16<span class="fl">.3</span> &lt;-</a>
<a class="sourceLine" id="cb1675-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1675-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1675-4" data-line-number="4">      <span class="kw">bf</span>(Score <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Group, </a>
<a class="sourceLine" id="cb1675-5" data-line-number="5">         sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Group),</a>
<a class="sourceLine" id="cb1675-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1675-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="kw">log</span>(sd_y)), <span class="dt">class =</span> b, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1675-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1675-9" data-line-number="9">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1675-10" data-line-number="10">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1675-11" data-line-number="11">      <span class="dt">seed =</span> <span class="dv">16</span>,</a>
<a class="sourceLine" id="cb1675-12" data-line-number="12">      <span class="dt">file =</span> <span class="st">&quot;fits/fit16.03&quot;</span>)</a></code></pre></div>
<p>Let’s adjust it for our data. Since we have a reduced data set, we’ll need to re-compute our <code>stanvars</code> values, which were based on the raw data.</p>
<div class="sourceCode" id="cb1676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1676-1" data-line-number="1"><span class="co"># it&#39;s easier to just make a reduced data set</span></a>
<a class="sourceLine" id="cb1676-2" data-line-number="2">my_small_data &lt;-</a>
<a class="sourceLine" id="cb1676-3" data-line-number="3"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1676-4" data-line-number="4"><span class="st">  </span><span class="kw">filter</span>(CompanionNumber <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Pregnant1&quot;</span>, <span class="st">&quot;Virgin8&quot;</span>))</a>
<a class="sourceLine" id="cb1676-5" data-line-number="5">  </a>
<a class="sourceLine" id="cb1676-6" data-line-number="6">(mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_small_data<span class="op">$</span>Longevity))</a></code></pre></div>
<pre><code>## [1] 51.76</code></pre>
<div class="sourceCode" id="cb1678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1678-1" data-line-number="1">(sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_small_data<span class="op">$</span>Longevity))</a></code></pre></div>
<pre><code>## [1] 19.11145</code></pre>
<div class="sourceCode" id="cb1680"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1680-1" data-line-number="1">omega &lt;-<span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1680-2" data-line-number="2">sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y</a>
<a class="sourceLine" id="cb1680-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1680-4" data-line-number="4">(s_r &lt;-<span class="st"> </span><span class="kw">gamma_a_b_from_omega_sigma</span>(<span class="dt">mode =</span> omega, <span class="dt">sd =</span> sigma))</a></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.02963623</code></pre>
<p>Here we update <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1682"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1682-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1682-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y,    <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1682-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,      <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1682-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>shape, <span class="dt">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1682-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>rate,  <span class="dt">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1682-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>,      <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</a></code></pre></div>
<p>Note that our priors, here, are something of a blend of those from Chapter 16 and those from our hierarchical model, <code>fit19.1</code>.</p>
<div class="sourceCode" id="cb1683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1683-1" data-line-number="1">fit19<span class="fl">.4</span> &lt;-</a>
<a class="sourceLine" id="cb1683-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_small_data,</a>
<a class="sourceLine" id="cb1683-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1683-4" data-line-number="4">      <span class="kw">bf</span>(Longevity <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>CompanionNumber, </a>
<a class="sourceLine" id="cb1683-5" data-line-number="5">         sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>CompanionNumber),</a>
<a class="sourceLine" id="cb1683-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">10</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1683-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="kw">log</span>(sd_y)), <span class="dt">class =</span> b, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1683-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1683-9" data-line-number="9">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1683-10" data-line-number="10">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1683-11" data-line-number="11">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1683-12" data-line-number="12">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.04&quot;</span>)</a></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1684"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1684-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.4</span>)</a></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: Longevity ~ 0 + CompanionNumber 
##          sigma ~ 0 + CompanionNumber
##    Data: my_small_data (Number of observations: 50) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Population-Level Effects: 
##                                Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## CompanionNumberPregnant1          64.65      3.26    58.29    71.19 1.00    12438     8155
## CompanionNumberVirgin8            38.80      2.53    33.88    43.78 1.00    13341     8746
## sigma_CompanionNumberPregnant1     2.73      0.15     2.45     3.05 1.00    13345     9114
## sigma_CompanionNumberVirgin8       2.48      0.16     2.18     2.80 1.00    13031     8729
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## nu    39.61     31.02     6.01   120.48 1.00    12182     8961
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Man, look at those <code>Bulk_ESS</code> values! As it turns out, they can be <a href="https://andrewgelman.com/2018/01/18/measuring-speed-stan-incorrectly-faster-thought-cases-due-antithetical-sampling/">greater than the number of post-warmup samples</a>. And here’s the range in posterior means.</p>
<div class="sourceCode" id="cb1686"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1686-1" data-line-number="1"><span class="kw">fixef</span>(fit19<span class="fl">.4</span>, <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1686-2" data-line-number="2"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1686-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">range =</span> CompanionNumberPregnant1 <span class="op">-</span><span class="st"> </span>CompanionNumberVirgin8) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1686-4" data-line-number="4"><span class="st">  </span><span class="kw">mode_hdi</span>(range)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 6
##   range .lower .upper .width .point .interval
##   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1  25.7   18.1   34.4   0.95 mode   hdi</code></pre>
<p>The results are pretty much the same as that of the two-group hierarchical model, maybe a touch larger. Yep, Kruschke was right. Hierarchical models with two groups and permissive priors on <span class="math inline">\(\sigma_\beta\)</span> don’t shrink the estimates to the grand mean all that much.</p>
</div>
</div>
<div id="including-a-metric-predictor" class="section level2">
<h2><span class="header-section-number">19.4</span> Including a metric predictor</h2>
<p>“In Figure 19.3, the data within each group have a large standard deviation. For example, longevities in the Virgin8 group range from 20 to 60 days” (p. 568). Turns out Kruschke’s slightly wrong on this. Probably just a typo.</p>
<div class="sourceCode" id="cb1688"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1688-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1688-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1688-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">min   =</span> <span class="kw">min</span>(Longevity),</a>
<a class="sourceLine" id="cb1688-4" data-line-number="4">            <span class="dt">max   =</span> <span class="kw">max</span>(Longevity),</a>
<a class="sourceLine" id="cb1688-5" data-line-number="5">            <span class="dt">range =</span> <span class="kw">max</span>(Longevity) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(Longevity))</a></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   CompanionNumber   min   max range
##   &lt;chr&gt;           &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 None0              37    96    59
## 2 Pregnant1          42    97    55
## 3 Pregnant8          35    86    51
## 4 Virgin1            21    81    60
## 5 Virgin8            16    60    44</code></pre>
<p>But you get the point. For each group, there was quite a range. We might add predictors to the model to help account for those ranges.</p>
<blockquote>
<p>The additional metric predictor is sometimes called a covariate. In the experimental setting, the focus of interest is usually on the nominal predictor (i.e., the experimental treatments), and the covariate is typically thought of as an ancillary predictor to help isolate the effect of the nominal predictor. But mathematically the nominal and metric predictors have equal status in the model. Let’s denote the value of the metric covariate for subject <span class="math inline">\(i\)</span> as <span class="math inline">\(x_\text{cov}(i)\)</span>. Then the expected value of the predicted variable for subject <span class="math inline">\(i\)</span> is</p>
<p><span class="math display">\[\mu (i) = \beta_0 + \sum_j \beta_{[j]} x_{[j]} (i) + \beta_\text{cov}  x_\text{cov}(i)\]</span></p>
<p>with the usual sum-to-zero constraint on the deflections of the nominal predictor stated in Equation 19.2. In words, Equation 19.5 says that the predicted value for subject <span class="math inline">\(i\)</span> is a baseline plus a deflection due to the group of <span class="math inline">\(i\)</span> plus a shift due to the value of <span class="math inline">\(i\)</span> on the covariate. (p. 569)</p>
</blockquote>
<p>And the <span class="math inline">\(j\)</span> subscript, recall, denotes group membership. In this context, it often</p>
<blockquote>
<p>makes sense to set the intercept as the mean of predicted values if the covariate is re-centered at its mean value, which is denoted <span class="math inline">\(\overline x_\text{cov}\)</span>. Therefore Equation 19.5 is algebraically reformulated to make the baseline respect those constraints…. The first equation below is simply Equation 19.5 with <span class="math inline">\(x_\text{cov}\)</span> recentered on its mean, <span class="math inline">\(\overline x_\text{cov}\)</span>. The second line below merely algebraically rearranges the terms so that the nominal deflections sum to zero and the constants are combined into the overall baseline:</p>
<p><span class="math display">\[\begin{align*}
\mu &amp; = \alpha_0 + \sum_j \alpha_{[j]} x_{[j]} + \alpha_\text{cov} (x_\text{cov} - \overline{x}_\text{cov}) \\
    &amp; = \underbrace{\alpha_0 + \overline{\alpha} - \alpha_\text{cov} \overline{x}_\text{cov}}_{\beta_0} + \sum_j \underbrace{(\alpha_{[j]} - \overline{\alpha})}_{\beta_[j]} x_{[j]} + \underbrace{\alpha_\text{cov}}_{\beta_{\text{cov}}} x_\text{cov} \\
&amp; \text{where } \overline{\alpha} = \frac{1}{J} \sum^J_{j = 1} \alpha_{[j]}
\end{align*}\]</span>
(pp. 569–570)</p>
</blockquote>
<div id="example-sex-death-and-size." class="section level3">
<h3><span class="header-section-number">19.4.1</span> Example: Sex, death, and size.</h3>
<p>Kruschke recalled <code>fit19.1</code>’s estimate for <span class="math inline">\(\sigma_y\)</span> had a posterior mode around 14.8. Let’s confirm with a plot.</p>
<div class="sourceCode" id="cb1690"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1690-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit19<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1690-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sigma, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1690-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1690-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1690-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(sigma[y])) <span class="op">+</span></a>
<a class="sourceLine" id="cb1690-6" data-line-number="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-53-1.png" style="display: block; margin: auto;" /></p>
<p>Yep, that looks about right. That large of a difference in days would indeed make it difficult to detect between-group differences if those differences were typically on the scale of just a few days. Since <code>Thorax</code> is moderately correlated with <code>Longevity</code>, including <code>Thorax</code> in the statistical model should help shrink that <span class="math inline">\(\sigma_y\)</span> estimate, making it easier to compare group means. Following the sensibilities from the equations just above, here we’ll mean-center our covariate, first.</p>
<div class="sourceCode" id="cb1691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1691-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1691-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1691-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">thorax_c =</span> Thorax <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Thorax))</a>
<a class="sourceLine" id="cb1691-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1691-5" data-line-number="5"><span class="kw">head</span>(my_data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   Longevity CompanionNumber Thorax thorax_c
##       &lt;dbl&gt; &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;
## 1        35 Pregnant8         0.64  -0.181 
## 2        37 Pregnant8         0.68  -0.141 
## 3        49 Pregnant8         0.68  -0.141 
## 4        46 Pregnant8         0.72  -0.101 
## 5        63 Pregnant8         0.72  -0.101 
## 6        39 Pregnant8         0.76  -0.0610</code></pre>
<p>Our model code follows the structure of that in Kruschke’s <code>Jags-Ymet-Xnom1met1-MnormalHom-Example.R</code> and <code>Jags-Ymet-Xnom1met1-MnormalHom.R</code> files. As a preparatory step, we redefine the values necessary for <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1693"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1693-1" data-line-number="1">(mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Longevity))</a></code></pre></div>
<pre><code>## [1] 57.44</code></pre>
<div class="sourceCode" id="cb1695"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1695-1" data-line-number="1">(sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Longevity))</a></code></pre></div>
<pre><code>## [1] 17.56389</code></pre>
<div class="sourceCode" id="cb1697"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1697-1" data-line-number="1">(sd_thorax_c &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>thorax_c))</a></code></pre></div>
<pre><code>## [1] 0.07745367</code></pre>
<div class="sourceCode" id="cb1699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1699-1" data-line-number="1">omega &lt;-<span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1699-2" data-line-number="2">sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y</a>
<a class="sourceLine" id="cb1699-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1699-4" data-line-number="4">(s_r &lt;-<span class="st"> </span><span class="kw">gamma_a_b_from_omega_sigma</span>(<span class="dt">mode =</span> omega, <span class="dt">sd =</span> sigma))</a></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.03224747</code></pre>
<div class="sourceCode" id="cb1701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1701-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1701-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y,      <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1701-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,        <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1701-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(sd_thorax_c, <span class="dt">name =</span> <span class="st">&quot;sd_thorax_c&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1701-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>shape,   <span class="dt">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1701-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>rate,    <span class="dt">name =</span> <span class="st">&quot;beta&quot;</span>)</a></code></pre></div>
<p>Now we’re ready to fit the <code>brm()</code> model, our hierarchical alternative to ANCOVA.</p>
<div class="sourceCode" id="cb1702"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1702-1" data-line-number="1">fit19<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1702-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1702-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1702-4" data-line-number="4">      Longevity <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>thorax_c <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CompanionNumber),</a>
<a class="sourceLine" id="cb1702-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>),          <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1702-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span>sd_thorax_c), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1702-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">gamma</span>(alpha, beta),                <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1702-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y),                   <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1702-9" data-line-number="9">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1702-10" data-line-number="10">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1702-11" data-line-number="11">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>),</a>
<a class="sourceLine" id="cb1702-12" data-line-number="12">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1702-13" data-line-number="13">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.05&quot;</span>)</a></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1703-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + thorax_c + (1 | CompanionNumber) 
##    Data: my_data (Number of observations: 125) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Group-Level Effects: 
## ~CompanionNumber (Number of levels: 5) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)    14.07      7.53     5.92    33.51 1.00     2575     4157
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    57.35      6.82    44.01    70.95 1.00     2429     3081
## thorax_c    136.07     12.48   111.30   160.49 1.00     7984     7348
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    10.61      0.69     9.34    12.05 1.00     7505     7602
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s see if that <span class="math inline">\(\sigma_y\)</span> posterior shrank.</p>
<div class="sourceCode" id="cb1705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1705-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit19<span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1705-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sigma, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1705-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1705-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1705-5" data-line-number="5"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(sigma[y]))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-57-1.png" style="display: block; margin: auto;" /></p>
<p>Yep, sure did! Now our between-group comparisons should be more precise. Heck, if we wanted to we could even make a difference plot.</p>
<div class="sourceCode" id="cb1706"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1706-1" data-line-number="1"><span class="kw">bind_cols</span>(<span class="kw">posterior_samples</span>(fit19<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sigma),</a>
<a class="sourceLine" id="cb1706-2" data-line-number="2">          <span class="kw">posterior_samples</span>(fit19<span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1706-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">dif =</span> sigma <span class="op">-</span><span class="st"> </span>sigma1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1706-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb1706-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> dif, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1706-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1706-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1706-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;This is a difference distribution&quot;</span>,</a>
<a class="sourceLine" id="cb1706-9" data-line-number="9">       <span class="dt">x =</span> <span class="kw">expression</span>(sigma[y][<span class="st">&quot; | fit19.1&quot;</span>]<span class="op">-</span>sigma[y][<span class="st">&quot; | fit19.5&quot;</span>]))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-58-1.png" style="display: block; margin: auto;" /></p>
<p>If you want a quick and dirty plot of the relation between <code>thorax_c</code> and <code>Longevity</code>, you might employ <code>brms::conditional_effects()</code>.</p>
<div class="sourceCode" id="cb1707"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1707-1" data-line-number="1"><span class="kw">conditional_effects</span>(fit19<span class="fl">.5</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-59-1.png" style="display: block; margin: auto;" /></p>
<p>But to make plots like the ones at the top of Figure 19.5, we’ll have to work a little harder. First, we need some intermediary values marking off the three values along the <code>Thorax</code>-axis Kruschke singled out in his top panel plots. As far as I can tell, they were the <code>min()</code>, the <code>max()</code>, and their <code>mean()</code>.</p>
<div class="sourceCode" id="cb1708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1708-1" data-line-number="1">(r &lt;-<span class="st"> </span><span class="kw">range</span>(my_data<span class="op">$</span>Thorax))</a></code></pre></div>
<pre><code>## [1] 0.64 0.94</code></pre>
<div class="sourceCode" id="cb1710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1710-1" data-line-number="1"><span class="kw">mean</span>(r)</a></code></pre></div>
<pre><code>## [1] 0.79</code></pre>
<p>Next, we’ll make the data necessary for our side-tipped Gaussians. For kicks and giggles, we’ll choose 80 draws instead of 20. But do note how we used our <code>r</code> values, from above, to specify both <code>Thorax</code> and <code>thorax_c</code> values in addition to the <code>CompanionNumber</code> categories for the <code>newdata</code> argument. Otherwise, this workflow is very much the same as in previous plots.</p>
<div class="sourceCode" id="cb1712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1712-1" data-line-number="1">n_draws &lt;-<span class="st"> </span><span class="dv">80</span></a>
<a class="sourceLine" id="cb1712-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1712-3" data-line-number="3">densities &lt;-</a>
<a class="sourceLine" id="cb1712-4" data-line-number="4"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-5" data-line-number="5"><span class="st">  </span><span class="kw">distinct</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-6" data-line-number="6"><span class="st">  </span><span class="kw">expand</span>(CompanionNumber, <span class="dt">Thorax =</span> <span class="kw">c</span>(r[<span class="dv">1</span>], <span class="kw">mean</span>(r), r[<span class="dv">2</span>])) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">thorax_c  =</span> Thorax <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Thorax)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-8" data-line-number="8"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit19<span class="fl">.5</span>, <span class="dt">n =</span> n_draws, <span class="dt">seed =</span> <span class="dv">19</span>, <span class="dt">dpar =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ll =</span> <span class="kw">qnorm</span>(.<span class="dv">025</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma),</a>
<a class="sourceLine" id="cb1712-10" data-line-number="10">         <span class="dt">ul =</span> <span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Longevity =</span> <span class="kw">map2</span>(ll, ul, seq, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-12" data-line-number="12"><span class="st">  </span><span class="kw">unnest</span>(Longevity) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1712-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(Longevity, mu, sigma))</a>
<a class="sourceLine" id="cb1712-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1712-15" data-line-number="15"><span class="kw">glimpse</span>(densities)</a></code></pre></div>
<pre><code>## Observations: 120,000
## Variables: 14
## Groups: CompanionNumber, Thorax, thorax_c, .row [15]
## $ CompanionNumber &lt;chr&gt; &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;…
## $ Thorax          &lt;dbl&gt; 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0…
## $ thorax_c        &lt;dbl&gt; -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw           &lt;int&gt; 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 3…
## $ .value          &lt;dbl&gt; 38.56409, 38.56409, 38.56409, 38.56409, 38.56409, 38.56409, 38.56409, 38.…
## $ mu              &lt;dbl&gt; 38.56409, 38.56409, 38.56409, 38.56409, 38.56409, 38.56409, 38.56409, 38.…
## $ sigma           &lt;dbl&gt; 12.08948, 12.08948, 12.08948, 12.08948, 12.08948, 12.08948, 12.08948, 12.…
## $ ll              &lt;dbl&gt; 14.86915, 14.86915, 14.86915, 14.86915, 14.86915, 14.86915, 14.86915, 14.…
## $ ul              &lt;dbl&gt; 62.25903, 62.25903, 62.25903, 62.25903, 62.25903, 62.25903, 62.25903, 62.…
## $ Longevity       &lt;dbl&gt; 14.86915, 15.34783, 15.82652, 16.30520, 16.78389, 17.26258, 17.74126, 18.…
## $ density         &lt;dbl&gt; 0.004834375, 0.005220395, 0.005628408, 0.006058804, 0.006511894, 0.006987…</code></pre>
<p>Here, we’ll use a simplified workflow to extract the <code>fitted()</code> values in order to make the regression lines. Since these are straight lines, all we need are two values for each draw, one at the extremes of the <code>Thorax</code> axis.</p>
<div class="sourceCode" id="cb1714"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1714-1" data-line-number="1">f &lt;-</a>
<a class="sourceLine" id="cb1714-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1714-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1714-4" data-line-number="4"><span class="st">  </span><span class="kw">expand</span>(CompanionNumber, <span class="dt">Thorax =</span> <span class="kw">c</span>(r[<span class="dv">1</span>], <span class="kw">mean</span>(r), r[<span class="dv">2</span>])) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1714-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">thorax_c =</span> Thorax <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Thorax)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1714-6" data-line-number="6"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit19<span class="fl">.5</span>, <span class="dt">n =</span> n_draws, <span class="dt">seed =</span> <span class="dv">19</span>, <span class="dt">value =</span> <span class="st">&quot;Longevity&quot;</span>)</a>
<a class="sourceLine" id="cb1714-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1714-8" data-line-number="8"><span class="kw">glimpse</span>(f)</a></code></pre></div>
<pre><code>## Observations: 1,200
## Variables: 8
## Groups: CompanionNumber, Thorax, thorax_c, .row [15]
## $ CompanionNumber &lt;chr&gt; &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;None0&quot;, &quot;…
## $ Thorax          &lt;dbl&gt; 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0.64, 0…
## $ thorax_c        &lt;dbl&gt; -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.18096, -0.…
## $ .row            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ .chain          &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .iteration      &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
## $ .draw           &lt;int&gt; 31, 208, 586, 800, 1099, 1115, 1353, 1800, 2120, 2133, 2195, 2220, 2492, …
## $ Longevity       &lt;dbl&gt; 38.56409, 30.73483, 41.54440, 39.10625, 36.16563, 31.61745, 39.23632, 36.…</code></pre>
<p>Now we’re ready to make our plots for the top row of Figure 19.3.</p>
<div class="sourceCode" id="cb1716"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1716-1" data-line-number="1">densities <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1716-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Longevity, <span class="dt">y =</span> Thorax)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1716-3" data-line-number="3"><span class="st">  </span><span class="co"># the Gaussians</span></a>
<a class="sourceLine" id="cb1716-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ridgeline</span>(<span class="kw">aes</span>(<span class="dt">height =</span> <span class="op">-</span>density, <span class="dt">group =</span> <span class="kw">interaction</span>(Thorax, .draw)),</a>
<a class="sourceLine" id="cb1716-5" data-line-number="5">                 <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">scale =</span> <span class="dv">5</span><span class="op">/</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1716-6" data-line-number="6">                 <span class="dt">color =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha.f =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>),</a>
<a class="sourceLine" id="cb1716-7" data-line-number="7">                 <span class="dt">min_height =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1716-8" data-line-number="8"><span class="st">  </span><span class="co"># the vertical lines below the Gaussians</span></a>
<a class="sourceLine" id="cb1716-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(Thorax, .draw)),</a>
<a class="sourceLine" id="cb1716-10" data-line-number="10">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1716-11" data-line-number="11"><span class="st">  </span><span class="co"># the regression lines</span></a>
<a class="sourceLine" id="cb1716-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> f,</a>
<a class="sourceLine" id="cb1716-13" data-line-number="13">            <span class="kw">aes</span>(<span class="dt">group =</span> .draw),</a>
<a class="sourceLine" id="cb1716-14" data-line-number="14">            <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1716-15" data-line-number="15"><span class="st">  </span><span class="co"># the data</span></a>
<a class="sourceLine" id="cb1716-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1716-17" data-line-number="17">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1716-18" data-line-number="18"><span class="st">  </span><span class="kw">coord_flip</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">110</span>,</a>
<a class="sourceLine" id="cb1716-19" data-line-number="19">             <span class="dt">ylim =</span> <span class="kw">c</span>(.<span class="dv">58</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1716-20" data-line-number="20"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>CompanionNumber, <span class="dt">ncol =</span> <span class="dv">5</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-63-1.png" style="display: block; margin: auto;" /></p>
<p>Now we have a covariate in the model, we have to decide on which of its values we want to base our group comparisons. Unless there’s a substantive reason for another value, the mean is a good standard choice. And since the covariate <code>thorax_c</code> is already mean centered, that means we can effectively leave it out of the equation. Here we make and save them in the simple difference metric.</p>
<div class="sourceCode" id="cb1717"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1717-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit19<span class="fl">.5</span>)</a>
<a class="sourceLine" id="cb1717-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1717-3" data-line-number="3">differences &lt;-</a>
<a class="sourceLine" id="cb1717-4" data-line-number="4"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1717-5" data-line-number="5"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">Pregnant1.Pregnant8 vs None0</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1717-6" data-line-number="6">            </a>
<a class="sourceLine" id="cb1717-7" data-line-number="7">            <span class="st">`</span><span class="dt">Pregnant1.Pregnant8.None0 vs Virgin1</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1717-8" data-line-number="8">            </a>
<a class="sourceLine" id="cb1717-9" data-line-number="9">            <span class="st">`</span><span class="dt">Virgin1 vs Virgin8</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1717-10" data-line-number="10">            </a>
<a class="sourceLine" id="cb1717-11" data-line-number="11">            <span class="st">`</span><span class="dt">Pregnant1.Pregnant8.None0 vs Virgin1.Virgin8</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Pregnant1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[None0,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">-</span><span class="st"> </span>(<span class="st">`</span><span class="dt">r_CompanionNumber[Virgin1,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">r_CompanionNumber[Virgin8,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1717-12" data-line-number="12"></a>
<a class="sourceLine" id="cb1717-13" data-line-number="13">p1 &lt;-</a>
<a class="sourceLine" id="cb1717-14" data-line-number="14"><span class="st">  </span>differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1717-15" data-line-number="15"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb1717-16" data-line-number="16"><span class="st">  </span></a>
<a class="sourceLine" id="cb1717-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1717-18" data-line-number="18"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1717-19" data-line-number="19">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1717-20" data-line-number="20">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1717-21" data-line-number="21">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1717-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1717-23" data-line-number="23"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1717-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="fl">6.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1717-25" data-line-number="25"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Now we’ll look at the differences in the effect size metric. Since we saved our leg work above, it’s really easy to just convert the differences in bulk with <code>mutate_all()</code>. After the conversion, we’ll bind the two rows of subplots together with a little <strong>patchwork</strong> and display the results.</p>
<div class="sourceCode" id="cb1718"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1718-1" data-line-number="1">p2 &lt;-</a>
<a class="sourceLine" id="cb1718-2" data-line-number="2"><span class="st">  </span>differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1718-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span> <span class="op">~</span>. <span class="op">/</span><span class="st"> </span>post<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1718-4" data-line-number="4"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb1718-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1718-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1718-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1718-8" data-line-number="8">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1718-9" data-line-number="9">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1718-10" data-line-number="10">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1718-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1718-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Effect Size&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1718-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">strip.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="fl">6.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1718-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb1718-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1718-16" data-line-number="16"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb1718-17" data-line-number="17">p1 <span class="op">/</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-65-1.png" style="display: block; margin: auto;" /></p>
<p>“The HDI widths of all the contrasts have gotten smaller by virtue of including the covariate in the analysis” (p. 571).</p>
</div>
<div id="analogous-to-traditional-ancova." class="section level3">
<h3><span class="header-section-number">19.4.2</span> Analogous to traditional ANCOVA.</h3>
<p>In contrast with ANCOVA,</p>
<blockquote>
<p>Bayesian methods do not partition the least-squares variance to make estimates, and therefore the Bayesian method is analogous to ANCOVA but is not ANCOVA. Frequentist practitioners are urged to test (with <span class="math inline">\(p\)</span> values) whether the assumptions of (a) equal slope in all groups, (b) equal standard deviation in all groups, and (c) normally distributed noise can be rejected. In a Bayesian approach, the descriptive model is generalized to address these concerns, as will be discussed in Section 19.5. (p. 572)</p>
</blockquote>
</div>
<div id="relation-to-hierarchical-linear-regression." class="section level3">
<h3><span class="header-section-number">19.4.3</span> Relation to hierarchical linear regression.</h3>
<p>Here Kruschke contrasts our last model with the one from way back in Chapter 17, section 3. As a refresher, here’s what that code looked like.</p>
<div class="sourceCode" id="cb1719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1719-1" data-line-number="1">fit17<span class="fl">.4</span> &lt;-</a>
<a class="sourceLine" id="cb1719-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1719-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1719-4" data-line-number="4">      y_z <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_z <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x_z <span class="op">||</span><span class="st"> </span>Subj),</a>
<a class="sourceLine" id="cb1719-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1719-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1719-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma),</a>
<a class="sourceLine" id="cb1719-8" data-line-number="8">                <span class="co"># the next line is new</span></a>
<a class="sourceLine" id="cb1719-9" data-line-number="9">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1719-10" data-line-number="10">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1719-11" data-line-number="11">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1719-12" data-line-number="12">      <span class="dt">stanvars =</span> <span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>, <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>),</a>
<a class="sourceLine" id="cb1719-13" data-line-number="13">      <span class="dt">seed =</span> <span class="dv">17</span>,</a>
<a class="sourceLine" id="cb1719-14" data-line-number="14">      <span class="dt">file =</span> <span class="st">&quot;fits/fit17.04&quot;</span>)</a></code></pre></div>
<p>And for convenience, here’s the code from the model we just fit.</p>
<div class="sourceCode" id="cb1720"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1720-1" data-line-number="1">fit19<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1720-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1720-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1720-4" data-line-number="4">      Longevity <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>thorax_c <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CompanionNumber),</a>
<a class="sourceLine" id="cb1720-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>),          <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1720-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span>sd_thorax_c), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1720-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">gamma</span>(alpha, beta),                <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1720-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y),                   <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1720-9" data-line-number="9">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1720-10" data-line-number="10">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1720-11" data-line-number="11">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>),</a>
<a class="sourceLine" id="cb1720-12" data-line-number="12">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1720-13" data-line-number="13">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.05&quot;</span>)</a></code></pre></div>
<p>It’s easy to get lost in the differences in the priors and the technical details with the model chains and such. The main thing to notice, here, is the differences in the model formulas (i.e., the likelihoods). Both models had intercepts and slopes. But whereas the model from 17.3 set both parameters to random, only the intercept in our last model was random. The covariate <code>thorax_c</code> was fixed–it did not vary by group. Had we wanted it to, our <code>formula</code> syntax would have been something like <code>Longevity ~ 1 + thorax_c + (1 + thorax_c || CompanionNumber)</code>. And again, as noted in Chapter 17, the <code>||</code> portion of the syntax set the random intercepts and slopes to be orthogonal (i.e., correlate exactly at zero). As we’ll see, this will often not be the case. But let’s not get ahead of ourselves.</p>
<blockquote>
<p>Conceptually, the main difference between the models is merely the focus of attention. In the hierarchical linear regression model, the focus was on the slope coefficient. In that case, we were trying to estimate the magnitude of the slope, simultaneously for individuals and overall. The intercepts, which describe the levels of the nominal predictor, were of ancillary interest. In the present section, on the other hand, the focus of attention is reversed. We are most interested in the intercepts and their differences between groups, with the slopes on the covariate being of ancillary interest. (p. 573)</p>
</blockquote>
</div>
</div>
<div id="heterogeneous-variances-and-robustness-against-outliers" class="section level2">
<h2><span class="header-section-number">19.5</span> Heterogeneous variances and robustness against outliers</h2>
<p>On page 574, Kruschke laid out the schematic for a hierarchical Student’s-<span class="math inline">\(t\)</span> model in for which both the <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> parameters are random. If you recall, Bürkner calls these <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_distreg.html">distributional models</a> and they are indeed available within the <strong>brms</strong> framework. But there’s a catch. Though we can model <span class="math inline">\(\sigma\)</span> all day long and we can even make it hierarchical, <strong>brms</strong> limits us to modeling the hierarchical <span class="math inline">\(\sigma\)</span> parameters within the typical Gaussian framework. That is, we will depart from Kruschke’s schematic in that we will be</p>
<ul>
<li>modeling the log of <span class="math inline">\(\sigma\)</span>,</li>
<li>indicating its grand mean with the <code>sigma ~ 1</code> syntax,</li>
<li>modeling the group-level deflections as Gaussian with a mean of 0 and standard deviation <span class="math inline">\(\sigma_\sigma\)</span> estimated from the data,</li>
<li>and choosing a sensible prior for <span class="math inline">\(\sigma_\sigma\)</span> that is left-bound at 0 and gently slopes to the right (i.e., a folded <span class="math inline">\(t\)</span> or gamma distribution).</li>
</ul>
<p>Since we’re modeling <span class="math inline">\(\log (\sigma)\)</span>, we might use Gaussian prior centered on <code>sd(my_data$y) %&gt;% log()</code> and a reasonable spread like 1. We can simulate a little to get a sense of what those distributions look like.</p>
<div class="sourceCode" id="cb1721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1721-1" data-line-number="1">n_draws &lt;-<span class="st"> </span><span class="fl">1e3</span></a>
<a class="sourceLine" id="cb1721-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1721-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">19</span>)</a>
<a class="sourceLine" id="cb1721-4" data-line-number="4"><span class="kw">tibble</span>(<span class="dt">prior =</span> <span class="kw">rnorm</span>(n_draws, <span class="dt">mean =</span> <span class="kw">log</span>(<span class="dv">1</span>), <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1721-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior_exp =</span> <span class="kw">exp</span>(prior)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1721-6" data-line-number="6"><span class="st">  </span><span class="kw">gather</span>(key, value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1721-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1721-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1721-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1721-10" data-line-number="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-68-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s what is looks like with <code>sd = 2</code>.</p>
<div class="sourceCode" id="cb1722"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1722-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">19</span>)</a>
<a class="sourceLine" id="cb1722-2" data-line-number="2"><span class="kw">tibble</span>(<span class="dt">prior =</span> <span class="kw">rnorm</span>(n_draws, <span class="dt">mean =</span> <span class="kw">log</span>(<span class="dv">1</span>), <span class="dt">sd =</span> <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1722-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">prior_exp =</span> <span class="kw">exp</span>(prior)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1722-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1722-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> prior_exp)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1722-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1722-7" data-line-number="7"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">17</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-69-1.png" style="display: block; margin: auto;" /></p>
<p>Though we’re still peaking around 1, there’s more mass in the tail, making it easier for the likelihood to pull away from the prior mode.</p>
<p>But all this is the prior on the fixed effect, the grand mean of <span class="math inline">\(\log (\sigma)\)</span>. Keep in mind we’re also estimating group-level deflections using a hierarchical model. The good old folded <span class="math inline">\(t\)</span> on the unit scale is already pretty permissive for an estimate that is itself on the log scale. To make it more conservative, set <span class="math inline">\(\nu\)</span> to infinity and go with a folded Gaussian. Or keep your regularization loose and go with a low-<span class="math inline">\(\nu\)</span> folded <span class="math inline">\(t\)</span> or even a folded Cauchy. And, of course, one could even go with a gamma.</p>
<p>Consider we have data <code>my_data</code> for which our primary variable of interest is <code>y</code>. Starting from preparing our <code>stanvars</code> values, here’s what the model code might look like.</p>
<div class="sourceCode" id="cb1723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1723-1" data-line-number="1"><span class="co"># get ready for `stanvars`</span></a>
<a class="sourceLine" id="cb1723-2" data-line-number="2">mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb1723-3" data-line-number="3">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb1723-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1723-5" data-line-number="5">omega  &lt;-<span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1723-6" data-line-number="6">sigma  &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y</a>
<a class="sourceLine" id="cb1723-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1723-8" data-line-number="8">s_r    &lt;-<span class="st"> </span><span class="kw">gamma_a_b_from_omega_sigma</span>(<span class="dt">mode =</span> omega, <span class="dt">sd =</span> sigma)</a>
<a class="sourceLine" id="cb1723-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1723-10" data-line-number="10"><span class="co"># define `stanvars`</span></a>
<a class="sourceLine" id="cb1723-11" data-line-number="11">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1723-12" data-line-number="12"><span class="st">  </span><span class="kw">stanvar</span>(mean_y,    <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1723-13" data-line-number="13"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,      <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1723-14" data-line-number="14"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>shape, <span class="dt">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1723-15" data-line-number="15"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>rate,  <span class="dt">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1723-16" data-line-number="16"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>,      <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</a>
<a class="sourceLine" id="cb1723-17" data-line-number="17"></a>
<a class="sourceLine" id="cb1723-18" data-line-number="18"><span class="co"># fit the model</span></a>
<a class="sourceLine" id="cb1723-19" data-line-number="19">fit &lt;-</a>
<a class="sourceLine" id="cb1723-20" data-line-number="20"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1723-21" data-line-number="21">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1723-22" data-line-number="22">      <span class="kw">bf</span>(Longevity <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CompanionNumber), </a>
<a class="sourceLine" id="cb1723-23" data-line-number="23">         sigma     <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>CompanionNumber)),</a>
<a class="sourceLine" id="cb1723-24" data-line-number="24">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="co"># grand means</span></a>
<a class="sourceLine" id="cb1723-25" data-line-number="25">                <span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1723-26" data-line-number="26">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="kw">log</span>(sd_y), <span class="dv">1</span>), <span class="dt">class =</span> Intercept, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1723-27" data-line-number="27">                </a>
<a class="sourceLine" id="cb1723-28" data-line-number="28">                <span class="co"># the priors controlling the spread for our hierarchical deflections</span></a>
<a class="sourceLine" id="cb1723-29" data-line-number="29">                <span class="kw">prior</span>(<span class="kw">gamma</span>(alpha, beta), <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1723-30" data-line-number="30">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1723-31" data-line-number="31">                </a>
<a class="sourceLine" id="cb1723-32" data-line-number="32">                <span class="co"># don&#39;t forget our student-t nu</span></a>
<a class="sourceLine" id="cb1723-33" data-line-number="33">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1723-34" data-line-number="34">      <span class="dt">stanvars =</span> stanvars)</a></code></pre></div>
<div id="example-contrast-of-means-with-different-variances." class="section level3">
<h3><span class="header-section-number">19.5.1</span> Example: Contrast of means with different variances.</h3>
<p>Let’s load and take a look at Kruschke’s simulated group data.</p>
<div class="sourceCode" id="cb1724"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1724-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/NonhomogVarData.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1724-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1724-3" data-line-number="3"><span class="kw">head</span>(my_data)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 2
##   Group     Y
##   &lt;chr&gt; &lt;dbl&gt;
## 1 A      97.8
## 2 A      99.9
## 3 A      92.4
## 4 A      96.9
## 5 A     101. 
## 6 A      80.7</code></pre>
<p>Here are the means and <span class="math inline">\(SD\)</span>s for each <code>Group</code>.</p>
<div class="sourceCode" id="cb1726"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1726-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1726-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1726-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Y),</a>
<a class="sourceLine" id="cb1726-4" data-line-number="4">            <span class="dt">sd   =</span> <span class="kw">sd</span>(Y))</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   Group  mean    sd
##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A      97.0  8.00
## 2 B      99.0  1.00
## 3 C     102.   1.  
## 4 D     104.   8.00</code></pre>
<p>First we’ll fit the model with homogeneous variances. To keep things simple, here we’ll fit a conventional model following the form of our original <code>fit1</code>. Here are our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1728"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1728-1" data-line-number="1">(mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Y))</a></code></pre></div>
<pre><code>## [1] 100.5</code></pre>
<div class="sourceCode" id="cb1730"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1730-1" data-line-number="1">(sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Y))</a></code></pre></div>
<pre><code>## [1] 6.228965</code></pre>
<div class="sourceCode" id="cb1732"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1732-1" data-line-number="1">omega &lt;-<span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1732-2" data-line-number="2">sigma &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>sd_y</a>
<a class="sourceLine" id="cb1732-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1732-4" data-line-number="4">(s_r  &lt;-<span class="st"> </span><span class="kw">gamma_a_b_from_omega_sigma</span>(<span class="dt">mode =</span> omega, <span class="dt">sd =</span> sigma))</a></code></pre></div>
<pre><code>## $shape
## [1] 1.283196
## 
## $rate
## [1] 0.09092861</code></pre>
<div class="sourceCode" id="cb1734"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1734-1" data-line-number="1"><span class="co"># define `stanvars`</span></a>
<a class="sourceLine" id="cb1734-2" data-line-number="2">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1734-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(mean_y,    <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1734-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,      <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1734-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>shape, <span class="dt">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1734-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>rate,  <span class="dt">name =</span> <span class="st">&quot;beta&quot;</span>)</a></code></pre></div>
<p>Now fit the ANOVA-like homogeneous-variances model.</p>
<div class="sourceCode" id="cb1735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1735-1" data-line-number="1">fit19<span class="fl">.6</span> &lt;-</a>
<a class="sourceLine" id="cb1735-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1735-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1735-4" data-line-number="4">      Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Group),</a>
<a class="sourceLine" id="cb1735-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">10</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1735-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">gamma</span>(alpha, beta), <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1735-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1735-8" data-line-number="8">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1735-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1735-10" data-line-number="10">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.999</span>),</a>
<a class="sourceLine" id="cb1735-11" data-line-number="11">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1735-12" data-line-number="12">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.06&quot;</span>)</a></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1736"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1736-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.6</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Y ~ 1 + (1 | Group) 
##    Data: my_data (Number of observations: 96) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Group-Level Effects: 
## ~Group (Number of levels: 4) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     4.96      3.56     1.46    14.67 1.00     1814     2546
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept   100.47      3.19    94.43   106.42 1.00     2255     1885
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     5.76      0.43     4.99     6.68 1.00     5581     5873
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s get ready to make our version of the top of Figure 19.7. First we wrangle.</p>
<div class="sourceCode" id="cb1738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1738-1" data-line-number="1"><span class="co"># how many model-implied Gaussians would you like?</span></a>
<a class="sourceLine" id="cb1738-2" data-line-number="2">n_draws &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1738-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1738-4" data-line-number="4">densities &lt;-</a>
<a class="sourceLine" id="cb1738-5" data-line-number="5"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-6" data-line-number="6"><span class="st">  </span><span class="kw">distinct</span>(Group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-7" data-line-number="7"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit19<span class="fl">.6</span>, <span class="dt">n =</span> n_draws, <span class="dt">seed =</span> <span class="dv">19</span>, <span class="dt">dpar =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ll =</span> <span class="kw">qnorm</span>(.<span class="dv">025</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma),</a>
<a class="sourceLine" id="cb1738-9" data-line-number="9">         <span class="dt">ul =</span> <span class="kw">qnorm</span>(.<span class="dv">975</span>, <span class="dt">mean =</span> mu, <span class="dt">sd =</span> sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y =</span> <span class="kw">map2</span>(ll, ul, seq, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest</span>(Y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(Y, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(.draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1738-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> density <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(density))</a>
<a class="sourceLine" id="cb1738-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1738-16" data-line-number="16"><span class="kw">glimpse</span>(densities)</a></code></pre></div>
<pre><code>## Observations: 8,000
## Variables: 12
## Groups: .draw [20]
## $ Group      &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;…
## $ .row       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ .chain     &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw      &lt;int&gt; 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, …
## $ .value     &lt;dbl&gt; 99.42235, 99.42235, 99.42235, 99.42235, 99.42235, 99.42235, 99.42235, 99.42235…
## $ mu         &lt;dbl&gt; 99.42235, 99.42235, 99.42235, 99.42235, 99.42235, 99.42235, 99.42235, 99.42235…
## $ sigma      &lt;dbl&gt; 6.640072, 6.640072, 6.640072, 6.640072, 6.640072, 6.640072, 6.640072, 6.640072…
## $ ll         &lt;dbl&gt; 86.40805, 86.40805, 86.40805, 86.40805, 86.40805, 86.40805, 86.40805, 86.40805…
## $ ul         &lt;dbl&gt; 112.4367, 112.4367, 112.4367, 112.4367, 112.4367, 112.4367, 112.4367, 112.4367…
## $ Y          &lt;dbl&gt; 86.40805, 86.67096, 86.93388, 87.19679, 87.45971, 87.72262, 87.98554, 88.24846…
## $ density    &lt;dbl&gt; 0.1465288, 0.1582290, 0.1705958, 0.1836410, 0.1973740, 0.2118018, 0.2269281, 0…</code></pre>
<p>In our wrangling code, the main thing to notice is those last two lines. If you look closely to Kruschke’s Gaussians, you’ll notice they all have the same maximum height. Up to this point, ours haven’t. This has to do with technicalities on how densities are scaled. In brief, the wider densities have been shorter. So those last two lines scaled all the densities within the same group to the same metric. Otherwise the code was business as usual.</p>
<p>Anyway, here’s our version of the top panel of Figure 19.7.</p>
<div class="sourceCode" id="cb1740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1740-1" data-line-number="1">densities <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1740-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y, <span class="dt">y =</span> Group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1740-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ridgeline</span>(<span class="kw">aes</span>(<span class="dt">height =</span> density, <span class="dt">group =</span> <span class="kw">interaction</span>(Group, .draw)),</a>
<a class="sourceLine" id="cb1740-4" data-line-number="4">                 <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha.f =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1740-5" data-line-number="5">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">scale =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1740-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1740-7" data-line-number="7">              <span class="dt">height =</span> <span class="fl">.04</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1740-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">80</span>, <span class="dt">to =</span> <span class="dv">120</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1740-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>, </a>
<a class="sourceLine" id="cb1740-10" data-line-number="10">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1740-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">75</span><span class="op">:</span><span class="dv">125</span>,</a>
<a class="sourceLine" id="cb1740-12" data-line-number="12">                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">4.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1740-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1740-14" data-line-number="14">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-76-1.png" style="display: block; margin: auto;" /></p>
<p>Here are the difference distributions in the middle of Figure 19.7.</p>
<div class="sourceCode" id="cb1741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1741-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit19<span class="fl">.6</span>)</a>
<a class="sourceLine" id="cb1741-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1741-3" data-line-number="3">differences &lt;-</a>
<a class="sourceLine" id="cb1741-4" data-line-number="4"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1741-5" data-line-number="5"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">D vs A</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">r_Group[D,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_Group[A,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1741-6" data-line-number="6">            <span class="st">`</span><span class="dt">C vs B</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">r_Group[C,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_Group[B,Intercept]</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb1741-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1741-8" data-line-number="8">differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1741-9" data-line-number="9"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1741-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1741-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb1741-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1741-13" data-line-number="13"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb1741-14" data-line-number="14">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1741-15" data-line-number="15">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1741-16" data-line-number="16">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1741-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1741-18" data-line-number="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Difference&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1741-19" data-line-number="19"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-77-1.png" style="display: block; margin: auto;" /></p>
<p>Now here are the effect sizes at the bottom of the figure.</p>
<div class="sourceCode" id="cb1742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1742-1" data-line-number="1">differences <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1742-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span> <span class="op">~</span>. <span class="op">/</span><span class="st"> </span>post<span class="op">$</span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1742-3" data-line-number="3"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1742-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1742-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1742-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1742-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb1742-8" data-line-number="8">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1742-9" data-line-number="9">                     <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1742-10" data-line-number="10">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1742-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1742-12" data-line-number="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Effect Size&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1742-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-78-1.png" style="display: block; margin: auto;" /></p>
<p>Oh and remember, if you’d like to get all the possible contrasts in bulk, <strong>tidybayes</strong> has got your back.</p>
<div class="sourceCode" id="cb1743"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1743-1" data-line-number="1">fit19<span class="fl">.6</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1743-2" data-line-number="2"><span class="st">  </span><span class="kw">spread_draws</span>(r_Group[Group,]) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1743-3" data-line-number="3"><span class="st">  </span><span class="kw">compare_levels</span>(r_Group, <span class="dt">by =</span> Group) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1743-4" data-line-number="4"><span class="st">  </span><span class="co"># these next two lines allow us to reorder the contrasts along the y</span></a>
<a class="sourceLine" id="cb1743-5" data-line-number="5"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1743-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Group =</span> <span class="kw">reorder</span>(Group, r_Group)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1743-7" data-line-number="7"><span class="st">  </span></a>
<a class="sourceLine" id="cb1743-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> r_Group, <span class="dt">y =</span> Group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1743-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1743-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1743-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Contrast&quot;</span>,</a>
<a class="sourceLine" id="cb1743-12" data-line-number="12">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1743-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.33</span>, <span class="fl">6.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1743-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1743-15" data-line-number="15">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-79-1.png" style="display: block; margin: auto;" /></p>
<p>But to get back on track, here are the <code>stanvars</code> for the robust hierarchical variances model.</p>
<div class="sourceCode" id="cb1744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1744-1" data-line-number="1">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1744-2" data-line-number="2"><span class="st">  </span><span class="kw">stanvar</span>(mean_y,    <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1744-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,      <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1744-4" data-line-number="4"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>shape, <span class="dt">name =</span> <span class="st">&quot;alpha&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1744-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(s_r<span class="op">$</span>rate,  <span class="dt">name =</span> <span class="st">&quot;beta&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1744-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">29</span>,      <span class="dt">name =</span> <span class="st">&quot;one_over_twentynine&quot;</span>)</a></code></pre></div>
<p>Now fit that robust better-than-ANOVA model.</p>
<div class="sourceCode" id="cb1745"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1745-1" data-line-number="1">fit19<span class="fl">.7</span> &lt;-</a>
<a class="sourceLine" id="cb1745-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1745-3" data-line-number="3">      <span class="dt">family =</span> student,</a>
<a class="sourceLine" id="cb1745-4" data-line-number="4">      <span class="kw">bf</span>(Y     <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Group), </a>
<a class="sourceLine" id="cb1745-5" data-line-number="5">         sigma <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Group)),</a>
<a class="sourceLine" id="cb1745-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="co"># grand means</span></a>
<a class="sourceLine" id="cb1745-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">10</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1745-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="kw">log</span>(sd_y), <span class="dv">1</span>), <span class="dt">class =</span> Intercept, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1745-9" data-line-number="9">                </a>
<a class="sourceLine" id="cb1745-10" data-line-number="10">                <span class="co"># the priors controlling the spread for our hierarchical deflections</span></a>
<a class="sourceLine" id="cb1745-11" data-line-number="11">                <span class="kw">prior</span>(<span class="kw">gamma</span>(alpha, beta), <span class="dt">class =</span> sd),</a>
<a class="sourceLine" id="cb1745-12" data-line-number="12">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd, <span class="dt">dpar =</span> sigma),</a>
<a class="sourceLine" id="cb1745-13" data-line-number="13">                </a>
<a class="sourceLine" id="cb1745-14" data-line-number="14">                <span class="co"># don&#39;t forget our student-t nu</span></a>
<a class="sourceLine" id="cb1745-15" data-line-number="15">                <span class="kw">prior</span>(<span class="kw">exponential</span>(one_over_twentynine), <span class="dt">class =</span> nu)),</a>
<a class="sourceLine" id="cb1745-16" data-line-number="16">      <span class="dt">iter =</span> <span class="dv">4000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1745-17" data-line-number="17">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1745-18" data-line-number="18">      <span class="dt">control =</span> <span class="kw">list</span>(<span class="dt">adapt_delta =</span> <span class="fl">0.99</span>,</a>
<a class="sourceLine" id="cb1745-19" data-line-number="19">                     <span class="dt">max_treedepth =</span> <span class="dv">12</span>),</a>
<a class="sourceLine" id="cb1745-20" data-line-number="20">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1745-21" data-line-number="21">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.07&quot;</span>)</a></code></pre></div>
<p>The chains look good.</p>
<div class="sourceCode" id="cb1746"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1746-1" data-line-number="1"><span class="kw">plot</span>(fit19<span class="fl">.7</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-81-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s the parameter summary.</p>
<div class="sourceCode" id="cb1747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1747-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.7</span>)</a></code></pre></div>
<pre><code>##  Family: student 
##   Links: mu = identity; sigma = log; nu = identity 
## Formula: Y ~ 1 + (1 | Group) 
##          sigma ~ 1 + (1 | Group)
##    Data: my_data (Number of observations: 96) 
## Samples: 4 chains, each with iter = 4000; warmup = 1000; thin = 1;
##          total post-warmup samples = 12000
## 
## Group-Level Effects: 
## ~Group (Number of levels: 4) 
##                     Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)           4.55      3.14     1.32    13.02 1.00     3148     4776
## sd(sigma_Intercept)     1.23      0.40     0.65     2.18 1.00     4350     5529
## 
## Population-Level Effects: 
##                 Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept         100.48      2.73    94.73   105.97 1.00     4094     4128
## sigma_Intercept     1.23      0.54     0.21     2.37 1.00     4568     5951
## 
## Family Specific Parameters: 
##    Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## nu    32.67     28.51     4.65   109.84 1.00    10110     8384
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Let’s get ready to make our version of the top of Figure 19.7. First we wrangle.</p>
<div class="sourceCode" id="cb1749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1749-1" data-line-number="1">densities &lt;-</a>
<a class="sourceLine" id="cb1749-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-3" data-line-number="3"><span class="st">  </span><span class="kw">distinct</span>(Group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-4" data-line-number="4"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit19<span class="fl">.7</span>, <span class="dt">n =</span> n_draws, <span class="dt">seed =</span> <span class="dv">19</span>, <span class="dt">dpar =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;nu&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ll =</span> <span class="kw">qt</span>(.<span class="dv">025</span>, <span class="dt">df =</span> nu),</a>
<a class="sourceLine" id="cb1749-6" data-line-number="6">         <span class="dt">ul =</span> <span class="kw">qt</span>(.<span class="dv">975</span>, <span class="dt">df =</span> nu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y =</span> <span class="kw">map2</span>(ll, ul, seq, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-8" data-line-number="8"><span class="st">  </span><span class="kw">unnest</span>(Y) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1749-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dt</span>(Y, nu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-10" data-line-number="10"><span class="st">  </span><span class="co"># notice the conversion</span></a>
<a class="sourceLine" id="cb1749-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y =</span> mu <span class="op">+</span><span class="st"> </span>Y <span class="op">*</span><span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-12" data-line-number="12"><span class="st">  </span><span class="kw">group_by</span>(.draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1749-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> density <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(density))</a>
<a class="sourceLine" id="cb1749-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1749-15" data-line-number="15"><span class="kw">glimpse</span>(densities)</a></code></pre></div>
<pre><code>## Observations: 8,000
## Variables: 13
## Groups: .draw [20]
## $ Group      &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;…
## $ .row       &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
## $ .chain     &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .iteration &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
## $ .draw      &lt;int&gt; 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, 1115, …
## $ .value     &lt;dbl&gt; 97.33906, 97.33906, 97.33906, 97.33906, 97.33906, 97.33906, 97.33906, 97.33906…
## $ mu         &lt;dbl&gt; 97.33906, 97.33906, 97.33906, 97.33906, 97.33906, 97.33906, 97.33906, 97.33906…
## $ sigma      &lt;dbl&gt; 6.611823, 6.611823, 6.611823, 6.611823, 6.611823, 6.611823, 6.611823, 6.611823…
## $ nu         &lt;dbl&gt; 24.33915, 24.33915, 24.33915, 24.33915, 24.33915, 24.33915, 24.33915, 24.33915…
## $ ll         &lt;dbl&gt; -2.062378, -2.062378, -2.062378, -2.062378, -2.062378, -2.062378, -2.062378, -…
## $ ul         &lt;dbl&gt; 2.062378, 2.062378, 2.062378, 2.062378, 2.062378, 2.062378, 2.062378, 2.062378…
## $ Y          &lt;dbl&gt; 83.70299, 83.97846, 84.25394, 84.52941, 84.80489, 85.08037, 85.35584, 85.63132…
## $ density    &lt;dbl&gt; 0.1299849, 0.1401936, 0.1510374, 0.1625369, 0.1747115, 0.1875784, 0.2011531, 0…</code></pre>
<p>If you look closely at our code, above, you’ll note switching from the Gaussian to the Student <span class="math inline">\(t\)</span> required changes in our flow. Most obviously, we switched from <code>qnorm()</code> and <code>dnorm()</code> to <code>qt()</code> and <code>dt()</code>, respectively. The base <strong>R</strong> Student <span class="math inline">\(t\)</span> functions don’t take arguments for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. Rather, they’re presumed to be 0 and 1, respectively. That means that for our first three <code>mutate()</code> functions, the computations were all based on the standard Student <span class="math inline">\(t\)</span>, with only the <span class="math inline">\(\nu\)</span> parameter varying according to the posterior. The way we corrected for that was with the fourth <code>mutate()</code>.</p>
<p>Now we’re ready to make and save our version of the top panel of Figure 19.7.</p>
<div class="sourceCode" id="cb1751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1751-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb1751-2" data-line-number="2"><span class="st">  </span>densities <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1751-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y, <span class="dt">y =</span> Group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1751-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ridgeline</span>(<span class="kw">aes</span>(<span class="dt">height =</span> density, <span class="dt">group =</span> <span class="kw">interaction</span>(Group, .draw)),</a>
<a class="sourceLine" id="cb1751-5" data-line-number="5">                 <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha.f =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1751-6" data-line-number="6">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">scale =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1751-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1751-8" data-line-number="8">              <span class="dt">height =</span> <span class="fl">.04</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1751-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">80</span>, <span class="dt">to =</span> <span class="dv">120</span>, <span class="dt">by =</span> <span class="dv">10</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1751-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>, </a>
<a class="sourceLine" id="cb1751-11" data-line-number="11">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1751-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">75</span><span class="op">:</span><span class="dv">125</span>,</a>
<a class="sourceLine" id="cb1751-13" data-line-number="13">                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">4.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1751-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1751-15" data-line-number="15">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p>Here we make the difference distributions in the middle of Figure 19.8.</p>
<div class="sourceCode" id="cb1752"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1752-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit19<span class="fl">.7</span>)</a>
<a class="sourceLine" id="cb1752-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1752-3" data-line-number="3">p2 &lt;-</a>
<a class="sourceLine" id="cb1752-4" data-line-number="4"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1752-5" data-line-number="5"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">D vs A</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">r_Group[D,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_Group[A,Intercept]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb1752-6" data-line-number="6">            <span class="st">`</span><span class="dt">C vs B</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">r_Group[C,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_Group[B,Intercept]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1752-7" data-line-number="7"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1752-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1752-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1752-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1752-11" data-line-number="11"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb1752-12" data-line-number="12">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1752-13" data-line-number="13">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1752-14" data-line-number="14">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1752-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1752-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Difference&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1752-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>And here we make the plots of the corresponding effect sizes at the bottom of the Figure 19.8.</p>
<div class="sourceCode" id="cb1753"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1753-1" data-line-number="1">p3 &lt;-</a>
<a class="sourceLine" id="cb1753-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1753-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">D vs A</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_Group[D,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_Group[A,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1753-4" data-line-number="4"><span class="st">              </span><span class="kw">exp</span>((b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[D,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[A,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>),</a>
<a class="sourceLine" id="cb1753-5" data-line-number="5">            <span class="st">`</span><span class="dt">C vs B</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">r_Group[C,Intercept]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">r_Group[B,Intercept]</span><span class="st">`</span>) <span class="op">/</span></a>
<a class="sourceLine" id="cb1753-6" data-line-number="6"><span class="st">              </span><span class="kw">exp</span>((b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[C,Intercept]</span><span class="st">`</span> <span class="op">+</span><span class="st"> </span>b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[B,Intercept]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1753-7" data-line-number="7"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1753-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1753-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1753-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1753-11" data-line-number="11"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb1753-12" data-line-number="12">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1753-13" data-line-number="13">                     <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1753-14" data-line-number="14">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1753-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1753-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Effect Size&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1753-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Combine them all and plot!</p>
<div class="sourceCode" id="cb1754"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1754-1" data-line-number="1">p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">heights =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-87-1.png" style="display: block; margin: auto;" /></p>
<p>Notice that because (a) the sigma parameters were heterogeneous and (b) they were estimated on the log scale, we had to do quite a bit more data processing before they effect size estimates were ready.</p>
<p>“Finally, because each group has its own estimated scale (i.e., <span class="math inline">\(\sigma_j\)</span>), we can investigate differences in scales across groups” (p. 578). That’s not a bad idea. Even though Kruschke didn’t show this in the text, we may as well give it a go.</p>
<div class="sourceCode" id="cb1755"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1755-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1755-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">D vs A</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[D,Intercept]</span><span class="st">`</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[A,Intercept]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb1755-3" data-line-number="3">            <span class="st">`</span><span class="dt">C vs B</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[C,Intercept]</span><span class="st">`</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[B,Intercept]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb1755-4" data-line-number="4">            <span class="st">`</span><span class="dt">D vs C</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[D,Intercept]</span><span class="st">`</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[C,Intercept]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb1755-5" data-line-number="5">            <span class="st">`</span><span class="dt">B vs A</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[B,Intercept]</span><span class="st">`</span>) <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(b_sigma_Intercept <span class="op">+</span><span class="st"> `</span><span class="dt">r_Group__sigma[A,Intercept]</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1755-6" data-line-number="6"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1755-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">factor</span>(key, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;D vs A&quot;</span>, <span class="st">&quot;C vs B&quot;</span>, <span class="st">&quot;D vs C&quot;</span>, <span class="st">&quot;B vs A&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1755-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb1755-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1755-10" data-line-number="10"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>),</a>
<a class="sourceLine" id="cb1755-11" data-line-number="11">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1755-12" data-line-number="12">                     <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1755-13" data-line-number="13">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1755-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1755-15" data-line-number="15"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(Differences<span class="op">~</span><span class="st">&#39;in&#39;</span><span class="op">~</span>sigma)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1755-16" data-line-number="16"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-88-1.png" style="display: block; margin: auto;" /></p>
<p>For more on models including a hierarchical structure on both the mean and scale structures, check out <a href="https://twitter.com/wdonald_1985">Donald Williams</a> and colleagues’ work on what they call Mixed Effect Location and Scale Models (MELSM; e.g., <a href="https://psyarxiv.com/4kfjp/">here</a> or <a href="https://link.springer.com/article/10.3758/s13428-019-01255-9">here</a>). They’re quite handy and I’ve begun using them in my applied work (e.g., <a href="https://osf.io/vekpf/">here</a>).</p>
</div>
</div>
<div id="exercises-walk-out-an-effect-size" class="section level2">
<h2><span class="header-section-number">19.6</span> <del>Exercises</del> Walk out an effect size</h2>
<p>We computed a lot of effect sizes in this chapter. They were all standardized mean differences. Cohen (<a href="https://www.taylorfrancis.com/books/9780203771587">1988</a>) discussed these kinds of effect sizes in this way:</p>
<blockquote>
<p>We need a “pure” number, one free of our original measurement unit, with which to index what can be alternately called the degree of departure from the null hypothesis of the alternate hypothesis, or the ES (effect size) we wish to detect. This is accomplished by standardizing the raw effect size as expressed in the measurement unit of the dependent variable by dividing it by the (common) standard deviation of the measures in their respective populations, the latter also in the original measurement unit. (p. 20)</p>
</blockquote>
<p>Though Cohen framed his discussion in terms of null-hypothesis significance testing, we can just as easily apply it to our Bayesian modeling framework. The main thing is we can use his definitions form above to define a particular kind of effect size—the standardized mean difference between two groups. This is commonly referred to as a Cohen’s <span class="math inline">\(d\)</span>, which follows the formula</p>
<p><span class="math display">\[d = \frac{\bar y_A - \bar y_B}{s_y},\]</span></p>
<p>where the unstandardized means of the variable of interest <span class="math inline">\(y\)</span> are compared between two groups, A and B. From the raw data, we compute their two means, <span class="math inline">\(\bar y_A\)</span> and <span class="math inline">\(\bar y_B\)</span>, and divide their difference by the common (i.e., pooled) standard deviation <span class="math inline">\(s_y\)</span>. As is the typical case, the empirically-derived means and standard deviations are stand-ins (i.e., estimates) of the population parameters. If we’re willing to ignore uncertainty, we can do this all by hand.</p>
<p>Let’s walk this out with the fruit-fly data from section 19.3.2.</p>
<div class="sourceCode" id="cb1756"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1756-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/FruitflyDataReduced.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1756-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1756-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 125
## Variables: 3
## $ Longevity       &lt;dbl&gt; 35, 37, 49, 46, 63, 39, 46, 56, 63, 65, 56, 65, 70, 63, 65, 70, 77, 81, 8…
## $ CompanionNumber &lt;chr&gt; &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnant8&quot;, &quot;Pregnan…
## $ Thorax          &lt;dbl&gt; 0.64, 0.68, 0.68, 0.72, 0.72, 0.76, 0.76, 0.76, 0.76, 0.76, 0.80, 0.80, 0…</code></pre>
<p>Recall we have five groups indexed by <code>CompanionNumber</code>, each with <span class="math inline">\(n = 25\)</span>.</p>
<div class="sourceCode" id="cb1758"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1758-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1758-2" data-line-number="2"><span class="st">  </span><span class="kw">count</span>(CompanionNumber)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 2
##   CompanionNumber     n
##   &lt;chr&gt;           &lt;int&gt;
## 1 None0              25
## 2 Pregnant1          25
## 3 Pregnant8          25
## 4 Virgin1            25
## 5 Virgin8            25</code></pre>
<p>Let’s focus on just two groups, the male fruit flies for which individual males were supplied access to one or with virgin female fruit flies per day. In the data, these are <code>CompanionNumber == Virgin1</code> and <code>CompanionNumber == Virgin8</code>, respectively. Here’s a look at their mean <code>Longevity</code> values.</p>
<div class="sourceCode" id="cb1760"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1760-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1760-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(CompanionNumber, <span class="st">&quot;Virgin&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1760-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(CompanionNumber) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1760-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Longevity))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   CompanionNumber  mean
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 Virgin1          56.8
## 2 Virgin8          38.7</code></pre>
<p>If we’re willing to treat the males in the <code>Virgin1</code> group as group “a” and those in the <code>Virgin8</code> group as group “b”, we can save those mean values like so.</p>
<div class="sourceCode" id="cb1762"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1762-1" data-line-number="1">y_bar_a &lt;-<span class="st"> </span><span class="fl">56.76</span></a>
<a class="sourceLine" id="cb1762-2" data-line-number="2">y_bar_b &lt;-<span class="st"> </span><span class="fl">38.72</span></a></code></pre></div>
<p>Now we’ll compute their pooled standard deviation.</p>
<div class="sourceCode" id="cb1763"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1763-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1763-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(CompanionNumber, <span class="st">&quot;Virgin&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1763-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">s =</span> <span class="kw">sd</span>(Longevity))</a></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##       s
##   &lt;dbl&gt;
## 1  16.2</code></pre>
<p>Save that value.</p>
<div class="sourceCode" id="cb1765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1765-1" data-line-number="1">s_y &lt;-<span class="st"> </span><span class="fl">16.24533</span></a></code></pre></div>
<p>Now computing Cohen’s <span class="math inline">\(d\)</span> is just simple arithmetic.</p>
<div class="sourceCode" id="cb1766"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1766-1" data-line-number="1">(y_bar_a <span class="op">-</span><span class="st"> </span>y_bar_b) <span class="op">/</span><span class="st"> </span>s_y</a></code></pre></div>
<pre><code>## [1] 1.110473</code></pre>
<p>Though I’m not up on contemporary standards in fruit fly research, a Cohen’s <span class="math inline">\(d\)</span> of that size would be considered [conspicuously] large in most areas of my field (psychology). If we’d like to compute the <span class="math inline">\(d\)</span> estimates for any other combination of experimental conditions, we’d just follow the corresponding arithmetic.</p>
<p>As I hinted at earlier, the problem with this approach is it ignores uncertainty. Frequentists use various formulas to express this in terms of 95% confidence intervals. Our approach will be to express it with the posterior distribution of a Bayesian model. We’ve already accomplished this with our <code>fit19.1</code> from above. Here we’ll use three other approaches.</p>
<p>Instead of the Bayesian hierarchical alternative to the frequentist ANOVA, we can use a single-level model where we predict a metric variable with separate intercepts for the two levels of <code>CompanionNumber</code>. First, we subset the data and define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1768"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1768-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1768-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1768-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(CompanionNumber, <span class="st">&quot;Virgin&quot;</span>))</a>
<a class="sourceLine" id="cb1768-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1768-5" data-line-number="5">mean_y &lt;-<span class="st"> </span>(y_bar_a <span class="op">+</span><span class="st"> </span>y_bar_b) <span class="op">/</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb1768-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1768-7" data-line-number="7">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1768-8" data-line-number="8"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1768-9" data-line-number="9"><span class="st">  </span><span class="kw">stanvar</span>(s_y,    <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a></code></pre></div>
<p>Fit the model with <code>brm()</code>.</p>
<div class="sourceCode" id="cb1769"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1769-1" data-line-number="1">fit19<span class="fl">.8</span> &lt;-</a>
<a class="sourceLine" id="cb1769-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1769-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1769-4" data-line-number="4">      Longevity <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>CompanionNumber,</a>
<a class="sourceLine" id="cb1769-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1769-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1769-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1769-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1769-9" data-line-number="9">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1769-10" data-line-number="10">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.08&quot;</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb1770"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1770-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.8</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 0 + CompanionNumber 
##    Data: my_data (Number of observations: 50) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##                        Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## CompanionNumberVirgin1    56.74      2.87    51.12    62.41 1.00     6734     5909
## CompanionNumberVirgin8    38.70      2.81    33.14    44.20 1.00     7202     5730
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    13.85      1.45    11.38    17.07 1.00     6368     5482
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract the posterior draws.</p>
<div class="sourceCode" id="cb1772"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1772-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit19<span class="fl">.8</span>)</a></code></pre></div>
<p>Here we’ll plot the three dimensions of the posterior, each with the corresponding value from the Cohen’s <span class="math inline">\(d\)</span> formula marked off as a vertical line in the foreground.</p>
<div class="sourceCode" id="cb1773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1773-1" data-line-number="1">lines &lt;-</a>
<a class="sourceLine" id="cb1773-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">name  =</span> <span class="kw">c</span>(<span class="st">&quot;b_CompanionNumberVirgin1&quot;</span>, <span class="st">&quot;b_CompanionNumberVirgin8&quot;</span>, <span class="st">&quot;sigma&quot;</span>),</a>
<a class="sourceLine" id="cb1773-3" data-line-number="3">         <span class="dt">value =</span> <span class="kw">c</span>(y_bar_a, y_bar_b, s_y))</a>
<a class="sourceLine" id="cb1773-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1773-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1773-6" data-line-number="6"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>lp__) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1773-7" data-line-number="7"><span class="st">  </span></a>
<a class="sourceLine" id="cb1773-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1773-9" data-line-number="9"><span class="st">  </span><span class="kw">stat_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1773-10" data-line-number="10">                <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1773-11" data-line-number="11">                <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1773-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> lines,</a>
<a class="sourceLine" id="cb1773-13" data-line-number="13">             <span class="kw">aes</span>(<span class="dt">xintercept =</span> value),</a>
<a class="sourceLine" id="cb1773-14" data-line-number="14">             <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1773-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1773-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;posterior&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1773-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-99-1.png" style="display: block; margin: auto;" /></p>
<p>The model did a great job capturing the group means. Notice how the posterior <code>sigma</code> is a bit lower than the value <span class="math inline">\(s_y\)</span>. This is because <span class="math inline">\(\sigma\)</span> in the model is conditioned on the mean. Because we have two means, one for each group, that has ‘explained some of the variation’ in the criterion variable <code>Longevity</code>. Thus, our posterior for <span class="math inline">\(\sigma\)</span> might be more fully expressed as <span class="math inline">\(\sigma | \text{CompanionNumber}\)</span>. If we would like to compute our Cohen’s <span class="math inline">\(d\)</span> using the posterior iterations from <code>fit19.8</code>, we’d execute something like this.</p>
<div class="sourceCode" id="cb1774"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1774-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1774-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> (b_CompanionNumberVirgin1 <span class="op">-</span><span class="st"> </span>b_CompanionNumberVirgin8) <span class="op">/</span><span class="st"> </span>s_y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1774-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1774-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> d, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1774-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1774-6" data-line-number="6">                <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1774-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> (y_bar_a <span class="op">-</span><span class="st"> </span>y_bar_b) <span class="op">/</span><span class="st"> </span>s_y,</a>
<a class="sourceLine" id="cb1774-8" data-line-number="8">             <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1774-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1774-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Cohen&#39;s &quot;</span>, <span class="kw">italic</span>(d), <span class="st">&quot; expressed as a posterior&quot;</span>)))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-100-1.png" style="display: block; margin: auto;" /></p>
<p>Similar to the previous plots, this time we superimposed the density with the estimate for <span class="math inline">\(d\)</span> we computed above, <code>(y_bar_a - y_bar_b) / s_y</code>. Happily, the hand-calculated estimate coheres nicely with the central tendency of our posterior distribution. But now we get a full measure of uncertainty. Notice how wide those 95% HDIs are. Hopefully this isn’t a surprise given our noncommittal priors and only <span class="math inline">\(n = 25\)</span> for both groups. There’s a lot of uncertainty in that posterior.</p>
<p>A second way we might use a single-level model to compute a Cohen’s <span class="math inline">\(d\)</span> effect size is using a dummy variable. We’ll convert our nominal variable <code>CompanionNumber</code> into a binary variable <code>Virgin1</code> for which 1 corresponds to <code>CompanionNumber == Virgin1</code> and 0 corresponds to <code>CompanionNumber == Virgin8</code>. Compute the dummy.</p>
<div class="sourceCode" id="cb1775"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1775-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1775-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1775-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Virgin1 =</span> <span class="kw">if_else</span>(CompanionNumber <span class="op">==</span><span class="st"> &quot;Virgin1&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
<p>Now fit the dummy-predictor model with <code>brm()</code>.</p>
<div class="sourceCode" id="cb1776"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1776-1" data-line-number="1">fit19<span class="fl">.9</span> &lt;-</a>
<a class="sourceLine" id="cb1776-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1776-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1776-4" data-line-number="4">      Longevity <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Virgin1,</a>
<a class="sourceLine" id="cb1776-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1776-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1776-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1776-8" data-line-number="8">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1776-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1776-10" data-line-number="10">      <span class="dt">stanvars =</span> stanvars,</a>
<a class="sourceLine" id="cb1776-11" data-line-number="11">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.09&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb1777"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1777-1" data-line-number="1"><span class="kw">print</span>(fit19<span class="fl">.9</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Longevity ~ 1 + Virgin1 
##    Data: my_data (Number of observations: 50) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    38.73      2.79    33.19    44.27 1.00     7735     5541
## Virgin1      17.97      3.94    10.19    25.59 1.00     7058     5512
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma    13.85      1.47    11.32    17.08 1.00     6433     5111
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>With this parameterization, our posterior for <code>Intercept</code> is the same, within simulation variation, as <code>CompanionNumberVirgin8</code> from <code>fit7</code>. The posterior for <code>sigma</code> is about the same for both models, too. But focus on <code>Virgin1</code>. This is the unstandardized mean difference, what we called <span class="math inline">\(\bar y_A - \bar y_B\)</span> in our formula for Cohen’s <span class="math inline">\(d\)</span>. Here’s a look at its posterior distribution with its empirical estimate superimposed with a vertical line.</p>
<div class="sourceCode" id="cb1779"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1779-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit19<span class="fl">.9</span>)</a>
<a class="sourceLine" id="cb1779-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1779-3" data-line-number="3">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1779-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Virgin1, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1779-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1779-6" data-line-number="6">                <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1779-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> y_bar_a <span class="op">-</span><span class="st"> </span>y_bar_b,</a>
<a class="sourceLine" id="cb1779-8" data-line-number="8">             <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1779-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1779-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Unstandardized mean difference&quot;</span>)</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-103-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s how to standardize that unstandardized effect size into a Cohen’s-<span class="math inline">\(d\)</span> metric.</p>
<div class="sourceCode" id="cb1780"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1780-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1780-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> b_Virgin1 <span class="op">/</span><span class="st"> </span>s_y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1780-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1780-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> d, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1780-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1780-6" data-line-number="6">                <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1780-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> (y_bar_a <span class="op">-</span><span class="st"> </span>y_bar_b) <span class="op">/</span><span class="st"> </span>s_y,</a>
<a class="sourceLine" id="cb1780-8" data-line-number="8">             <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1780-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1780-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Cohen&#39;s &quot;</span>, <span class="kw">italic</span>(d), <span class="st">&quot; expressed as a posterior&quot;</span>)))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-104-1.png" style="display: block; margin: auto;" /></p>
<p>Let’s work this one more way. By simple algebra, a standardized mean difference is the same as the difference between two standardized means. If we standardize the criterion <code>Longevity</code> before fitting the model and continue using the dummy variable approach, the <code>Virgin1</code> posterior will be the same as a Cohen’s <span class="math inline">\(d\)</span>.</p>
<p>Standardize the criterion.</p>
<div class="sourceCode" id="cb1781"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1781-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1781-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1781-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Longevity_s =</span> (Longevity <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Longevity)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(Longevity))</a></code></pre></div>
<p>Because our criterion in a standardized metric, we no longer need our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb1782"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1782-1" data-line-number="1">fit19<span class="fl">.10</span> &lt;-</a>
<a class="sourceLine" id="cb1782-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1782-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb1782-4" data-line-number="4">      Longevity_s <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Virgin1,</a>
<a class="sourceLine" id="cb1782-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1782-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb1782-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb1782-8" data-line-number="8">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1782-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">19</span>,</a>
<a class="sourceLine" id="cb1782-10" data-line-number="10">      <span class="dt">file =</span> <span class="st">&quot;fits/fit19.10&quot;</span>)</a></code></pre></div>
<p>Behold our out-of-the-box Bayesian Cohen’s <span class="math inline">\(d\)</span>.</p>
<div class="sourceCode" id="cb1783"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1783-1" data-line-number="1"><span class="co"># no transformation necessary</span></a>
<a class="sourceLine" id="cb1783-2" data-line-number="2"><span class="kw">posterior_samples</span>(fit19<span class="fl">.10</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1783-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1783-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Virgin1, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1783-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb1783-6" data-line-number="6">                <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1783-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> (y_bar_a <span class="op">-</span><span class="st"> </span>y_bar_b) <span class="op">/</span><span class="st"> </span>s_y,</a>
<a class="sourceLine" id="cb1783-8" data-line-number="8">             <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>, <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1783-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1783-10" data-line-number="10"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Cohen&#39;s &quot;</span>, <span class="kw">italic</span>(d), <span class="st">&quot; expressed as a posterior&quot;</span>)))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-106-1.png" style="display: block; margin: auto;" /></p>
<p>If you work them through, the approaches we took for <code>fit19.8</code> and <code>fit19.9</code> can be generalized to models with more than two groups. You just need to be careful how to compute the <span class="math inline">\(s_y\)</span> for each comparison. The same cannot be said for our <code>fit19.10</code> approach. If you were to, say, fit a model that produced estimates for all five groups, you could not just standardize the data beforehand using the overall standard deviation. If you did, the pooled standard deviation you’d be basing your not-quite-Cohen’s <span class="math inline">\(d\)</span> posteriors on would be pooled across all groups, not just the two groups entailed in a given two-group comparison.</p>
<p>It’s also the case the that standardized mean differences we computed for <code>fit19.1</code>, above, are not quite Cohen’s <span class="math inline">\(d\)</span> effect sizes in the same way these have been. This is because the hierarchical approach we used partially pooled the estimates for each group toward the grand mean. You might say they were hierarchically-regularized Cohen’s <span class="math inline">\(d\)</span>s. But then again, Cohen’s formula for his <span class="math inline">\(d\)</span> statistic did not account for Bayesian priors, either. So perhaps a purist would deny that any of the standardized mean differences we’ve computed in this chapter were proper Cohen’s <span class="math inline">\(d\)</span> effect sizes. To be on the safe side, tell your readers exactly how you computed your models and what formulas you used to compute your effect sizes.</p>
<div id="populations-and-samples." class="section level3">
<h3><span class="header-section-number">19.6.1</span> Populations and samples.</h3>
<p>You may have noticed that in our equation for <span class="math inline">\(d\)</span>, above, we defined it in terms of sample statistics. Here it is again:</p>
<p><span class="math display">\[d = \frac{\bar y_A - \bar y_B}{s_y}\]</span></p>
<p>Sometimes we speak of the population parameter <span class="math inline">\(\delta\)</span>, which is correspondingly defined as</p>
<p><span class="math display">\[\delta = \frac{\mu_A - \mu_B}{\sigma},\]</span></p>
<p>where <span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\mu_B\)</span> are the population means for the two groups under consideration and <span class="math inline">\(\sigma\)</span> is the pooled standard deviation in the population. Often times we don’t have access to these values, which is why we run experiments and fit statistical models. But sometimes we do have access to the population parameters. In those cases, we can just plug them into the formula rather than estimate them in our models or with our sample statistics.</p>
<p>Back in section 16.1.2, we saw an example of this with the <code>TwoGroupIQ</code> data. Let’s load them, again.</p>
<div class="sourceCode" id="cb1784"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1784-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/TwoGroupIQ.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1784-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1784-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 120
## Variables: 2
## $ Score &lt;dbl&gt; 102, 107, 92, 101, 110, 68, 119, 106, 99, 103, 90, 93, 79, 89, 137, 119, 126, 110, …
## $ Group &lt;chr&gt; &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;, &quot;Smart Drug&quot;,…</code></pre>
<p>The data are IQ scores for participants in two groups. They look like this.</p>
<div class="sourceCode" id="cb1786"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1786-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1786-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Score, Group)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1786-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1786-4" data-line-number="4"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;IQ score&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1786-5" data-line-number="5"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">2.25</span>))</a></code></pre></div>
<p><img src="19_files/figure-gfm/unnamed-chunk-108-1.png" style="display: block; margin: auto;" /></p>
<p>If we wanted to compute the point estimate for Cohen’s <span class="math inline">\(d\)</span> by hand, we might extract the necessary sample statistics and go.</p>
<div class="sourceCode" id="cb1787"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1787-1" data-line-number="1"><span class="co"># save the sample means for the groups</span></a>
<a class="sourceLine" id="cb1787-2" data-line-number="2">y_bar_a &lt;-<span class="st"> </span><span class="kw">filter</span>(my_data, Group <span class="op">==</span><span class="st"> &quot;Smart Drug&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Score)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb1787-3" data-line-number="3">y_bar_b &lt;-<span class="st"> </span><span class="kw">filter</span>(my_data, Group <span class="op">==</span><span class="st"> &quot;Placebo&quot;</span>)    <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Score)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>()</a>
<a class="sourceLine" id="cb1787-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1787-5" data-line-number="5"><span class="co"># save the pooled standard deviation in the sample</span></a>
<a class="sourceLine" id="cb1787-6" data-line-number="6">s_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Score)</a>
<a class="sourceLine" id="cb1787-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1787-8" data-line-number="8"><span class="co"># compute Cohen&#39;s d</span></a>
<a class="sourceLine" id="cb1787-9" data-line-number="9">(y_bar_a <span class="op">-</span><span class="st"> </span>y_bar_b) <span class="op">/</span><span class="st"> </span>s_y</a></code></pre></div>
<pre><code>## [1] 0.3479417</code></pre>
<p>To get full posteriors for <span class="math inline">\(d\)</span>, you might use any of the three methods we practiced with, above. Because we’re only working with sample statistics, these are all only approximations of <span class="math inline">\(\delta\)</span>. The thing about IQ scores is we actually know the population mean and standard deviation for IQ. They are 100 and 15, respectively. We know this because the people who make IQ tests design them that way. Let’s see how well out sample statistics approximate the population parameters.</p>
<div class="sourceCode" id="cb1789"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1789-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1789-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(Group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1789-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(Score),</a>
<a class="sourceLine" id="cb1789-4" data-line-number="4">            <span class="dt">sd =</span> <span class="kw">sd</span>(Score))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 3
##   Group       mean    sd
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;
## 1 Placebo     100.  17.9
## 2 Smart Drug  108.  25.4</code></pre>
<p>Unsurprisingly, the values for the <code>Smart Drug</code> group are notably different from the population parameters. But notice how close the values from the <code>Placebo</code> group are to the population parameters. If they weren’t, we’d be concerned the <code>Placebo</code> condition was not a valid control. Looks like it was.</p>
<p>However, notice that the mean and standard deviation for the <code>Placebo</code> group are not the exact values of 100 and 15 the way they are in the population. If we wanted to compute a standardized mean difference between our <code>Smart Drug</code> group and folks in the population, we could just plug those values directly into our effect size equation. Here’s what that would look like if we plug in the population mean for the control group.</p>
<div class="sourceCode" id="cb1791"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1791-1" data-line-number="1">(y_bar_a <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">/</span><span class="st"> </span>s_y</a></code></pre></div>
<pre><code>## [1] 0.3495057</code></pre>
<p>The result is very close to the one above. But this time our equation for <span class="math inline">\(d\)</span> was</p>
<p><span class="math display">\[d = \frac{\bar y_A - \mu_B}{s_y},\]</span></p>
<p>where we used the population mean <span class="math inline">\(\mu_B\)</span>, but the other two terms were based on values from the sample. As long as you are defining the <code>Placebo</code> control as a stand-in for the population, this is a more precice way to compute <span class="math inline">\(d\)</span>. Going further, we can also replace our <span class="math inline">\(s_y\)</span> with <span class="math inline">\(\sigma\)</span> (i.e., 15).</p>
<div class="sourceCode" id="cb1793"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1793-1" data-line-number="1">(y_bar_a <span class="op">-</span><span class="st"> </span><span class="dv">100</span>) <span class="op">/</span><span class="st"> </span><span class="dv">15</span></a></code></pre></div>
<pre><code>## [1] 0.5227513</code></pre>
<p>Now our estimate is quite different. <em>Why</em>? Recall that sample standard deviations for both groups were larger than 15. That resulted in a <span class="math inline">\(s_y\)</span> value that was larger than 15, which meant we divided the unstandardized difference by a larger denominator. That larger denominator returned a smaller product.</p>
<p>We have more than simple algebra to contend with, though. Replacing <span class="math inline">\(s_y\)</span> with 15 actually changed the meaning of the effect size. We were no longer using a pooled standard deviation. Rather, we were using the unconditional population standard deviation. Again, as long as we’re equating our <code>Placebo</code> group with the population, we might restate that 15 as <span class="math inline">\(\sigma_B\)</span>. Sometimes you might see this expressed as <span class="math inline">\(\sigma_C\)</span>, where <span class="math inline">\(C\)</span> indicates “Control” (i.e., the reference category). That changed our formula to this:</p>
<p><span class="math display">\[d = \frac{\bar y_A - \mu_B}{\sigma_B}\]</span></p>
<p>So yes, that’s right. We don’t have to use pooled standard deviations to compute our standardized mean differences. If we have a good reference category, we could just use the sample estimate or population parameter for that, instead. Confusingly, you might see all these variants referred to as Cohen’s <span class="math inline">\(d\)</span> within the literature. As with all the other decisions you make with experimental design and data analysis, use carefully reasoning to decide on how you’d like to compute your effect sizes, report them transparently to your audience, and prepare yourself for a collegial debate with Reviewer #2.</p>
</div>
</div>
<div id="reference-18" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-18" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb1795"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1795-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] patchwork_1.0.0      tidybayes_2.0.1.9000 bayesplot_1.7.1      brms_2.11.5         
##  [5] Rcpp_1.0.3           ggridges_0.5.2       forcats_0.4.0        stringr_1.4.0       
##  [9] dplyr_0.8.4          purrr_0.3.3          readr_1.3.1          tidyr_1.0.2         
## [13] tibble_2.1.3         ggplot2_3.2.1        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ellipsis_0.3.0            rsconnect_0.8.16         
##   [4] markdown_1.1              base64enc_0.1-3           fs_1.3.1                 
##   [7] rstudioapi_0.10           farver_2.0.3              rstan_2.19.2             
##  [10] svUnit_0.7-12             DT_0.11                   fansi_0.4.1              
##  [13] mvtnorm_1.0-12            lubridate_1.7.4           xml2_1.2.2               
##  [16] bridgesampling_0.8-1      knitr_1.26                shinythemes_1.1.2        
##  [19] jsonlite_1.6.1            broom_0.5.3               dbplyr_1.4.2             
##  [22] shiny_1.4.0               compiler_3.6.2            httr_1.4.1               
##  [25] backports_1.1.5           assertthat_0.2.1          Matrix_1.2-18            
##  [28] fastmap_1.0.1             lazyeval_0.2.2            cli_2.0.1                
##  [31] later_1.0.0               htmltools_0.4.0           prettyunits_1.1.1        
##  [34] tools_3.6.2               igraph_1.2.4.2            coda_0.19-3              
##  [37] gtable_0.3.0              glue_1.3.1                reshape2_1.4.3           
##  [40] cellranger_1.1.0          vctrs_0.2.2               nlme_3.1-142             
##  [43] crosstalk_1.0.0           xfun_0.12                 ps_1.3.0                 
##  [46] rvest_0.3.5               mime_0.8                  miniUI_0.1.1.1           
##  [49] lifecycle_0.1.0           gtools_3.8.1              zoo_1.8-7                
##  [52] scales_1.1.0              colourpicker_1.0          hms_0.5.3                
##  [55] promises_1.1.0            Brobdingnag_1.2-6         parallel_3.6.2           
##  [58] inline_0.3.15             shinystan_2.5.0           yaml_2.2.1               
##  [61] gridExtra_2.3             StanHeaders_2.19.0        loo_2.2.0                
##  [64] stringi_1.4.5             dygraphs_1.1.1.6          pkgbuild_1.0.6           
##  [67] rlang_0.4.4               pkgconfig_2.0.3           matrixStats_0.55.0       
##  [70] HDInterval_0.2.0          evaluate_0.14             lattice_0.20-38          
##  [73] rstantools_2.0.0          htmlwidgets_1.5.1         labeling_0.3             
##  [76] tidyselect_1.0.0          processx_3.4.1            plyr_1.8.5               
##  [79] magrittr_1.5              R6_2.4.1                  generics_0.0.2           
##  [82] DBI_1.1.0                 pillar_1.4.3              haven_2.2.0              
##  [85] withr_2.1.2               xts_0.12-0                abind_1.4-5              
##  [88] modelr_0.1.5              crayon_1.3.4              arrayhelpers_1.0-20160527
##  [91] utf8_1.1.4                rmarkdown_2.0             grid_3.6.2               
##  [94] readxl_1.3.1              callr_3.4.1               threejs_0.3.3            
##  [97] reprex_0.3.0              digest_0.6.23             xtable_1.8-4             
## [100] httpuv_1.5.2              stats4_3.6.2              munsell_0.5.0            
## [103] viridisLite_0.3.0         shinyjs_1.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metric-predicted-variable-with-multiple-metric-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="metric-predicted-variable-with-multiple-nominal-predictors.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
