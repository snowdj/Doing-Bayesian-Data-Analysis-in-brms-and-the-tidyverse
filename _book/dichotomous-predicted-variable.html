<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>21 Dichotomous Predicted Variable | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="21 Dichotomous Predicted Variable | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="21 Dichotomous Predicted Variable | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="metric-predicted-variable-with-multiple-nominal-predictors.html"/>
<link rel="next" href="nominal-predicted-variable.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#weve-come-so-far"><i class="fa fa-check"></i>We’ve come so far!</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-20"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#reference-21"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#reference-22"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#reference-23"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reference-24"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dichotomous-predicted-variable" class="section level1">
<h1><span class="header-section-number">21</span> Dichotomous Predicted Variable</h1>
<blockquote>
<p>This chapter considers data structures that consist of a dichotomous predicted variable. The early chapters of the book were focused on this type of data, but now we reframe the analyses in terms of the generalized linear model…</p>
<p>The traditional treatment of these sorts of data structure is called “logistic regression.” In Bayesian software it is easy to generalize the traditional models so they are robust to outliers, allow different variances within levels of a nominal predictor, and have hierarchical structure to share information across levels or factors as appropriate. (pp. 621–622)</p>
</blockquote>
<div id="multiple-metric-predictors" class="section level2">
<h2><span class="header-section-number">21.1</span> Multiple metric predictors</h2>
<p>“We begin by considering a situation with multiple metric predictors, because this case makes it easiest to visualize the concepts of logistic regression” (p. 623).</p>
<p>Figure 21.1 is beyond the scope of our current <strong>ggplot2</strong> paradigm. But we will discuss an alternative in the end of section 21.1.2.</p>
<div id="the-model-and-implementation-in-jags-brms.-1" class="section level3">
<h3><span class="header-section-number">21.1.1</span> The model and implementation in <del>JAGS</del> brms.</h3>
<p>Our statistical model will follow the form</p>
<p><span class="math display">\[\begin{align*}
\mu &amp; = \operatorname{logistic} (\beta_0 + \beta_1 x_1 + \beta_2 x_2) \\
y &amp; \sim \operatorname{Bernoulli} (\mu)
\end{align*}\]</span></p>
<p>where</p>
<p><span class="math display">\[\operatorname{logistic} (x) = \frac{1}{(1 + \exp (-x))}.\]</span></p>
<p>The generic <strong>brms</strong> code for logistic regression using the Bernoulli likelihood looks like so.</p>
<div class="sourceCode" id="cb1905"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1905-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb1905-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1905-3" data-line-number="3">      <span class="dt">family =</span> bernoulli,</a>
<a class="sourceLine" id="cb1905-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2,</a>
<a class="sourceLine" id="cb1905-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1905-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)))</a></code></pre></div>
<p>Note that this syntax presumes the predictor variables have already been standardized.</p>
<p>We’d be remiss not to point out that you can also specify the model using the binomial distribution. That code would look like this.</p>
<div class="sourceCode" id="cb1906"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1906-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb1906-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1906-3" data-line-number="3">      <span class="dt">family =</span> binomial,</a>
<a class="sourceLine" id="cb1906-4" data-line-number="4">      y <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">1</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2,</a>
<a class="sourceLine" id="cb1906-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1906-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)))</a></code></pre></div>
<p>As long as the data are not aggregated, the results of these two should be the same within simulation variance. In <strong>brms</strong>, the default link for both <code>family = bernoulli</code> and <code>family = binomial</code> models is <code>logit</code>, which is exactly what we want, here. Also, note the additional <code>| trials(1)</code> syntax on the left side of the model formula. You could get away with omitting this in older versions of <strong>brms</strong>. But newer versions prompt users to specify how many of trials each row in the data represents. This is because, as with the baseball data we’ll use later in the chapter, the binomial distribution includes an <span class="math inline">\(n\)</span> parameter. When working with un-aggregated data like what we’re about to do, below, it’s presumed that <span class="math inline">\(n = 1\)</span>.</p>
</div>
<div id="example-height-weight-and-gender." class="section level3">
<h3><span class="header-section-number">21.1.2</span> Example: Height, weight, and gender.</h3>
<p>Load the height/weight data.</p>
<div class="sourceCode" id="cb1907"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1907-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1907-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1907-3" data-line-number="3">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/HtWtData110.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1907-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1907-5" data-line-number="5"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 110
## Variables: 3
## $ male   &lt;dbl&gt; 0, 0, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1…
## $ height &lt;dbl&gt; 63.2, 68.7, 64.8, 67.9, 68.9, 67.8, 68.2, 64.8, 64.3, 64.7, 66.9, 66.9, 67.1, 70.2…
## $ weight &lt;dbl&gt; 168.7, 169.8, 176.6, 246.8, 151.6, 158.0, 168.6, 137.2, 177.0, 128.0, 168.4, 136.2…</code></pre>
<p>Let’s standardize our predictors.</p>
<div class="sourceCode" id="cb1909"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1909-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb1909-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1909-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">height_z =</span> (height <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(height)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(height),</a>
<a class="sourceLine" id="cb1909-4" data-line-number="4">         <span class="dt">weight_z =</span> (weight <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(weight)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(weight))</a></code></pre></div>
<p>Before we fit a model, we might take a quick look at the data. The <code>ggMarginal()</code> function from the <a href="https://github.com/daattali/ggExtra"><strong>ggExtra</strong> package</a> will be of help, here.</p>
<div class="sourceCode" id="cb1910"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1910-1" data-line-number="1"><span class="co"># install.packages(&quot;ggExtra&quot;, dependencies = T)</span></a>
<a class="sourceLine" id="cb1910-2" data-line-number="2"><span class="kw">library</span>(ggExtra)</a></code></pre></div>
<p>Here we make a scatter plot with marginal densities.</p>
<div class="sourceCode" id="cb1911"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1911-1" data-line-number="1">p &lt;-</a>
<a class="sourceLine" id="cb1911-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1911-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> height, <span class="dt">fill =</span> male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1911-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>), </a>
<a class="sourceLine" id="cb1911-5" data-line-number="5">             <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1911-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;blue4&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1911-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;blue4&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1911-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb1911-9" data-line-number="9">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb1911-10" data-line-number="10">p <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1911-11" data-line-number="11"><span class="st">  </span><span class="kw">ggMarginal</span>(<span class="dt">data =</span> my_data,  </a>
<a class="sourceLine" id="cb1911-12" data-line-number="12">             <span class="dt">groupFill =</span> T,</a>
<a class="sourceLine" id="cb1911-13" data-line-number="13">             <span class="dt">type =</span> <span class="st">&#39;density&#39;</span>, </a>
<a class="sourceLine" id="cb1911-14" data-line-number="14">             <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /></p>
<p>Looks like the data for which <code>male == 1</code> are concentrated in the upper right and those for which <code>male == 0</code> are more so in the lower left. What we’d like is a model that would tell us the optimal dividing line(s) between our <code>male</code> categories with respect to those predictor variables.</p>
<p>Open <strong>brms</strong>.</p>
<div class="sourceCode" id="cb1912"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1912-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>Our first logistic model with <code>family = bernoulli</code> uses only <code>weight_z</code> as a predictor.</p>
<div class="sourceCode" id="cb1913"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1913-1" data-line-number="1">fit21<span class="fl">.1</span> &lt;-</a>
<a class="sourceLine" id="cb1913-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1913-3" data-line-number="3">      <span class="dt">family =</span> bernoulli,</a>
<a class="sourceLine" id="cb1913-4" data-line-number="4">      male <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>weight_z,</a>
<a class="sourceLine" id="cb1913-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1913-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb1913-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1913-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1913-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.01&quot;</span>)</a></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1914"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1914-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: male ~ 1 + weight_z 
##    Data: my_data (Number of observations: 110) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.08      0.21    -0.50     0.32 1.00     6358     5436
## weight_z      1.18      0.28     0.66     1.74 1.00     5678     4925
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Now let’s get ready to make our version of Figure 21.3. First, we need to do some <code>fitted()</code>-oriented wrangling.</p>
<div class="sourceCode" id="cb1916"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1916-1" data-line-number="1">length &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb1916-2" data-line-number="2">n_iter &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1916-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1916-4" data-line-number="4">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">weight_z =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-2</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length))</a>
<a class="sourceLine" id="cb1916-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1916-6" data-line-number="6">f &lt;-</a>
<a class="sourceLine" id="cb1916-7" data-line-number="7"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.1</span>,</a>
<a class="sourceLine" id="cb1916-8" data-line-number="8">         <span class="dt">newdata  =</span> nd,</a>
<a class="sourceLine" id="cb1916-9" data-line-number="9">         <span class="dt">summary  =</span> F,</a>
<a class="sourceLine" id="cb1916-10" data-line-number="10">         <span class="dt">nsamples =</span> n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1916-11" data-line-number="11"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1916-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span>n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1916-13" data-line-number="13"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1916-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight_z =</span> <span class="kw">rep</span>(nd<span class="op">$</span>weight_z, <span class="dt">times =</span> n_iter)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1916-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight =</span> weight_z <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight))</a>
<a class="sourceLine" id="cb1916-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1916-17" data-line-number="17"><span class="kw">head</span>(f)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##    iter name   value weight_z weight
##   &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 V1    0.0960    -2      87.0
## 2     1 V2    0.0985    -1.97   88.0
## 3     1 V3    0.101     -1.94   88.9
## 4     1 V4    0.104     -1.92   89.9
## 5     1 V5    0.106     -1.89   90.9
## 6     1 V6    0.109     -1.86   91.9</code></pre>
<p>Here’s a tricky way to get the threshold values.</p>
<div class="sourceCode" id="cb1918"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1918-1" data-line-number="1">thresholds &lt;-</a>
<a class="sourceLine" id="cb1918-2" data-line-number="2"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1918-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(value <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1918-4" data-line-number="4"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1918-5" data-line-number="5"><span class="st">  </span><span class="kw">filter</span>(value <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(value))</a></code></pre></div>
<p>Using those <code>thresholds</code>, here’s our version of the top panel of Figure 21.3.</p>
<div class="sourceCode" id="cb1919"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1919-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1919-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> thresholds<span class="op">$</span>weight, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> value, <span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1919-6" data-line-number="6">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1919-8" data-line-number="8">             <span class="kw">aes</span>(<span class="dt">y =</span> male),</a>
<a class="sourceLine" id="cb1919-9" data-line-number="9">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-10" data-line-number="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Post. Pred.&quot;</span>, </a>
<a class="sourceLine" id="cb1919-11" data-line-number="11">       <span class="dt">y =</span> <span class="st">&quot;male&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>weight)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1919-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-12-1.png" style="display: block; margin: auto;" /></p>
<p>We should discuss those thresholds (i.e., the verticla lines) a bit. Kruschke:</p>
<blockquote>
<p>The spread of the logistic curves indicates the uncertainty of the estimate; the steepness of the logistic curves indicates the magnitude of the regression coefficient. The 50% probability threshold is marked by arrows that drop down from the logistic curve to the <span class="math inline">\(x\)</span>-axis, near a weight of approximately 160 pounds. The threshold is the <span class="math inline">\(x\)</span> value at which <span class="math inline">\(\mu = 0.5\)</span>, which is <span class="math inline">\(x = -\beta_0 / \beta_1\)</span>. (p. 626)</p>
</blockquote>
<p>Now here we show the marginal distributions in our versions of the lower panels of Figure 21.3.</p>
<div class="sourceCode" id="cb1920"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1920-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb1920-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1920-3" data-line-number="3"><span class="co"># extract the draws</span></a>
<a class="sourceLine" id="cb1920-4" data-line-number="4">post &lt;-</a>
<a class="sourceLine" id="cb1920-5" data-line-number="5"><span class="st">  </span><span class="kw">posterior_samples</span>(fit21<span class="fl">.1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1920-6" data-line-number="6"><span class="st">  </span><span class="co"># convert the parameter draws to their natural metric following Equation 21.1</span></a>
<a class="sourceLine" id="cb1920-7" data-line-number="7"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> b_Intercept <span class="op">-</span><span class="st"> </span>(b_weight_z <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight)),</a>
<a class="sourceLine" id="cb1920-8" data-line-number="8">            <span class="dt">weight    =</span> b_weight_z <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1920-9" data-line-number="9"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>())</a>
<a class="sourceLine" id="cb1920-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1920-11" data-line-number="11"><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1920-12" data-line-number="12">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1920-13" data-line-number="13"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1920-14" data-line-number="14"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1920-15" data-line-number="15">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1920-16" data-line-number="16">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1920-17" data-line-number="17">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1920-18" data-line-number="18"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1920-19" data-line-number="19"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1920-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1920-21" data-line-number="21"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /></p>
<p>And here are those exact posterior mode and 95% HDI values.</p>
<div class="sourceCode" id="cb1921"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1921-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1921-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1921-3" data-line-number="3"><span class="st">  </span><span class="kw">mode_hdi</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1921-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   name       value .lower .upper .width .point .interval
##   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 Intercept -5.17  -7.78  -2.96    0.95 mode   hdi      
## 2 weight     0.033  0.018  0.048   0.95 mode   hdi</code></pre>
<p>Now fit the two-predictor model using both <code>weight_z</code> and <code>height_z</code></p>
<div class="sourceCode" id="cb1923"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1923-1" data-line-number="1">fit21<span class="fl">.2</span> &lt;-</a>
<a class="sourceLine" id="cb1923-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1923-3" data-line-number="3">      <span class="dt">family =</span> bernoulli,</a>
<a class="sourceLine" id="cb1923-4" data-line-number="4">      male <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>weight_z <span class="op">+</span><span class="st"> </span>height_z,</a>
<a class="sourceLine" id="cb1923-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1923-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb1923-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1923-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1923-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.02&quot;</span>)</a></code></pre></div>
<p>Here’s the model summary.</p>
<div class="sourceCode" id="cb1924"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1924-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: male ~ 1 + weight_z + height_z 
##    Data: my_data (Number of observations: 110) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.35      0.30    -0.97     0.21 1.00     5701     4430
## weight_z      0.67      0.35    -0.01     1.38 1.00     6570     5203
## height_z      2.62      0.51     1.71     3.71 1.00     5721     4092
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Before we make our plots for Figure 21.4, we’ll need to extract the posterior samples and transform a little.</p>
<div class="sourceCode" id="cb1926"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1926-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb1926-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit21<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1926-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">b_weight  =</span> b_weight_z <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight),</a>
<a class="sourceLine" id="cb1926-4" data-line-number="4">            <span class="dt">b_height  =</span> b_height_z <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>height),</a>
<a class="sourceLine" id="cb1926-5" data-line-number="5">            <span class="dt">Intercept =</span> b_Intercept <span class="op">-</span><span class="st"> </span>((b_weight_z <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1926-6" data-line-number="6"><span class="st">                                         </span>(b_height_z <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>height) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>height))))</a>
<a class="sourceLine" id="cb1926-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1926-8" data-line-number="8"><span class="kw">head</span>(post)</a></code></pre></div>
<pre><code>##      b_weight  b_height Intercept
## 1 0.018166700 0.7321485 -51.60400
## 2 0.019467097 0.4831885 -35.37444
## 3 0.011662826 0.9272223 -64.27622
## 4 0.007602754 1.0011093 -68.24517
## 5 0.003033513 0.8470679 -57.08786
## 6 0.029017547 0.5890523 -44.33986</code></pre>
<p>Here’s our version of Figure 21.4.a.</p>
<div class="sourceCode" id="cb1928"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1928-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">21</span>)  <span class="co"># we need this for the `sample_n()` function</span></a>
<a class="sourceLine" id="cb1928-2" data-line-number="2">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1928-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1928-4" data-line-number="4"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1928-5" data-line-number="5"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(iter, Intercept, b_weight, b_height),</a>
<a class="sourceLine" id="cb1928-6" data-line-number="6">         <span class="dt">weight =</span> <span class="kw">c</span>(<span class="dv">80</span>, <span class="dv">280</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1928-7" data-line-number="7"><span class="st">  </span><span class="co"># this follows the Equation near the top of p. 629</span></a>
<a class="sourceLine" id="cb1928-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">height =</span> (<span class="op">-</span>Intercept <span class="op">/</span><span class="st"> </span>b_height) <span class="op">+</span><span class="st"> </span>(<span class="op">-</span>b_weight <span class="op">/</span><span class="st"> </span>b_height) <span class="op">*</span><span class="st"> </span>weight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1928-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1928-10" data-line-number="10"><span class="st">  </span><span class="co"># now plot</span></a>
<a class="sourceLine" id="cb1928-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1928-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1928-13" data-line-number="13">            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1928-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1928-15" data-line-number="15">            <span class="kw">aes</span>(<span class="dt">label =</span> male, <span class="dt">color =</span> male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1928-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;blue4&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1928-17" data-line-number="17"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with Post. Pred.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1928-18" data-line-number="18"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>weight),</a>
<a class="sourceLine" id="cb1928-19" data-line-number="19">                  <span class="dt">ylim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1928-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb1928-21" data-line-number="21">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-17-1.png" style="display: block; margin: auto;" /></p>
<p>With just a tiny bit more wrangling, we’ll be ready to make the bottom panels of Figure 21.4.</p>
<div class="sourceCode" id="cb1929"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1929-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1929-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1929-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(<span class="kw">str_remove</span>(name, <span class="st">&quot;b_&quot;</span>),</a>
<a class="sourceLine" id="cb1929-4" data-line-number="4">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;height&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1929-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1929-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1929-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1929-8" data-line-number="8">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1929-9" data-line-number="9">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1929-10" data-line-number="10">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1929-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1929-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1929-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1929-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /></p>
<p>By now, you know how to use <code>mode_hdi()</code> to return those exact summary values if you’d like them.</p>
<p>Now remember how we backed away from Figure 21.1? Well, when you have a logistic regression with two predictors, there is a reasonable way to express those three dimensions on a two-dimensional grid. Now we have the results from <code>fit21.2</code>, let’s try it out.</p>
<p>First, we need a grid of values for our two predictors, <code>weight_z</code> and <code>height_z</code>.</p>
<div class="sourceCode" id="cb1930"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1930-1" data-line-number="1">length &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1930-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1930-3" data-line-number="3">nd &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1930-4" data-line-number="4"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">weight_z =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length),</a>
<a class="sourceLine" id="cb1930-5" data-line-number="5">           <span class="dt">height_z =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length))</a></code></pre></div>
<p>Second, we plug those values into <code>fitted()</code> and wrangle.</p>
<div class="sourceCode" id="cb1931"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1931-1" data-line-number="1">f &lt;-</a>
<a class="sourceLine" id="cb1931-2" data-line-number="2"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.2</span>,</a>
<a class="sourceLine" id="cb1931-3" data-line-number="3">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1931-4" data-line-number="4">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1931-5" data-line-number="5"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1931-6" data-line-number="6"><span class="st">  </span><span class="co"># note we&#39;re only working with the posterior mean, here</span></a>
<a class="sourceLine" id="cb1931-7" data-line-number="7"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">prob =</span> Estimate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv_logit_scaled</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1931-8" data-line-number="8"><span class="st">  </span><span class="kw">bind_cols</span>(nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1931-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight =</span> (weight_z <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight)),</a>
<a class="sourceLine" id="cb1931-10" data-line-number="10">         <span class="dt">height =</span> (height_z <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>height) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>height)))</a>
<a class="sourceLine" id="cb1931-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1931-12" data-line-number="12"><span class="kw">glimpse</span>(f)</a></code></pre></div>
<pre><code>## Observations: 10,000
## Variables: 5
## $ prob     &lt;dbl&gt; 7.096100e-06, 8.540527e-06, 1.027897e-05, 1.237127e-05, 1.488945e-05, 1.792021e-…
## $ weight_z &lt;dbl&gt; -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3.5, -3…
## $ height_z &lt;dbl&gt; -3.500000, -3.429293, -3.358586, -3.287879, -3.217172, -3.146465, -3.075758, -3.…
## $ weight   &lt;dbl&gt; 33.45626, 33.45626, 33.45626, 33.45626, 33.45626, 33.45626, 33.45626, 33.45626, …
## $ height   &lt;dbl&gt; 53.24736, 53.51234, 53.77731, 54.04229, 54.30727, 54.57224, 54.83722, 55.10219, …</code></pre>
<p>Third, we’re ready to plot. Here we’ll express the third dimension, probability, on a color spectrum.</p>
<div class="sourceCode" id="cb1933"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1933-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1933-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> prob),</a>
<a class="sourceLine" id="cb1933-4" data-line-number="4">              <span class="dt">interpolate =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1933-6" data-line-number="6">            <span class="kw">aes</span>(<span class="dt">label =</span> male, <span class="dt">color =</span> male <span class="op">==</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1933-7" data-line-number="7">            <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">begin =</span> <span class="fl">.1</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">position =</span> <span class="st">&quot;right&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>weight),</a>
<a class="sourceLine" id="cb1933-12" data-line-number="12">                  <span class="dt">ylim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>height)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1933-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;left&quot;</span>)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /></p>
<p>If you look way back to Figure 21.1 (p. 623), you’ll see the following formula at the top:</p>
<p><span class="math display">\[y \sim \operatorname{dbern} (m), m = \operatorname{logistic} (0.018 x_1 + 0.7 x_2 - 50).\]</span></p>
<p>Now while you keep your finger on that equation, take another look at the last line in Kruschke’s Equation 21.1,</p>
<p><span class="math display">\[
\operatorname{logit} (\mu) = 
\underbrace{\zeta_0 - \sum_j \frac{\zeta_j}{s_{x_j}} \overline x_j}_{\beta_0} +
\sum_j \underbrace{\frac{\zeta_j}{s_{x_j}} \overline x_j}_{\beta_j},
\]</span></p>
<p>where the <span class="math inline">\(\zeta\)</span>s are the parameters from the model based on standardized predictors. Our <code>fit21.2</code> was based on standardized <code>weight</code> and <code>height</code> values (i.e., <code>weight_z</code> and <code>height_z</code>), yielding model coefficients in the <span class="math inline">\(\zeta\)</span> metric. Here we use the formula above to convert our <code>fit21.2</code> estimates to their unstandardized <span class="math inline">\(\beta\)</span> metric. For simplicity, we’ll just take their means.</p>
<div class="sourceCode" id="cb1934"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1934-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit21<span class="fl">.2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1934-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">beta_0 =</span> b_Intercept <span class="op">-</span><span class="st"> </span>((b_weight_z <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1934-3" data-line-number="3"><span class="st">                                      </span>((b_height_z <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>height) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>height)))),</a>
<a class="sourceLine" id="cb1934-4" data-line-number="4">            <span class="dt">beta_1 =</span> b_weight_z <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight),</a>
<a class="sourceLine" id="cb1934-5" data-line-number="5">            <span class="dt">beta_2 =</span> b_height_z <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>height)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1934-6" data-line-number="6"><span class="st">  </span><span class="kw">summarise_all</span>(<span class="op">~</span><span class="kw">mean</span>(.) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(., <span class="dt">digits =</span> <span class="dv">3</span>))</a></code></pre></div>
<pre><code>##    beta_0 beta_1 beta_2
## 1 -49.713  0.019  0.699</code></pre>
<p>Within rounding error, those values are the same ones in the formula at the top of Kruschke’s Figure 21.1! That is, our last plot was a version of Figure 21.1.</p>
<p>Hopefully this helps make sense of what the thresholds in Figure 21.4.a represented. But do note a major limitation of this visualization approach. By expressing the threshold with multiple lines drawn from the posterior in Figure 21.4.a, we expressed the uncertainty inherent in the posterior distribution. However, for this probability plane approach, we’ve taken a single value from the posterior, the mean (i.e., the <code>Estimate</code>), to compute the probabilities. Though beautiful, our probability-plane plot does a poor job expressing the uncertainty in the model. If you’re curious how one might include uncertainty into a plot like this, check out the intriguing blog post by Adam Pearce, <a href="https://pair-code.github.io/interpretability/uncertainty-over-space/"><em>Communicating Model Uncertainty Over Space</em></a>.</p>
</div>
</div>
<div id="interpreting-the-regression-coefficients" class="section level2">
<h2><span class="header-section-number">21.2</span> Interpreting the regression coefficients</h2>
<blockquote>
<p>In this section, I’ll discuss how to interpret the parameters in logistic regression. The first subsection explains how to interpret the numerical magnitude of the slope coefficients in terms of “log odds.” The next subsection shows how data with relatively few 1’s or 0’s can yield ambiguity in the parameter estimates. Then an example with strongly correlated predictors reveals tradeoffs in slope coefficients. Finally, I briefly describe the meaning of multiplicative interaction for logistic regression. (p. 629)</p>
</blockquote>
<div id="log-odds." class="section level3">
<h3><span class="header-section-number">21.2.1</span> Log odds.</h3>
<blockquote>
<p>When the logistic regression formula is written using the logit function, we have <span class="math inline">\(\operatorname{logit} (\mu) = \beta_0 + \beta_1 x_1 + \beta_2 x_2\)</span>. The formula implies that whenever <span class="math inline">\(x_1\)</span> goes up by 1 unit (on the <span class="math inline">\(x_1\)</span> scale), then <span class="math inline">\(\operatorname{logit} (\mu)\)</span> goes up by an amount <span class="math inline">\(\beta_1\)</span>. And whenever <span class="math inline">\(x_2\)</span> goes up by 1 unit (on the <span class="math inline">\(x_2\)</span> scale), then <span class="math inline">\(\operatorname{logit} (\mu)\)</span> goes up by an amount <span class="math inline">\(\beta_2\)</span>. Thus, the regression coefficients are telling us about increases in <span class="math inline">\(\operatorname{logit} (\mu)\)</span>. To understand the regression coefficients, we need to understand <span class="math inline">\(\operatorname{logit} (\mu)\)</span>. (pp. 629–630)</p>
</blockquote>
<p>Given the logit function is the inverse of the logistic, which itself is</p>
<p><span class="math display">\[\operatorname{logistic} (x) = \frac{1}{1 + \exp (−x)},\]</span></p>
<p>and given the formula</p>
<p><span class="math display">\[\operatorname{logit} (\mu) = \log \bigg (\frac{\mu}{1 - \mu} \bigg), \]</span></p>
<p>where</p>
<p><span class="math display">\[0 &lt; \mu &lt; 1, \]</span></p>
<p>it may or may not be clear that the results of our logistic regression models have a nonlinear relation with the actual parameter of interest, <span class="math inline">\(\mu\)</span>, which, recall, is the probability our criterion variable is 1 (e.g., <code>male == 1</code>). To get a sense of that nonlinear relation, we might make a plot.</p>
<div class="sourceCode" id="cb1936"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1936-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">mu =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1936-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">logit_mu =</span> <span class="kw">log</span>(mu <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1936-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1936-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> mu, <span class="dt">y =</span> logit_mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1936-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb1936-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(mu<span class="op">~</span><span class="st">&quot;(i.e., the probability space)&quot;</span>),</a>
<a class="sourceLine" id="cb1936-7" data-line-number="7">       <span class="dt">y =</span> <span class="kw">expression</span>(logit<span class="op">~</span>mu<span class="op">~</span><span class="st">&quot;(i.e., the parameter space)&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1936-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb1936-9" data-line-number="9">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /></p>
<p>So whereas our probability space is bound between 0 and 1, the parameter space shoots off into negative and positive infinity. Also,</p>
<p><span class="math display">\[\operatorname{logit} (\mu) = \log \Bigg (\frac{p(y = 1)}{p(y = 0)} \Bigg ).\]</span></p>
<p>Thus, “the ratio, <span class="math inline">\(p(y = 1) / p(y = 0)\)</span>, is called the odds of outcome 1 to outcome 0, and therefore <span class="math inline">\(\operatorname{logit} (\mu)\)</span> is the log odds of outcome 1 to outcome 0” (p. 630).</p>
<p>Here’s a table layout of the height/weight examples in the middle of page 630.</p>
<div class="sourceCode" id="cb1937"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1937-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">b0     =</span> <span class="dv">-50</span>,</a>
<a class="sourceLine" id="cb1937-2" data-line-number="2">       <span class="dt">b1     =</span> <span class="fl">.02</span>,</a>
<a class="sourceLine" id="cb1937-3" data-line-number="3">       <span class="dt">b2     =</span> <span class="fl">.7</span>,</a>
<a class="sourceLine" id="cb1937-4" data-line-number="4">       <span class="dt">weight =</span> <span class="dv">160</span>,</a>
<a class="sourceLine" id="cb1937-5" data-line-number="5">       <span class="dt">inches =</span> <span class="kw">c</span>(<span class="dv">63</span><span class="op">:</span><span class="dv">64</span>, <span class="dv">67</span><span class="op">:</span><span class="dv">68</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1937-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">logit_mu =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>weight <span class="op">+</span><span class="st"> </span>b2 <span class="op">*</span><span class="st"> </span>inches) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1937-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">log_odds =</span> logit_mu) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1937-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">p_male =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>log_odds))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1937-9" data-line-number="9"><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>()</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">b0</th>
<th align="right">b1</th>
<th align="right">b2</th>
<th align="right">weight</th>
<th align="right">inches</th>
<th align="right">logit_mu</th>
<th align="right">log_odds</th>
<th align="right">p_male</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-50</td>
<td align="right">0.02</td>
<td align="right">0.7</td>
<td align="right">160</td>
<td align="right">63</td>
<td align="right">-2.7</td>
<td align="right">-2.7</td>
<td align="right">0.0629734</td>
</tr>
<tr class="even">
<td align="right">-50</td>
<td align="right">0.02</td>
<td align="right">0.7</td>
<td align="right">160</td>
<td align="right">64</td>
<td align="right">-2.0</td>
<td align="right">-2.0</td>
<td align="right">0.1192029</td>
</tr>
<tr class="odd">
<td align="right">-50</td>
<td align="right">0.02</td>
<td align="right">0.7</td>
<td align="right">160</td>
<td align="right">67</td>
<td align="right">0.1</td>
<td align="right">0.1</td>
<td align="right">0.5249792</td>
</tr>
<tr class="even">
<td align="right">-50</td>
<td align="right">0.02</td>
<td align="right">0.7</td>
<td align="right">160</td>
<td align="right">68</td>
<td align="right">0.8</td>
<td align="right">0.8</td>
<td align="right">0.6899745</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Thus, a regression coefficient in logistic regression indicates how much a 1 unit change of the predictor increases the log odds of outcome 1. A regression coefficient of 0.5 corresponds to a rate of probability change of about 12.5 percentage points per <span class="math inline">\(x\)</span>-unit at the threshold <span class="math inline">\(x\)</span> value. A regression coefficient of 1.0 corresponds to a rate of probability change of about 24.4 percentage points per <span class="math inline">\(x\)</span>-unit at the threshold <span class="math inline">\(x\)</span> value. When <span class="math inline">\(x\)</span> is much larger or smaller than the threshold <span class="math inline">\(x\)</span> value, the rate of change in probability is smaller, even though the rate of change in log odds is constant. (pp. 630–631)</p>
</blockquote>
</div>
<div id="when-there-are-few-1s-or-0s-in-the-data." class="section level3">
<h3><span class="header-section-number">21.2.2</span> When there are few 1’s or 0’s in the data.</h3>
<blockquote>
<p>In logistic regression, you can think of the parameters as describing the boundary between the 0’s and the 1’s. If there are many 0’s and 1’s, then the estimate of the boundary parameters can be fairly accurate. But if there are few 0’s or few 1’s, the boundary can be difficult to identify very accurately, even if there are many data points overall. (p. 631)</p>
</blockquote>
<p>As far as I can tell, Kruschke must have used <span class="math inline">\(n = 500\)</span> to simulate the data he displayed in Figure 21.5. Using the coefficient values he displayed in the middle of page 631, here’s an attempt at replicating them.</p>
<div class="sourceCode" id="cb1938"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1938-1" data-line-number="1">b0 &lt;-<span class="st"> </span><span class="dv">-3</span></a>
<a class="sourceLine" id="cb1938-2" data-line-number="2">b1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1938-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1938-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1938-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1938-6" data-line-number="6"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1938-7" data-line-number="7">d_rare &lt;-</a>
<a class="sourceLine" id="cb1938-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1938-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1938-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>mu))))</a>
<a class="sourceLine" id="cb1938-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1938-12" data-line-number="12"><span class="kw">glimpse</span>(d_rare)</a></code></pre></div>
<pre><code>## Observations: 500
## Variables: 3
## $ x  &lt;dbl&gt; 0.793013171, 0.522251264, 1.746222241, -1.271336123, 2.197389533, 0.433130777, -1.5701…
## $ mu &lt;dbl&gt; -2.2069868, -2.4777487, -1.2537778, -4.2713361, -0.8026105, -2.5668692, -4.5701996, -3…
## $ y  &lt;int&gt; 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0,…</code></pre>
<p>We’re ready to fit the model. So far, we’ve been following along with Kruschke by using the Bernoulli distribution (i.e., <code>family = bernoulli</code>) in our <strong>brms</strong> models. Let’s get frisky and use the <span class="math inline">\(n = 1\)</span> binomial distribution, here. You’ll see it yields the same results.</p>
<div class="sourceCode" id="cb1940"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1940-1" data-line-number="1">fit21<span class="fl">.3</span> &lt;-</a>
<a class="sourceLine" id="cb1940-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> d_rare, </a>
<a class="sourceLine" id="cb1940-3" data-line-number="3">      <span class="dt">family =</span> binomial,</a>
<a class="sourceLine" id="cb1940-4" data-line-number="4">      y <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">1</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb1940-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1940-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb1940-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1940-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1940-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.03&quot;</span>)</a></code></pre></div>
<p>Recall that when you use the binomial distribution in newer versions of <strong>brms</strong>, you need to use the <code>trials()</code> syntax to tell <code>brm()</code> how many trials each row in the data corresponds to. Anyway, behold the summary.</p>
<div class="sourceCode" id="cb1941"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1941-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: y | trials(1) ~ 1 + x 
##    Data: d_rare (Number of observations: 500) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -3.01      0.24    -3.50    -2.56 1.00     2895     3993
## x             1.03      0.20     0.63     1.43 1.00     3047     3790
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Looks like the model did a good job recapturing those data-generating <code>b0</code> and <code>b1</code> values. Here’s the preparatory work to needed before we can make our version of the main plot in Figure 21.5.a.</p>
<div class="sourceCode" id="cb1943"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1943-1" data-line-number="1"><span class="co"># unclear if Kruschke still used 20 draws or not</span></a>
<a class="sourceLine" id="cb1943-2" data-line-number="2"><span class="co"># perhaps play with `n_iter` values.</span></a>
<a class="sourceLine" id="cb1943-3" data-line-number="3">n_iter &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb1943-4" data-line-number="4">length &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1943-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1943-6" data-line-number="6">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length))</a>
<a class="sourceLine" id="cb1943-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1943-8" data-line-number="8"><span class="co"># these will make the logistic curves</span></a>
<a class="sourceLine" id="cb1943-9" data-line-number="9"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1943-10" data-line-number="10">f &lt;-</a>
<a class="sourceLine" id="cb1943-11" data-line-number="11"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb1943-12" data-line-number="12">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1943-13" data-line-number="13">         <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb1943-14" data-line-number="14">         <span class="dt">nsamples =</span> n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1943-15" data-line-number="15"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1943-16" data-line-number="16"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(), </a>
<a class="sourceLine" id="cb1943-17" data-line-number="17">               <span class="dt">values_to =</span> <span class="st">&quot;y&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1943-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(nd<span class="op">$</span>x, <span class="dt">times =</span> n_iter),</a>
<a class="sourceLine" id="cb1943-19" data-line-number="19">         <span class="dt">iter =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n_iter, <span class="dt">each =</span> length))</a>
<a class="sourceLine" id="cb1943-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1943-21" data-line-number="21"><span class="co"># Here&#39;s just a little more work to get the thresholds</span></a>
<a class="sourceLine" id="cb1943-22" data-line-number="22">thresholds &lt;-</a>
<a class="sourceLine" id="cb1943-23" data-line-number="23"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1943-24" data-line-number="24"><span class="st">  </span><span class="kw">filter</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1943-25" data-line-number="25"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1943-26" data-line-number="26"><span class="st">  </span><span class="kw">filter</span>(y <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(y))</a></code></pre></div>
<p>We’re ready to plot the top left panel of Figure 21.5.</p>
<div class="sourceCode" id="cb1944"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1944-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb1944-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> thresholds<span class="op">$</span>x, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1944-6" data-line-number="6">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> d_rare,</a>
<a class="sourceLine" id="cb1944-8" data-line-number="8">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-10" data-line-number="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with Post. Pred.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1944-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /></p>
<p>Here are the two subplots at the bottom, left.</p>
<div class="sourceCode" id="cb1945"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1945-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit21<span class="fl">.3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1945-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1945-3" data-line-number="3">            <span class="dt">x         =</span> b_x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1945-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1945-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb1945-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1945-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1945-8" data-line-number="8">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1945-9" data-line-number="9">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1945-10" data-line-number="10">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1945-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1945-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1945-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1945-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-29-1.png" style="display: block; margin: auto;" /></p>
<p>Since our data were simulated without the benefit of knowing how Kruschke set his seed and such, our results will only approximate those in the text.</p>
<p>Okay, now we need to simulate the complimentary data, those for which <span class="math inline">\(y = 1\)</span> is a less-rare event.</p>
<div class="sourceCode" id="cb1946"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1946-1" data-line-number="1">b0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1946-2" data-line-number="2">b1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1946-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1946-4" data-line-number="4">n &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1946-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1946-6" data-line-number="6"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1946-7" data-line-number="7">d_not_rare &lt;-</a>
<a class="sourceLine" id="cb1946-8" data-line-number="8"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x  =</span> <span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1946-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1946-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y  =</span> <span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>mu))))</a>
<a class="sourceLine" id="cb1946-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1946-12" data-line-number="12"><span class="kw">glimpse</span>(d_not_rare)</a></code></pre></div>
<pre><code>## Observations: 500
## Variables: 3
## $ x  &lt;dbl&gt; 0.793013171, 0.522251264, 1.746222241, -1.271336123, 2.197389533, 0.433130777, -1.5701…
## $ mu &lt;dbl&gt; 0.793013171, 0.522251264, 1.746222241, -1.271336123, 2.197389533, 0.433130777, -1.5701…
## $ y  &lt;int&gt; 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 1,…</code></pre>
<p>Fitting this model is just like before.</p>
<div class="sourceCode" id="cb1948"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1948-1" data-line-number="1">fit21<span class="fl">.4</span> &lt;-</a>
<a class="sourceLine" id="cb1948-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit21<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb1948-3" data-line-number="3">         <span class="dt">newdata =</span> d_not_rare,</a>
<a class="sourceLine" id="cb1948-4" data-line-number="4">         <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1948-5" data-line-number="5">         <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1948-6" data-line-number="6">         <span class="dt">file =</span> <span class="st">&quot;fits/fit21.04&quot;</span>)</a></code></pre></div>
<p>Behold the summary.</p>
<div class="sourceCode" id="cb1949"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1949-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.4</span>)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: y | trials(1) ~ 1 + x 
##    Data: d_not_rare (Number of observations: 500) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     0.08      0.10    -0.11     0.27 1.00     6945     5664
## x             0.91      0.11     0.69     1.13 1.00     6688     5234
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here’s the code for the main plot in Figure 21.5.b.</p>
<div class="sourceCode" id="cb1951"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1951-1" data-line-number="1">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length))</a>
<a class="sourceLine" id="cb1951-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1951-3" data-line-number="3"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1951-4" data-line-number="4">f &lt;-</a>
<a class="sourceLine" id="cb1951-5" data-line-number="5"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.4</span>,</a>
<a class="sourceLine" id="cb1951-6" data-line-number="6">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1951-7" data-line-number="7">         <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb1951-8" data-line-number="8">         <span class="dt">nsamples =</span> n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1951-9" data-line-number="9"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1951-10" data-line-number="10"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(), </a>
<a class="sourceLine" id="cb1951-11" data-line-number="11">               <span class="dt">values_to =</span> <span class="st">&quot;y&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1951-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x    =</span> <span class="kw">rep</span>(nd<span class="op">$</span>x, <span class="dt">times =</span> n_iter),</a>
<a class="sourceLine" id="cb1951-13" data-line-number="13">         <span class="dt">iter =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n_iter, <span class="dt">each =</span> length))</a>
<a class="sourceLine" id="cb1951-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1951-15" data-line-number="15">thresholds &lt;-</a>
<a class="sourceLine" id="cb1951-16" data-line-number="16"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1951-17" data-line-number="17"><span class="st">  </span><span class="kw">filter</span>(y <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1951-18" data-line-number="18"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1951-19" data-line-number="19"><span class="st">  </span><span class="kw">filter</span>(y <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(y))</a>
<a class="sourceLine" id="cb1951-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1951-21" data-line-number="21">p1 &lt;-</a>
<a class="sourceLine" id="cb1951-22" data-line-number="22"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb1951-23" data-line-number="23"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> thresholds<span class="op">$</span>x, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-26" data-line-number="26"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1951-27" data-line-number="27">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-28" data-line-number="28"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> d_not_rare,</a>
<a class="sourceLine" id="cb1951-29" data-line-number="29">             <span class="kw">aes</span>(<span class="dt">y =</span> y),</a>
<a class="sourceLine" id="cb1951-30" data-line-number="30">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-31" data-line-number="31"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with Post. Pred.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-32" data-line-number="32"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1951-33" data-line-number="33"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p>Now make the two subplots at the bottom.</p>
<div class="sourceCode" id="cb1952"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1952-1" data-line-number="1">p2 &lt;-</a>
<a class="sourceLine" id="cb1952-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit21<span class="fl">.4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1952-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> b_Intercept,</a>
<a class="sourceLine" id="cb1952-4" data-line-number="4">            <span class="dt">x         =</span> b_x) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1952-5" data-line-number="5"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1952-6" data-line-number="6"><span class="st">  </span></a>
<a class="sourceLine" id="cb1952-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1952-8" data-line-number="8"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1952-9" data-line-number="9">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1952-10" data-line-number="10">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1952-11" data-line-number="11">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1952-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1952-13" data-line-number="13"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1952-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1952-15" data-line-number="15"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p>This time we’ll combine them with <strong>patchwork</strong>.</p>
<div class="sourceCode" id="cb1953"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1953-1" data-line-number="1"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb1953-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1953-3" data-line-number="3">p3 &lt;-<span class="st"> </span><span class="kw">plot_spacer</span>()</a>
<a class="sourceLine" id="cb1953-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1953-5" data-line-number="5">p1 <span class="op">/</span><span class="st"> </span>(p2 <span class="op">+</span><span class="st"> </span>p3 <span class="op">+</span><span class="st"> </span><span class="kw">plot_layout</span>(<span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb1953-6" data-line-number="6"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-34-1.png" style="display: block; margin: auto;" /></p>
<blockquote>
<p>You can see in Figure 21.5 that the estimate of the slope (and of the intercept) is more certain in the right panel than in the left panel. The 95% HDI on the slope, <span class="math inline">\(\beta_1\)</span>, is much wider in the left panel than in the right panel, and you can see that the logistic curves in the left panel have greater variation in steepness than the logistic curves in the right panel. The analogous statements hold true for the intercept parameter.</p>
<p>Thus, if you are doing an experimental study and you can manipulate the <span class="math inline">\(x\)</span> values, you will want to select <span class="math inline">\(x\)</span> values that yield about equal numbers of 0’s and 1’s for the <span class="math inline">\(y\)</span> values overall. If you are doing an observational study, such that you cannot control any independent variables, then you should be aware that the parameter estimates may be surprisingly ambiguous if your data have only a small proportion of 0’s or 1’s. (pp. 631–632)</p>
</blockquote>
</div>
<div id="correlated-predictors." class="section level3">
<h3><span class="header-section-number">21.2.3</span> Correlated predictors.</h3>
<p>“Another important cause of parameter uncertainty is correlated predictors. This issue was previously discussed at length, but the context of logistic regression provides novel illustration in terms of level contours” (p. 632).</p>
<p>As far as I can tell, Kruschke chose about <span class="math inline">\(n = 200\)</span> for the data in this example. After messing around with correlations for a bit, it seems <span class="math inline">\(\rho_{x_1, x_2} = .975\)</span> looks about right. To my knowledge, the best way to simulate multivariate Gaussian data with a particular correlation is with the <a href="https://www.rdocumentation.org/packages/MASS/versions/7.3-51.1/topics/mvrnorm"><code>MASS::mvrnorm()</code> function</a>. Since we’ll be using standardized <span class="math inline">\(x\)</span>-variables, we’ll need to specify our <span class="math inline">\(n\)</span>, the desired correlation matrix, and a vector of means. Then we’ll be ready to do the actual simulation with <code>mvrnorm()</code>.</p>
<div class="sourceCode" id="cb1954"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1954-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb1954-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1954-3" data-line-number="3"><span class="co"># correlation matrix</span></a>
<a class="sourceLine" id="cb1954-4" data-line-number="4">s &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.975</span>, </a>
<a class="sourceLine" id="cb1954-5" data-line-number="5">              <span class="fl">.975</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb1954-6" data-line-number="6">            <span class="dt">nrow =</span> <span class="dv">2</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1954-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1954-8" data-line-number="8"><span class="co"># mean vector</span></a>
<a class="sourceLine" id="cb1954-9" data-line-number="9">m &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb1954-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1954-11" data-line-number="11"><span class="co"># simulate</span></a>
<a class="sourceLine" id="cb1954-12" data-line-number="12"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1954-13" data-line-number="13">d &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1954-14" data-line-number="14"><span class="st">  </span>MASS<span class="op">::</span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> n, <span class="dt">mu =</span> m, <span class="dt">Sigma =</span> s) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1954-15" data-line-number="15"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1954-16" data-line-number="16"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">str_c</span>(<span class="st">&quot;x&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>))</a></code></pre></div>
<p>Let’s confirm the correlation coefficient.</p>
<div class="sourceCode" id="cb1955"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1955-1" data-line-number="1"><span class="kw">cor</span>(d)</a></code></pre></div>
<pre><code>##           x1        x2
## x1 1.0000000 0.9730091
## x2 0.9730091 1.0000000</code></pre>
<p>Solid. Now we’ll use the <span class="math inline">\(\beta\)</span> values from page 633 to simulate the data set by including our dichotomous criterion variable, <code>y</code>.</p>
<div class="sourceCode" id="cb1957"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1957-1" data-line-number="1">b0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1957-2" data-line-number="2">b1 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1957-3" data-line-number="3">b2 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb1957-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1957-5" data-line-number="5"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1957-6" data-line-number="6">d &lt;-</a>
<a class="sourceLine" id="cb1957-7" data-line-number="7"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1957-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>b2 <span class="op">*</span><span class="st"> </span>x2) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1957-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>mu))))</a></code></pre></div>
<p>Fit the model with the highly-correlated predictors.</p>
<div class="sourceCode" id="cb1958"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1958-1" data-line-number="1">fit21<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb1958-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> d, </a>
<a class="sourceLine" id="cb1958-3" data-line-number="3">      <span class="dt">family =</span> binomial,</a>
<a class="sourceLine" id="cb1958-4" data-line-number="4">      y <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(<span class="dv">1</span>) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2,</a>
<a class="sourceLine" id="cb1958-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1958-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb1958-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1958-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1958-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.05&quot;</span>)</a></code></pre></div>
<p>Behold the summary.</p>
<div class="sourceCode" id="cb1959"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1959-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: y | trials(1) ~ 1 + x1 + x2 
##    Data: d (Number of observations: 200) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.04      0.18    -0.39     0.31 1.00     4473     3670
## x1           -0.05      0.72    -1.45     1.35 1.00     3422     3386
## x2            2.07      0.78     0.61     3.64 1.00     3461     3472
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>We did a good job recapturing Kruschke’s <span class="math inline">\(\beta\)</span>s in terms of our posterior means, but notice how large those posterior <span class="math inline">\(SD\)</span>s are for <span class="math inline">\(\beta_1\)</span> and <span class="math inline">\(\beta_2\)</span>. To get a better sense, let’s look at them in a coefficient plot before continuing on with the text.</p>
<div class="sourceCode" id="cb1961"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1961-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit21<span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1961-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>lp__) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1961-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1961-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1961-5" data-line-number="5"><span class="st">  </span><span class="kw">stat_gradientintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="fl">.95</span>), <span class="dt">fill =</span> <span class="st">&quot;grey25&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1961-6" data-line-number="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1961-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1961-8" data-line-number="8">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1961-9" data-line-number="9">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-39-1.png" style="display: block; margin: auto;" /></p>
<p>Them are some sloppy estimates! But we digress. Here’s our version of Figure 21.6.a.</p>
<div class="sourceCode" id="cb1962"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1962-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">21</span>)  <span class="co"># we need this for the `sample_n()` function</span></a>
<a class="sourceLine" id="cb1962-2" data-line-number="2"><span class="kw">posterior_samples</span>(fit21<span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1962-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1962-4" data-line-number="4"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1962-5" data-line-number="5"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(iter, b_Intercept, b_x1, b_x2),</a>
<a class="sourceLine" id="cb1962-6" data-line-number="6">         <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1962-7" data-line-number="7"><span class="st">  </span><span class="co"># this follows the equation near the top of p. 629</span></a>
<a class="sourceLine" id="cb1962-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x2 =</span> (<span class="op">-</span>b_Intercept <span class="op">/</span><span class="st"> </span>b_x2) <span class="op">+</span><span class="st"> </span>(<span class="op">-</span>b_x1 <span class="op">/</span><span class="st"> </span>b_x2) <span class="op">*</span><span class="st"> </span>x1) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1962-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1962-10" data-line-number="10"><span class="st">  </span><span class="co"># now plot</span></a>
<a class="sourceLine" id="cb1962-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1962-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1962-13" data-line-number="13">            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1962-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb1962-15" data-line-number="15">            <span class="kw">aes</span>(<span class="dt">label =</span> y, <span class="dt">color =</span> y <span class="op">==</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1962-16" data-line-number="16">            <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1962-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;blue4&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1962-18" data-line-number="18"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with Post. Pred.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1962-19" data-line-number="19"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1962-20" data-line-number="20">                  <span class="dt">ylim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1962-21" data-line-number="21"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </a>
<a class="sourceLine" id="cb1962-22" data-line-number="22">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-40-1.png" style="display: block; margin: auto;" /></p>
<p>It can be easy to under-appreciate how sensitive this plot is to the seed you set for <code>sample_n()</code>. To give a better sense of the uncertainty in the posterior for the threshold, here we show the plot for several different seeds.</p>
<div class="sourceCode" id="cb1963"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1963-1" data-line-number="1"><span class="co"># make a custom function</span></a>
<a class="sourceLine" id="cb1963-2" data-line-number="2">different_seed &lt;-<span class="st"> </span><span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb1963-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb1963-4" data-line-number="4">  <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb1963-5" data-line-number="5">  <span class="kw">posterior_samples</span>(fit21<span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-7" data-line-number="7"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dt">size =</span> <span class="dv">20</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-8" data-line-number="8"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(iter, b_Intercept, b_x1, b_x2),</a>
<a class="sourceLine" id="cb1963-9" data-line-number="9">         <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x2 =</span> (<span class="op">-</span>b_Intercept <span class="op">/</span><span class="st"> </span>b_x2) <span class="op">+</span><span class="st"> </span>(<span class="op">-</span>b_x1 <span class="op">/</span><span class="st"> </span>b_x2) <span class="op">*</span><span class="st"> </span>x1)</a>
<a class="sourceLine" id="cb1963-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb1963-12" data-line-number="12">}</a>
<a class="sourceLine" id="cb1963-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1963-14" data-line-number="14"><span class="co"># specify your seeds</span></a>
<a class="sourceLine" id="cb1963-15" data-line-number="15"><span class="kw">tibble</span>(<span class="dt">seed =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-16" data-line-number="16"><span class="st">  </span><span class="co"># pump those seeds into the `different_seed()` function</span></a>
<a class="sourceLine" id="cb1963-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">map</span>(seed, different_seed)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-18" data-line-number="18"><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-19" data-line-number="19"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">seed =</span> <span class="kw">str_c</span>(<span class="st">&quot;seed: &quot;</span>, seed)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1963-20" data-line-number="20"><span class="st">  </span></a>
<a class="sourceLine" id="cb1963-21" data-line-number="21"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1963-22" data-line-number="22"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1963-24" data-line-number="24">            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-25" data-line-number="25"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb1963-26" data-line-number="26">            <span class="kw">aes</span>(<span class="dt">label =</span> y, <span class="dt">color =</span> y <span class="op">==</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1963-27" data-line-number="27">            <span class="dt">size =</span> <span class="fl">1.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;red4&quot;</span>, <span class="st">&quot;blue4&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-29" data-line-number="29"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with Post. Pred.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-30" data-line-number="30"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb1963-31" data-line-number="31">                  <span class="dt">ylim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-32" data-line-number="32"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb1963-33" data-line-number="33">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1963-34" data-line-number="34"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>seed)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-41-1.png" style="display: block; margin: auto;" /></p>
<p>We’ll use <code>pairs()</code> to make our version of Figure 21.6.b.</p>
<div class="sourceCode" id="cb1964"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1964-1" data-line-number="1"><span class="kw">pairs</span>(fit21<span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb1964-2" data-line-number="2">      <span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>))</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-42-1.png" style="display: block; margin: auto;" /></p>
<p>Finally, here are the Pearson’s correlations among the model parameters.</p>
<div class="sourceCode" id="cb1965"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1965-1" data-line-number="1"><span class="kw">vcov</span>(fit21<span class="fl">.5</span>, <span class="dt">correlation =</span> T) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1965-2" data-line-number="2"><span class="st">  </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##           Intercept     x1     x2
## Intercept     1.000  0.010 -0.028
## x1            0.010  1.000 -0.928
## x2           -0.028 -0.928  1.000</code></pre>
</div>
<div id="interaction-of-metric-predictors." class="section level3">
<h3><span class="header-section-number">21.2.4</span> Interaction of metric predictors.</h3>
<p>“There may be applications in which it is meaningful to consider a multiplicative interaction of metric predictors” (p. 633). Kruschke didn’t walk through an analysis in this section, but it’s worth the practice. Let’s simulate data based on the formula he gave in Figure 21.7, top right.</p>
<div class="sourceCode" id="cb1967"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1967-1" data-line-number="1">n  &lt;-<span class="st"> </span><span class="dv">500</span></a>
<a class="sourceLine" id="cb1967-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1967-3" data-line-number="3">b0 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1967-4" data-line-number="4">b1 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1967-5" data-line-number="5">b2 &lt;-<span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb1967-6" data-line-number="6">b3 &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb1967-7" data-line-number="7"></a>
<a class="sourceLine" id="cb1967-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">21</span>)</a>
<a class="sourceLine" id="cb1967-9" data-line-number="9">d &lt;-</a>
<a class="sourceLine" id="cb1967-10" data-line-number="10"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x1 =</span> <span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1967-11" data-line-number="11">         <span class="dt">x2 =</span> <span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1967-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> b1 <span class="op">*</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>b2 <span class="op">*</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>b3 <span class="op">*</span><span class="st"> </span>x1 <span class="op">*</span><span class="st"> </span>x2 <span class="op">-</span><span class="st"> </span>b0) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1967-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>mu))))</a></code></pre></div>
<p>To fit the interaction model, let’s go back to the Bernoulli likelihood.</p>
<div class="sourceCode" id="cb1968"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1968-1" data-line-number="1">fit21<span class="fl">.6</span> &lt;-</a>
<a class="sourceLine" id="cb1968-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> d, </a>
<a class="sourceLine" id="cb1968-3" data-line-number="3">      <span class="dt">family =</span> bernoulli,</a>
<a class="sourceLine" id="cb1968-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span>x2 <span class="op">+</span><span class="st"> </span>x1<span class="op">:</span>x2,</a>
<a class="sourceLine" id="cb1968-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1968-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb1968-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1968-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1968-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.06&quot;</span>)</a></code></pre></div>
<p>Looks like the model did a nice job recapturing the data-generating parameters.</p>
<div class="sourceCode" id="cb1969"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1969-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.6</span>)</a></code></pre></div>
<pre><code>##  Family: bernoulli 
##   Links: mu = logit 
## Formula: y ~ 1 + x1 + x2 + x1:x2 
##    Data: d (Number of observations: 500) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -0.18      0.12    -0.42     0.06 1.00     9164     6145
## x1           -0.21      0.17    -0.53     0.11 1.00     9497     6131
## x2           -0.02      0.16    -0.35     0.30 1.00     8567     5382
## x1:x2         4.27      0.44     3.44     5.15 1.00     7391     5543
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>I’m not quite sure how to expand Kruschke’s equation from the top of page 629 to our interaction model. But no worries. We can take a slightly different approach to show the consequences of our interaction model on the probability <span class="math inline">\(y = 1\)</span>. First, we define our <code>newdata</code> and then get the <code>Estimate</code>s from <code>fitted()</code>. Then we wrangle as usual.</p>
<div class="sourceCode" id="cb1971"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1971-1" data-line-number="1">length &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb1971-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1971-3" data-line-number="3">nd &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1971-4" data-line-number="4"><span class="st">  </span><span class="kw">crossing</span>(<span class="dt">x1 =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length),</a>
<a class="sourceLine" id="cb1971-5" data-line-number="5">           <span class="dt">x2 =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length))</a>
<a class="sourceLine" id="cb1971-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1971-7" data-line-number="7">f &lt;-</a>
<a class="sourceLine" id="cb1971-8" data-line-number="8"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.6</span>,</a>
<a class="sourceLine" id="cb1971-9" data-line-number="9">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1971-10" data-line-number="10">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1971-11" data-line-number="11"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1971-12" data-line-number="12"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">prob =</span> Estimate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv_logit_scaled</span>())</a></code></pre></div>
<p>Now all we have to do is integrate our <code>f</code> results with the <code>nd</code> and original <code>d</code> data and then we can plot.</p>
<div class="sourceCode" id="cb1972"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1972-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1972-2" data-line-number="2"><span class="st">  </span><span class="kw">bind_cols</span>(nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1972-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb1972-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> prob),</a>
<a class="sourceLine" id="cb1972-6" data-line-number="6">              <span class="dt">interpolate =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb1972-8" data-line-number="8">            <span class="kw">aes</span>(<span class="dt">label =</span> y, <span class="dt">color =</span> y <span class="op">==</span><span class="st"> </span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1972-9" data-line-number="9">            <span class="dt">size =</span> <span class="fl">2.75</span>, <span class="dt">show.legend =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;white&quot;</span>, <span class="st">&quot;black&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(p)(<span class="kw">italic</span>(y)<span class="op">==</span><span class="dv">1</span>)), </a>
<a class="sourceLine" id="cb1972-12" data-line-number="12">                       <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">begin =</span> <span class="fl">.15</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1972-15" data-line-number="15"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(nd<span class="op">$</span>x1),</a>
<a class="sourceLine" id="cb1972-16" data-line-number="16">                  <span class="dt">ylim =</span> <span class="kw">range</span>(nd<span class="op">$</span>x2))</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-47-1.png" style="display: block; margin: auto;" /></p>
<p>Instead of a simple threshold line, we get to visualize our interaction as a checkerboard-like probability plane.</p>
</div>
</div>
<div id="robust-logistic-regression" class="section level2">
<h2><span class="header-section-number">21.3</span> Robust logistic regression</h2>
<p>With the robust logistic regression approach,</p>
<blockquote>
<p>we will describe the data as being a mixture of two different sources. One source is the logistic function of the predictor(s). The other source is sheer randomness or “guessing,” whereby the <span class="math inline">\(y\)</span> value comes from the flip of a fair coin: <span class="math inline">\(y \sim \operatorname{Bernoulli} (\mu = 1/2)\)</span>. We suppose that every data point has a small chance, <span class="math inline">\(\alpha\)</span>, of being generated by the guessing process, but usually, with probability <span class="math inline">\(1 - \alpha\)</span>, the <span class="math inline">\(y\)</span> value comes from the logistic function of the predictor. With the two sources combined, the predicted probability that <span class="math inline">\(y = 1\)</span> is</p>
<p><span class="math display">\[\mu = \alpha \cdot \frac{1}{2} + (1 - \alpha) \cdot \operatorname{logistic} \bigg ( \beta_0  + \sum_j \beta_j x_j \bigg )\]</span></p>
<p>Notice that when the guessing coefficient is zero, then the conventional logistic model is completely recovered. When the guessing coefficient is one, then the y values are completely random. (p. 635)</p>
</blockquote>
<p>Here’s what Kruschke’s <code>beta(1, 9)</code> prior for <span class="math inline">\(\alpha\)</span> looks like.</p>
<div class="sourceCode" id="cb1973"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1973-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1973-2" data-line-number="2"><span class="st">  </span></a>
<a class="sourceLine" id="cb1973-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1973-4" data-line-number="4"><span class="st">  </span><span class="co"># check out this `ymax` trick?</span></a>
<a class="sourceLine" id="cb1973-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="kw">dbeta</span>(x, <span class="dv">1</span>, <span class="dv">9</span>)),</a>
<a class="sourceLine" id="cb1973-6" data-line-number="6">              <span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1973-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1973-8" data-line-number="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="kw">expression</span>(<span class="st">&quot;beta&quot;</span><span class="op">*</span>(<span class="dv">1</span><span class="op">*</span><span class="st">&quot;, &quot;</span><span class="op">*</span><span class="dv">9</span>)), </a>
<a class="sourceLine" id="cb1973-9" data-line-number="9">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1973-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-48-1.png" style="display: block; margin: auto;" /></p>
<p>To fit the <strong>brms</strong> analogue to Kruschke’s rogust logistic regression model, we’ll need to adopt what Bürkner calls the non-linear syntax, which you can learn about in detail with his vignette, <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_nonlinear.html"><em>Estimating Non-Linear Models with brms</em></a>.</p>
<div class="sourceCode" id="cb1974"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1974-1" data-line-number="1">fit21<span class="fl">.7</span> &lt;-</a>
<a class="sourceLine" id="cb1974-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1974-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> identity),</a>
<a class="sourceLine" id="cb1974-4" data-line-number="4">      <span class="kw">bf</span>(male <span class="op">~</span><span class="st"> </span>a <span class="op">*</span><span class="st"> </span><span class="fl">.5</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>a) <span class="op">*</span><span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(b0 <span class="op">+</span><span class="st"> </span>b1 <span class="op">*</span><span class="st"> </span>weight_z))),</a>
<a class="sourceLine" id="cb1974-5" data-line-number="5">         a <span class="op">+</span><span class="st"> </span>b0 <span class="op">+</span><span class="st"> </span>b1  <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1974-6" data-line-number="6">         <span class="dt">nl =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb1974-7" data-line-number="7">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">nlpar =</span> <span class="st">&quot;b0&quot;</span>),</a>
<a class="sourceLine" id="cb1974-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">nlpar =</span> <span class="st">&quot;b1&quot;</span>),</a>
<a class="sourceLine" id="cb1974-9" data-line-number="9">                <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">1</span>, <span class="dv">9</span>),   <span class="dt">nlpar =</span> <span class="st">&quot;a&quot;</span>)),</a>
<a class="sourceLine" id="cb1974-10" data-line-number="10">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1974-11" data-line-number="11">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1974-12" data-line-number="12">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.07&quot;</span>)</a></code></pre></div>
<p>And just for clarity, you can do the same thing with <code>family = binomial(link = identity)</code>, too. Just don’t forget to specify the number of trials with <code>trials()</code>. But to explain what’s going on with our syntax, above, I think it’s best to quote Bürkner at length:</p>
<blockquote>
<p>When looking at the above code, the first thing that becomes obvious is that we changed the <code>formula</code> syntax to display the non-linear formula including predictors (i.e., [<code>weight_z</code>]) and parameters (i.e., [<code>a</code>, <code>b0</code>, and <code>b1</code>]) wrapped in a call to [the <code>bf()</code> function]. This stands in contrast to classical <strong>R</strong> formulas, where only predictors are given and parameters are implicit. The argument [<code>a + b0 + b1 ~ 1</code>] serves two purposes. First, it provides information, which variables in <code>formula</code> are parameters, and second, it specifies the linear predictor terms for each parameter. In fact, we should think of non-linear parameters as placeholders for linear predictor terms rather than as parameters themselves (see also the following examples). In the present case, we have no further variables to predict [<code>a</code>, <code>b0</code>, and <code>b1</code>] and thus we just fit intercepts that represent our estimates of [<span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta_0\)</span>, and <span class="math inline">\(\beta_1\)</span>]. The formula [<code>a + b0 + b1 ~ 1</code>] is a short form of [<code>a ~ 1, b0 ~ 1, b1 ~ 1</code>] that can be used if multiple non-linear parameters share the same formula. Setting <code>nl = TRUE</code> tells <strong>brms</strong> that the formula should be treated as non-linear.</p>
<p>In contrast to generalized linear models, priors on population-level parameters (i.e., ‘fixed effects’) are often mandatory to identify a non-linear model. Thus, <strong>brms</strong> requires the user to explicitely specify these priors. In the present example, we used a [<code>beta(1, 9)</code> prior on (the population-level intercept of) <code>a</code>, while we used a <code>normal(0, 4)</code> prior on both (population-level intercepts of) <code>b0</code> and <code>b1</code>]. Setting priors is a non-trivial task in all kinds of models, especially in non-linear models, so you should always invest some time to think of appropriate priors. Quite often, you may be forced to change your priors after fitting a non-linear model for the first time, when you observe different MCMC chains converging to different posterior regions. This is a clear sign of an idenfication problem and one solution is to set stronger (i.e., more narrow) priors. (<strong>emphasis</strong> in the original)</p>
</blockquote>
<p>Now, behold the summary.</p>
<div class="sourceCode" id="cb1975"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1975-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.7</span>)</a></code></pre></div>
<pre><code>## Warning: There were 632 divergent transitions after warmup. Increasing adapt_delta above 0.8 may help.
## See http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</code></pre>
<pre><code>##  Family: bernoulli 
##   Links: mu = identity 
## Formula: male ~ a * 0.5 + (1 - a) * 1/(1 + exp(-1 * (b0 + b1 * weight_z))) 
##          a ~ 1
##          b0 ~ 1
##          b1 ~ 1
##    Data: my_data (Number of observations: 110) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## a_Intercept      0.20      0.09     0.04     0.39 1.00     2541     2843
## b0_Intercept     0.34      0.45    -0.41     1.39 1.00     3505     3195
## b1_Intercept     2.64      0.87     1.14     4.53 1.00     2539     3349
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>It turns out Bürkner’s warning on “different posterior regions” applied to our case. While preparing this document, I played around with higher <code>adapt_delta</code> values, as suggested in the warning message. The model showed problems even at <code>adapt_delta = 0.999</code>. Here, our main purpose is to ape Kruschke. But if this was a substantive model of interest, I’d suggest following Bürkner’s advice and think hard about specifying narrower priors.</p>
<p>Anyway, here’s a quick and dirty look at the conditional effects for <code>weight_z</code>.</p>
<div class="sourceCode" id="cb1978"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1978-1" data-line-number="1"><span class="kw">conditional_effects</span>(fit21<span class="fl">.7</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1978-2" data-line-number="2"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">points =</span> T)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-50-1.png" style="display: block; margin: auto;" /></p>
<p>The way we prep for our version of Figure 21.8 is just the same as what we did for Figure 21.3, above.</p>
<div class="sourceCode" id="cb1979"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1979-1" data-line-number="1">length &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb1979-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1979-3" data-line-number="3">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">weight_z =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-2</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">length.out =</span> length))</a>
<a class="sourceLine" id="cb1979-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1979-5" data-line-number="5">f &lt;-</a>
<a class="sourceLine" id="cb1979-6" data-line-number="6"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.7</span>,</a>
<a class="sourceLine" id="cb1979-7" data-line-number="7">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1979-8" data-line-number="8">         <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb1979-9" data-line-number="9">         <span class="dt">nsamples =</span> n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-10" data-line-number="10"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span>n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-12" data-line-number="12"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-13" data-line-number="13"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight_z =</span> <span class="kw">rep</span>(nd<span class="op">$</span>weight_z, <span class="dt">times =</span> n_iter)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">weight   =</span> weight_z <span class="op">*</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight))</a>
<a class="sourceLine" id="cb1979-15" data-line-number="15"></a>
<a class="sourceLine" id="cb1979-16" data-line-number="16">thresholds &lt;-</a>
<a class="sourceLine" id="cb1979-17" data-line-number="17"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-18" data-line-number="18"><span class="st">  </span><span class="kw">filter</span>(value <span class="op">&lt;</span><span class="st"> </span><span class="fl">.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-19" data-line-number="19"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1979-20" data-line-number="20"><span class="st">  </span><span class="kw">filter</span>(value <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(value))</a></code></pre></div>
<p>Now make the top panel.</p>
<div class="sourceCode" id="cb1980"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1980-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb1980-2" data-line-number="2"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1980-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> weight, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">.5</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> thresholds<span class="op">$</span>weight, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> iter),</a>
<a class="sourceLine" id="cb1980-7" data-line-number="7">            <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1980-9" data-line-number="9">             <span class="kw">aes</span>(<span class="dt">y =</span> male),</a>
<a class="sourceLine" id="cb1980-10" data-line-number="10">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-11" data-line-number="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Post. Pred.&quot;</span>, </a>
<a class="sourceLine" id="cb1980-12" data-line-number="12">       <span class="dt">y =</span> <span class="st">&quot;male&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-13" data-line-number="13"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>weight)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1980-14" data-line-number="14"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p>Here we make the marginal-distribution plots for our versions of the lower panels of Figure 21.8.</p>
<div class="sourceCode" id="cb1981"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1981-1" data-line-number="1">p2 &lt;-</a>
<a class="sourceLine" id="cb1981-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit21<span class="fl">.7</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1981-3" data-line-number="3"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">Intercept =</span> b_b0_Intercept <span class="op">-</span><span class="st"> </span>(b_b1_Intercept <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>weight) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight)),</a>
<a class="sourceLine" id="cb1981-4" data-line-number="4">            <span class="dt">weight    =</span> b_b1_Intercept <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>weight),</a>
<a class="sourceLine" id="cb1981-5" data-line-number="5">            <span class="dt">guessing  =</span> b_a_Intercept) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1981-6" data-line-number="6"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1981-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;weight&quot;</span>, <span class="st">&quot;guessing&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1981-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb1981-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1981-10" data-line-number="10"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1981-11" data-line-number="11">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1981-12" data-line-number="12">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1981-13" data-line-number="13">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1981-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1981-15" data-line-number="15"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1981-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1981-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>Now combine them with <strong>patchwork</strong> and behold the glory.</p>
<div class="sourceCode" id="cb1982"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1982-1" data-line-number="1">p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">+</span></a>
<a class="sourceLine" id="cb1982-2" data-line-number="2"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">height =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-54-1.png" style="display: block; margin: auto;" /></p>
<p>Here are the <code>pairs()</code> plots.</p>
<div class="sourceCode" id="cb1983"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1983-1" data-line-number="1"><span class="kw">pairs</span>(fit21<span class="fl">.7</span>,</a>
<a class="sourceLine" id="cb1983-2" data-line-number="2">      <span class="dt">off_diag_args =</span> <span class="kw">list</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">5</span>))</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-55-1.png" style="display: block; margin: auto;" /></p>
<p>Look at how that sweet Stan-based HMC reduced the correlation between <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<p>For more on this approach to robust logistic regression in <strong>brms</strong> and an alternative suggested by Andrew Gelman, check out a thread from the Stan Forums, <a href="https://discourse.mc-stan.org/t/translating-robust-logistic-regression-from-rstan-to-brms/5244"><em>Translating robust logistic regression from rstan to brms</em></a>.</p>
</div>
<div id="nominal-predictors" class="section level2">
<h2><span class="header-section-number">21.4</span> Nominal predictors</h2>
<p>“We now turn our attention from metric predictors to nominal predictors” (p. 636).</p>
<div id="single-group." class="section level3">
<h3><span class="header-section-number">21.4.1</span> Single group.</h3>
<p>If we have just a single group and no other predictors, that’s just an intercept-only model. Back in the earlier chapters we thought of such a model as</p>
<p><span class="math display">\[\begin{align*}
y &amp; \sim \operatorname{Bernoulli} (\theta) \\
\theta &amp; \sim \operatorname{dbeta} (a, b).
\end{align*}\]</span></p>
<p>Now we’re expressing the model as</p>
<p><span class="math display">\[\begin{align*}
y   &amp; \sim \operatorname{Bernoulli} (\mu) \\
\mu &amp; \sim \operatorname{logistic} (\beta_0).
\end{align*}\]</span></p>
<p>For that <span class="math inline">\(\beta_0\)</span>, we typically use a Gaussian prior of the form</p>
<p><span class="math display">\[\beta_0 \sim \operatorname{Normal} (M_0, S_0).\]</span></p>
<p>In a situation where we don’t have strong prior substantive knowledge, we often set <span class="math inline">\(M_0 = 0\)</span>, which puts the probability mass around <span class="math inline">\(\theta = .5\)</span>, a reasonable default hypothesis. Often times <span class="math inline">\(S_0\)</span> is some modest single-digit integer like 2 or 4. To get a sense of how different Gaussians translate to the beta distribution, we’ll recreate Figure 21.11.</p>
<div class="sourceCode" id="cb1984"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1984-1" data-line-number="1"><span class="co"># this will help streamline the conversion</span></a>
<a class="sourceLine" id="cb1984-2" data-line-number="2">logistic &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb1984-3" data-line-number="3">  <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>x))</a>
<a class="sourceLine" id="cb1984-4" data-line-number="4">}</a>
<a class="sourceLine" id="cb1984-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1984-6" data-line-number="6"><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb1984-7" data-line-number="7"><span class="kw">crossing</span>(<span class="dt">m_0 =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1984-8" data-line-number="8">         <span class="dt">s_0 =</span> <span class="kw">c</span>(.<span class="dv">5</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1984-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu == logistic(beta %~%&quot;</span>, <span class="st">&quot; N(&quot;</span>, m_<span class="dv">0</span>, <span class="st">&quot;, &quot;</span>, s_<span class="dv">0</span>, <span class="st">&quot;))&quot;</span>),</a>
<a class="sourceLine" id="cb1984-10" data-line-number="10">         <span class="dt">sim =</span> <span class="kw">pmap</span>(<span class="kw">list</span>(<span class="fl">2e6</span>, m_<span class="dv">0</span>, s_<span class="dv">0</span>), rnorm)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1984-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1984-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">logistic</span>(sim)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1984-13" data-line-number="13"><span class="st">  </span></a>
<a class="sourceLine" id="cb1984-14" data-line-number="14"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1984-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sim,</a>
<a class="sourceLine" id="cb1984-16" data-line-number="16">             <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1984-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1984-18" data-line-number="18">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">bins =</span> <span class="dv">20</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1984-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat =</span> <span class="st">&quot;density&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1984-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1984-21" data-line-number="21"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1984-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1984-23" data-line-number="23"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-56-1.png" style="display: block; margin: auto;" /></p>
<p>So the prior distribution doesn’t even flatten out until you’re somewhere between <span class="math inline">\(S_0 = 1\)</span> and <span class="math inline">\(S_0 = 2\)</span>. Just for kicks, here we break that down a little further.</p>
<div class="sourceCode" id="cb1985"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1985-1" data-line-number="1"><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb1985-2" data-line-number="2"><span class="kw">tibble</span>(<span class="dt">m_0 =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb1985-3" data-line-number="3">       <span class="dt">s_0 =</span> <span class="kw">c</span>(<span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="fl">1.75</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1985-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">key =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu == logistic(beta %~%&quot;</span>, <span class="st">&quot; N(&quot;</span>, m_<span class="dv">0</span>, <span class="st">&quot;, &quot;</span>, s_<span class="dv">0</span>, <span class="st">&quot;))&quot;</span>),</a>
<a class="sourceLine" id="cb1985-5" data-line-number="5">         <span class="dt">sim =</span> <span class="kw">pmap</span>(<span class="kw">list</span>(<span class="fl">1e7</span>, m_<span class="dv">0</span>, s_<span class="dv">0</span>), rnorm)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1985-6" data-line-number="6"><span class="st">  </span><span class="kw">unnest</span>(sim) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1985-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">logistic</span>(sim)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1985-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb1985-9" data-line-number="9"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1985-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sim,</a>
<a class="sourceLine" id="cb1985-11" data-line-number="11">             <span class="dt">y =</span> ..density..)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1985-12" data-line-number="12"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>,</a>
<a class="sourceLine" id="cb1985-13" data-line-number="13">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dt">bins =</span> <span class="dv">20</span>, <span class="dt">boundary =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1985-14" data-line-number="14"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat =</span> <span class="st">&quot;density&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1985-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1985-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(mu)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1985-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1985-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>key, <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="dt">labeller =</span> label_parsed, <span class="dt">ncol =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-57-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s the basic <strong>brms</strong> analogue to Kruschke’s JAGS code from the bottom of page 639.</p>
<div class="sourceCode" id="cb1986"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1986-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb1986-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1986-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">bernoulli</span>(<span class="dt">link =</span> identity),</a>
<a class="sourceLine" id="cb1986-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1986-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">beta</span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">class =</span> Intercept))</a></code></pre></div>
<p>Here’s the <strong>brms</strong> analogue to Kruschke’s JAGS code at the top of page 641.</p>
<div class="sourceCode" id="cb1987"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1987-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb1987-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data, </a>
<a class="sourceLine" id="cb1987-3" data-line-number="3">      <span class="dt">family =</span> bernoulli,</a>
<a class="sourceLine" id="cb1987-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1987-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> <span class="st">&quot;Intercept&quot;</span>))</a></code></pre></div>
</div>
<div id="multiple-groups." class="section level3">
<h3><span class="header-section-number">21.4.2</span> Multiple groups.</h3>
<p>If there’s only one group, we don’t need a grouping variable. But that’s a special case. Now we show the more general approach with multiple groups.</p>
<div id="example-baseball-again." class="section level4">
<h4><span class="header-section-number">21.4.2.1</span> Example: Baseball again.</h4>
<p>Load the baseball data.</p>
<div class="sourceCode" id="cb1988"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1988-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/BattingAverage.csv&quot;</span>)</a>
<a class="sourceLine" id="cb1988-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1988-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 948
## Variables: 6
## $ Player       &lt;chr&gt; &quot;Fernando Abad&quot;, &quot;Bobby Abreu&quot;, &quot;Tony Abreu&quot;, &quot;Dustin Ackley&quot;, &quot;Matt Adams&quot;,…
## $ PriPos       &lt;chr&gt; &quot;Pitcher&quot;, &quot;Left Field&quot;, &quot;2nd Base&quot;, &quot;2nd Base&quot;, &quot;1st Base&quot;, &quot;Pitcher&quot;, &quot;Pit…
## $ Hits         &lt;dbl&gt; 1, 53, 18, 137, 21, 0, 0, 2, 150, 167, 0, 128, 66, 3, 1, 81, 180, 36, 150, 0…
## $ AtBats       &lt;dbl&gt; 7, 219, 70, 607, 86, 1, 1, 20, 549, 576, 1, 525, 275, 12, 8, 384, 629, 158, …
## $ PlayerNumber &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 2…
## $ PriPosNumber &lt;dbl&gt; 1, 7, 4, 4, 3, 1, 1, 3, 3, 4, 1, 5, 4, 2, 7, 4, 6, 8, 9, 1, 2, 5, 1, 1, 7, 2…</code></pre>
</div>
<div id="the-model." class="section level4">
<h4><span class="header-section-number">21.4.2.2</span> The model.</h4>
<p>I’m not aware that Kruschke’s modeling approach, here, will work well within the <strong>brms</strong> paradigm. I suggest we fit a simple hierarchical logistic regression model, instead. With this approach, we use the statistical model</p>
<p><span class="math display">\[\begin{align*}
\text{Hits}_i               &amp; \sim \operatorname{Binomial} (\text{AtBats}_i, p_i) \\
\operatorname{logit} (p_i)  &amp; = \beta_0 + \beta_{\text{PriPos}_i} + \beta_{\text{PriPos:Player}_i} \\
\beta_0                     &amp; \sim \operatorname{Normal} (0, 2) \\
\beta_\text{PriPos}         &amp; \sim \operatorname{Normal} (0, \sigma_\text{PriPos}) \\
\beta_\text{PriPos:Player}  &amp; \sim \operatorname{Normal} (0, \sigma_\text{PriPos:Player}) \\
\sigma_\text{PriPos}        &amp; \sim \operatorname{HalfCauchy} (0, 1) \\
\sigma_\text{PriPos:Player} &amp; \sim \operatorname{HalfCauchy} (0, 1).
\end{align*}\]</span></p>
<p>Here’s how to fit the model with <strong>brms</strong>. Notice we’re finally making good use of the <code>trials()</code> syntax. This is because we’re fitting an aggregated binomial model. Instead of our criterion variable <code>Hits</code> being a vector of 0’s and 1’s, it’s the number of successful trials given the total number of trials, which is listed in the <code>AtBats</code> vector. Aggregated binomial.</p>
<div class="sourceCode" id="cb1990"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1990-1" data-line-number="1">fit21<span class="fl">.8</span> &lt;-</a>
<a class="sourceLine" id="cb1990-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1990-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>),</a>
<a class="sourceLine" id="cb1990-4" data-line-number="4">      Hits <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(AtBats) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos<span class="op">:</span>Player),</a>
<a class="sourceLine" id="cb1990-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb1990-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">cauchy</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> sd)),</a>
<a class="sourceLine" id="cb1990-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">2500</span>, <span class="dt">warmup =</span> <span class="dv">500</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb1990-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">21</span>,</a>
<a class="sourceLine" id="cb1990-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit21.08&quot;</span>)</a></code></pre></div>
</div>
<div id="results.-1" class="section level4">
<h4><span class="header-section-number">21.4.2.3</span> Results.</h4>
<p>Before we start plotting, review the model summary.</p>
<div class="sourceCode" id="cb1991"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1991-1" data-line-number="1"><span class="kw">print</span>(fit21<span class="fl">.8</span>)</a></code></pre></div>
<pre><code>##  Family: binomial 
##   Links: mu = logit 
## Formula: Hits | trials(AtBats) ~ 1 + (1 | PriPos) + (1 | PriPos:Player) 
##    Data: my_data (Number of observations: 948) 
## Samples: 4 chains, each with iter = 2500; warmup = 500; thin = 1;
##          total post-warmup samples = 8000
## 
## Group-Level Effects: 
## ~PriPos (Number of levels: 9) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.32      0.10     0.19     0.57 1.00     2590     3901
## 
## ~PriPos:Player (Number of levels: 948) 
##               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sd(Intercept)     0.14      0.01     0.12     0.15 1.00     3978     5910
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept    -1.17      0.11    -1.40    -0.94 1.00     1696     2634
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>If you look closely at our model versus the one in the text, you’ll see ours has fewer parameters. As a down-the-line consequence, our model doesn’t support a direct analogue to the plot at the top of Figure 21.13. However, we can come close. Rather than modeling the position-based probabilities as multiple draws of beta distributions, we can simply summarize our probabilities by their posterior distributions.</p>
<div class="sourceCode" id="cb1993"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1993-1" data-line-number="1"><span class="kw">library</span>(ggridges)</a>
<a class="sourceLine" id="cb1993-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1993-3" data-line-number="3"><span class="co"># define our new data, `nd`</span></a>
<a class="sourceLine" id="cb1993-4" data-line-number="4">nd &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1993-5" data-line-number="5"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(PriPos) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-7" data-line-number="7"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">AtBats =</span> <span class="kw">mean</span>(AtBats) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1993-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1993-9" data-line-number="9"><span class="co"># push the model through `fitted()` and wrangle</span></a>
<a class="sourceLine" id="cb1993-10" data-line-number="10"><span class="kw">fitted</span>(fit21<span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb1993-11" data-line-number="11">       <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1993-12" data-line-number="12">       <span class="dt">re_formula =</span> Hits <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(AtBats) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos),</a>
<a class="sourceLine" id="cb1993-13" data-line-number="13">       <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>,</a>
<a class="sourceLine" id="cb1993-14" data-line-number="14">       <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-15" data-line-number="15"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-16" data-line-number="16"><span class="st">  </span><span class="kw">gather</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-17" data-line-number="17"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">probability =</span> <span class="kw">inv_logit_scaled</span>(value)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-18" data-line-number="18"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">expand</span>(nd, PriPos, <span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8000</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1993-19" data-line-number="19"><span class="st">  </span></a>
<a class="sourceLine" id="cb1993-20" data-line-number="20"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb1993-21" data-line-number="21"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> probability, <span class="dt">y =</span> PriPos)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1993-22" data-line-number="22"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">fixef</span>(fit21<span class="fl">.8</span>)[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">inv_logit_scaled</span>(), <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1993-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_density_ridges</span>(<span class="dt">size =</span> <span class="dv">0</span>, <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">scale =</span> <span class="fl">.9</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1993-24" data-line-number="24"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1993-25" data-line-number="25">              <span class="kw">aes</span>(<span class="dt">x =</span> Hits <span class="op">/</span><span class="st"> </span>AtBats),</a>
<a class="sourceLine" id="cb1993-26" data-line-number="26">              <span class="dt">height =</span> <span class="fl">.025</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1993-27" data-line-number="27"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb1993-28" data-line-number="28">                  <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">9.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1993-29" data-line-number="29"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>,</a>
<a class="sourceLine" id="cb1993-30" data-line-number="30">       <span class="dt">x =</span> <span class="st">&quot;Hits / AtBats&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1993-31" data-line-number="31"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb1993-32" data-line-number="32">        <span class="dt">axis.ticks.y =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1993-33" data-line-number="33">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-62-1.png" style="display: block; margin: auto;" /></p>
<p>For kicks and giggles, we depicted the grand mean probability as the white vertical line in the background with the <code>geom_vline()</code> line.</p>
<p>However, we can make our plot more directly analogous to Kruschke’s if we’re willing to stretch a little. Recall that Kruschke used the beta distribution with the <span class="math inline">\(\omega-\kappa\)</span> parameterization in both his statistical model and his plot code—both of which you can find detailed in his <code>Jags-Ybinom-Xnom1fac-Mlogistic.R</code>. file. We didn’t use the beta distribution in our <code>brm()</code> model and the parameters from that model didn’t have as direct correspondences to the beta distribution the way those from Kruschke’s JAGS model did. However, recall that we can re-parameterize the beta distribution in terms of its mean <span class="math inline">\(\mu\)</span> and sample size <span class="math inline">\(n\)</span>, folowing the form</p>
<p><span class="math display">\[\begin{align*}
\alpha &amp; = \mu n \\
\beta  &amp; = (1 - \mu) n .
\end{align*}\]</span></p>
<p>When we take the inverse logit of our intercepts, we do get vales in a probability metric. We might consider inserting those probabilities into the <span class="math inline">\(\mu\)</span> parameter. Furthermore, we can take our <code>AtBats</code> sample sizes and insert them directly into <span class="math inline">\(n\)</span>. As before, we’ll use the average sample size per position.</p>
<div class="sourceCode" id="cb1994"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1994-1" data-line-number="1"><span class="co"># wrangle like a boss</span></a>
<a class="sourceLine" id="cb1994-2" data-line-number="2">nd <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-3" data-line-number="3"><span class="st">  </span><span class="kw">add_fitted_draws</span>(fit21<span class="fl">.8</span>, </a>
<a class="sourceLine" id="cb1994-4" data-line-number="4">                   <span class="dt">n =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb1994-5" data-line-number="5">                   <span class="dt">re_formula =</span> Hits <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(AtBats) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos),</a>
<a class="sourceLine" id="cb1994-6" data-line-number="6">                   <span class="dt">dpar =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-7" data-line-number="7"><span class="st">  </span><span class="co"># use the equations from above</span></a>
<a class="sourceLine" id="cb1994-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">alpha =</span> mu <span class="op">*</span><span class="st"> </span>AtBats, </a>
<a class="sourceLine" id="cb1994-9" data-line-number="9">         <span class="dt">beta  =</span> (<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>mu) <span class="op">*</span><span class="st"> </span>AtBats) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ll =</span> <span class="kw">qbeta</span>(.<span class="dv">025</span>, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta),</a>
<a class="sourceLine" id="cb1994-11" data-line-number="11">         <span class="dt">ul =</span> <span class="kw">qbeta</span>(.<span class="dv">975</span>, <span class="dt">shape1 =</span> alpha, <span class="dt">shape2 =</span> beta)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta =</span> <span class="kw">map2</span>(ll, ul, seq, <span class="dt">length.out =</span> <span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-13" data-line-number="13"><span class="st">  </span><span class="kw">unnest</span>(theta) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dbeta</span>(theta, alpha, beta)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-15" data-line-number="15"><span class="st">  </span><span class="kw">group_by</span>(.draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> density <span class="op">/</span><span class="st"> </span><span class="kw">max</span>(density)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1994-17" data-line-number="17"><span class="st">  </span></a>
<a class="sourceLine" id="cb1994-18" data-line-number="18"><span class="st">  </span><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb1994-19" data-line-number="19"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">y =</span> PriPos)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1994-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_ridgeline</span>(<span class="kw">aes</span>(<span class="dt">x =</span> theta, <span class="dt">height =</span> <span class="op">-</span>density, <span class="dt">group =</span> <span class="kw">interaction</span>(PriPos, .draw)),</a>
<a class="sourceLine" id="cb1994-21" data-line-number="21">                 <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">color =</span> <span class="kw">adjustcolor</span>(<span class="st">&quot;grey50&quot;</span>, <span class="dt">alpha.f =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb1994-22" data-line-number="22">                 <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">scale =</span> <span class="dv">3</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">min_height =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1994-23" data-line-number="23"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb1994-24" data-line-number="24">              <span class="kw">aes</span>(<span class="dt">x =</span> Hits <span class="op">/</span><span class="st"> </span>AtBats, <span class="dt">size =</span> AtBats),</a>
<a class="sourceLine" id="cb1994-25" data-line-number="25">              <span class="dt">height =</span> <span class="fl">.05</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">6</span>, <span class="dt">shape =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1994-26" data-line-number="26"><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dv">4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1994-27" data-line-number="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Data with Posterior Predictive Distrib.&quot;</span>,</a>
<a class="sourceLine" id="cb1994-28" data-line-number="28">       <span class="dt">x =</span> <span class="st">&quot;Hits / AtBats&quot;</span>,</a>
<a class="sourceLine" id="cb1994-29" data-line-number="29">       <span class="dt">y =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1994-30" data-line-number="30"><span class="st">  </span><span class="kw">coord_flip</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.67</span>, <span class="fl">8.67</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1994-31" data-line-number="31"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb1994-32" data-line-number="32">        <span class="dt">axis.ticks.x =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb1994-33" data-line-number="33">        <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>),</a>
<a class="sourceLine" id="cb1994-34" data-line-number="34">        <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;transparent&quot;</span>),</a>
<a class="sourceLine" id="cb1994-35" data-line-number="35">        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">956</span>, <span class="fl">.8</span>),</a>
<a class="sourceLine" id="cb1994-36" data-line-number="36">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-63-1.png" style="display: block; margin: auto;" /></p>
<p>Since we didn’t actually presume the beta distribution anywhere in our <code>brm()</code> statistical model, <em>I would not attempt to present this workflow in a scientific outlet</em>. Go with the previous plot. This attempt seems dishonest. But it is kinda fun to see how far we can push our results.</p>
<p>Happily, our contrasts will be less contentious. Here’s the initial wrangling.</p>
<div class="sourceCode" id="cb1995"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1995-1" data-line-number="1"><span class="co"># define our subset of positions</span></a>
<a class="sourceLine" id="cb1995-2" data-line-number="2">positions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;1st Base&quot;</span>, <span class="st">&quot;Catcher&quot;</span>, <span class="st">&quot;Pitcher&quot;</span>)</a>
<a class="sourceLine" id="cb1995-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1995-4" data-line-number="4"><span class="co"># redefine `nd`</span></a>
<a class="sourceLine" id="cb1995-5" data-line-number="5">nd &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1995-6" data-line-number="6"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1995-7" data-line-number="7"><span class="st">  </span><span class="kw">filter</span>(PriPos <span class="op">%in%</span><span class="st"> </span>positions) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1995-8" data-line-number="8"><span class="st">  </span><span class="kw">group_by</span>(PriPos) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1995-9" data-line-number="9"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">AtBats =</span> <span class="kw">mean</span>(AtBats) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>))</a>
<a class="sourceLine" id="cb1995-10" data-line-number="10"></a>
<a class="sourceLine" id="cb1995-11" data-line-number="11"><span class="co"># push the model through `fitted()` and wrangle</span></a>
<a class="sourceLine" id="cb1995-12" data-line-number="12">f &lt;-</a>
<a class="sourceLine" id="cb1995-13" data-line-number="13"><span class="st">  </span><span class="kw">fitted</span>(fit21<span class="fl">.8</span>,</a>
<a class="sourceLine" id="cb1995-14" data-line-number="14">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb1995-15" data-line-number="15">         <span class="dt">re_formula =</span> Hits <span class="op">|</span><span class="st"> </span><span class="kw">trials</span>(AtBats) <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>PriPos),</a>
<a class="sourceLine" id="cb1995-16" data-line-number="16">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>,</a>
<a class="sourceLine" id="cb1995-17" data-line-number="17">         <span class="dt">summary =</span> F) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1995-18" data-line-number="18"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1995-19" data-line-number="19"><span class="st">  </span><span class="kw">set_names</span>(positions)</a>
<a class="sourceLine" id="cb1995-20" data-line-number="20"></a>
<a class="sourceLine" id="cb1995-21" data-line-number="21"><span class="co"># what did we do?</span></a>
<a class="sourceLine" id="cb1995-22" data-line-number="22"><span class="kw">head</span>(f)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   `1st Base` Catcher Pitcher
##        &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1      -1.12   -1.12   -1.92
## 2      -1.09   -1.14   -1.91
## 3      -1.07   -1.13   -1.89
## 4      -1.07   -1.13   -1.90
## 5      -1.05   -1.17   -1.91
## 6      -1.10   -1.17   -1.89</code></pre>
<p>Here we make are our versions of the middle two panels of Figure 21.13.</p>
<div class="sourceCode" id="cb1997"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1997-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb1997-2" data-line-number="2"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1997-3" data-line-number="3"><span class="st">  </span><span class="co"># compute the differences and put the data in the long format</span></a>
<a class="sourceLine" id="cb1997-4" data-line-number="4"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">Pitcher vs. Catcher</span><span class="st">`</span>  =<span class="st"> </span>Pitcher <span class="op">-</span><span class="st"> </span>Catcher,</a>
<a class="sourceLine" id="cb1997-5" data-line-number="5">            <span class="st">`</span><span class="dt">Catcher vs. 1st Base</span><span class="st">`</span> =<span class="st"> </span>Catcher <span class="op">-</span><span class="st"> `</span><span class="dt">1st Base</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1997-6" data-line-number="6"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1997-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pitcher vs. Catcher&quot;</span>, <span class="st">&quot;Catcher vs. 1st Base&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1997-8" data-line-number="8"><span class="st">  </span></a>
<a class="sourceLine" id="cb1997-9" data-line-number="9"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1997-10" data-line-number="10"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1997-11" data-line-number="11"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1997-12" data-line-number="12">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1997-13" data-line-number="13">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.2</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1997-14" data-line-number="14">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1997-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1997-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Difference (in b)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1997-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1997-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p>Now make our versions of the bottom two panels of Figure 21.13.</p>
<div class="sourceCode" id="cb1998"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1998-1" data-line-number="1">p2 &lt;-</a>
<a class="sourceLine" id="cb1998-2" data-line-number="2"><span class="st">  </span>f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1998-3" data-line-number="3"><span class="st">  </span><span class="co"># do the transformation before computing the differences</span></a>
<a class="sourceLine" id="cb1998-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate_all</span>(inv_logit_scaled) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1998-5" data-line-number="5"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">Pitcher vs. Catcher</span><span class="st">`</span>  =<span class="st"> </span>Pitcher <span class="op">-</span><span class="st"> </span>Catcher,</a>
<a class="sourceLine" id="cb1998-6" data-line-number="6">            <span class="st">`</span><span class="dt">Catcher vs. 1st Base</span><span class="st">`</span> =<span class="st"> </span>Catcher <span class="op">-</span><span class="st"> `</span><span class="dt">1st Base</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1998-7" data-line-number="7"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1998-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Pitcher vs. Catcher&quot;</span>, <span class="st">&quot;Catcher vs. 1st Base&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1998-9" data-line-number="9"><span class="st">  </span></a>
<a class="sourceLine" id="cb1998-10" data-line-number="10"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb1998-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1998-12" data-line-number="12"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="kw">c</span>(.<span class="dv">95</span>, <span class="fl">.5</span>),</a>
<a class="sourceLine" id="cb1998-13" data-line-number="13">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb1998-14" data-line-number="14">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.2</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb1998-15" data-line-number="15">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1998-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1998-17" data-line-number="17"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Difference (in probability)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb1998-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb1998-19" data-line-number="19"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p>Combine and plot.</p>
<div class="sourceCode" id="cb1999"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1999-1" data-line-number="1">p1 <span class="op">/</span><span class="st"> </span>p2</a></code></pre></div>
<p><img src="21_files/figure-gfm/unnamed-chunk-67-1.png" style="display: block; margin: auto;" /></p>
<p>Note how our distributions are described as differences in probability, rather than in <span class="math inline">\(\omega\)</span>.</p>
</div>
</div>
</div>
<div id="reference-20" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-20" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb2000"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2000-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] ggridges_0.5.2       patchwork_1.0.0      tidybayes_2.0.1.9000 brms_2.11.5         
##  [5] Rcpp_1.0.3           ggExtra_0.9          forcats_0.4.0        stringr_1.4.0       
##  [9] dplyr_0.8.4          purrr_0.3.3          readr_1.3.1          tidyr_1.0.2         
## [13] tibble_2.1.3         ggplot2_3.2.1        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ellipsis_0.3.0            rsconnect_0.8.16         
##   [4] markdown_1.1              base64enc_0.1-3           fs_1.3.1                 
##   [7] rstudioapi_0.10           farver_2.0.3              rstan_2.19.2             
##  [10] svUnit_0.7-12             DT_0.11                   fansi_0.4.1              
##  [13] mvtnorm_1.0-12            lubridate_1.7.4           xml2_1.2.2               
##  [16] bridgesampling_0.8-1      knitr_1.26                shinythemes_1.1.2        
##  [19] bayesplot_1.7.1           jsonlite_1.6.1            broom_0.5.3              
##  [22] dbplyr_1.4.2              shiny_1.4.0               compiler_3.6.2           
##  [25] httr_1.4.1                backports_1.1.5           assertthat_0.2.1         
##  [28] Matrix_1.2-18             fastmap_1.0.1             lazyeval_0.2.2           
##  [31] cli_2.0.1                 later_1.0.0               htmltools_0.4.0          
##  [34] prettyunits_1.1.1         tools_3.6.2               igraph_1.2.4.2           
##  [37] coda_0.19-3               gtable_0.3.0              glue_1.3.1               
##  [40] reshape2_1.4.3            cellranger_1.1.0          vctrs_0.2.2              
##  [43] nlme_3.1-142              crosstalk_1.0.0           xfun_0.12                
##  [46] ps_1.3.0                  rvest_0.3.5               mime_0.8                 
##  [49] miniUI_0.1.1.1            lifecycle_0.1.0           gtools_3.8.1             
##  [52] MASS_7.3-51.4             zoo_1.8-7                 scales_1.1.0             
##  [55] colourpicker_1.0          hms_0.5.3                 promises_1.1.0           
##  [58] Brobdingnag_1.2-6         parallel_3.6.2            inline_0.3.15            
##  [61] shinystan_2.5.0           yaml_2.2.1                gridExtra_2.3            
##  [64] loo_2.2.0                 StanHeaders_2.19.0        stringi_1.4.5            
##  [67] highr_0.8                 dygraphs_1.1.1.6          pkgbuild_1.0.6           
##  [70] rlang_0.4.4               pkgconfig_2.0.3           matrixStats_0.55.0       
##  [73] HDInterval_0.2.0          evaluate_0.14             lattice_0.20-38          
##  [76] rstantools_2.0.0          htmlwidgets_1.5.1         labeling_0.3             
##  [79] tidyselect_1.0.0          processx_3.4.1            plyr_1.8.5               
##  [82] magrittr_1.5              R6_2.4.1                  generics_0.0.2           
##  [85] DBI_1.1.0                 pillar_1.4.3              haven_2.2.0              
##  [88] withr_2.1.2               xts_0.12-0                abind_1.4-5              
##  [91] modelr_0.1.5              crayon_1.3.4              arrayhelpers_1.0-20160527
##  [94] utf8_1.1.4                rmarkdown_2.0             grid_3.6.2               
##  [97] readxl_1.3.1              callr_3.4.1               threejs_0.3.3            
## [100] reprex_0.3.0              digest_0.6.23             xtable_1.8-4             
## [103] httpuv_1.5.2              stats4_3.6.2              munsell_0.5.0            
## [106] viridisLite_0.3.0         shinyjs_1.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="metric-predicted-variable-with-multiple-nominal-predictors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="nominal-predicted-variable.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
