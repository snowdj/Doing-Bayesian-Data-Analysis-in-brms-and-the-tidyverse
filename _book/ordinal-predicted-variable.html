<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>23 Ordinal Predicted Variable | Doing Bayesian Data Analysis in brms and the tidyverse</title>
  <meta name="description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="generator" content="bookdown 0.17 and GitBook 2.6.7" />

  <meta property="og:title" content="23 Ordinal Predicted Variable | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  <meta name="github-repo" content="ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="23 Ordinal Predicted Variable | Doing Bayesian Data Analysis in brms and the tidyverse" />
  <meta name="twitter:site" content="@SolomonKurz" />
  <meta name="twitter:description" content="This project is an attempt to re-express the code in Kruschke’s (2015) textbook. His models are re-fit in brms, plots are redone with ggplot2, and the general data wrangling code predominantly follows the tidyverse style." />
  

<meta name="author" content="A Solomon Kurz" />


<meta name="date" content="2020-02-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="nominal-predicted-variable.html"/>
<link rel="next" href="count-predicted-variable.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What and why</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#caution-work-in-progress"><i class="fa fa-check"></i>Caution: Work in progress</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#weve-come-so-far"><i class="fa fa-check"></i>We’ve come so far!</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#were-not-done-yet-and-i-could-use-your-help."><i class="fa fa-check"></i>We’re not done yet and I could use your help.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#thank-yous-are-in-order"><i class="fa fa-check"></i>Thank-you’s are in order</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html"><i class="fa fa-check"></i><b>1</b> What’s in This Book (Read This First!)</a><ul>
<li class="chapter" data-level="1.1" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#real-people-can-read-this-book"><i class="fa fa-check"></i><b>1.1</b> Real people can read this book</a></li>
<li class="chapter" data-level="1.2" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-in-this-book"><i class="fa fa-check"></i><b>1.2</b> What’s in this book</a></li>
<li class="chapter" data-level="1.3" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#whats-new-in-the-second-edition"><i class="fa fa-check"></i><b>1.3</b> What’s new in the second edition</a></li>
<li class="chapter" data-level="1.4" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#gimme-feedback-be-polite"><i class="fa fa-check"></i><b>1.4</b> Gimme feedback (be polite)</a></li>
<li class="chapter" data-level="1.5" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#thank-you"><i class="fa fa-check"></i><b>1.5</b> Thank you!</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#reference"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="whats-in-this-book-read-this-first.html"><a href="whats-in-this-book-read-this-first.html#session-info"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>I THE BASICS: MODELS, PROBABILITY, BAYES’ RULE, AND R</b></span></li>
<li class="chapter" data-level="2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html"><i class="fa fa-check"></i><b>2</b> Introduction: Credibility, Models, and Parameters</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#bayesian-inference-is-reallocation-of-credibility-across-possibilities"><i class="fa fa-check"></i><b>2.1</b> Bayesian inference is reallocation of credibility across possibilities</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#data-are-noisy-and-inferences-are-probabilistic."><i class="fa fa-check"></i><b>2.1.1</b> Data are noisy and inferences are probabilistic.</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#possibilities-are-parameter-values-in-descriptive-models"><i class="fa fa-check"></i><b>2.2</b> Possibilities are parameter values in descriptive models</a></li>
<li class="chapter" data-level="2.3" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#the-steps-of-bayesian-data-analysis"><i class="fa fa-check"></i><b>2.3</b> The steps of Bayesian data analysis</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#reference-1"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="introduction-credibility-models-and-parameters.html"><a href="introduction-credibility-models-and-parameters.html#session-info-1"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html"><i class="fa fa-check"></i><b>3</b> The R Programming Language</a><ul>
<li class="chapter" data-level="3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-software"><i class="fa fa-check"></i><b>3.1</b> Get the software</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-look-at-rstudio."><i class="fa fa-check"></i><b>3.1.1</b> A look at RStudio.</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#a-simple-example-of-r-in-action"><i class="fa fa-check"></i><b>3.2</b> A simple example of R in action</a><ul>
<li class="chapter" data-level="3.2.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#get-the-programs-used-with-this-book."><i class="fa fa-check"></i><b>3.2.1</b> Get the programs used with this book.</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#basic-commands-and-operators-in-r"><i class="fa fa-check"></i><b>3.3</b> Basic commands and operators in R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#getting-help-in-r."><i class="fa fa-check"></i><b>3.3.1</b> Getting help in R.</a></li>
<li class="chapter" data-level="3.3.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#arithmetic-and-logical-operators."><i class="fa fa-check"></i><b>3.3.2</b> Arithmetic and logical operators.</a></li>
<li class="chapter" data-level="3.3.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#assignment-relational-operators-and-tests-of-equality."><i class="fa fa-check"></i><b>3.3.3</b> Assignment, relational operators, and tests of equality.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-types"><i class="fa fa-check"></i><b>3.4</b> Variable types</a><ul>
<li class="chapter" data-level="3.4.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#vector."><i class="fa fa-check"></i><b>3.4.1</b> Vector.</a></li>
<li class="chapter" data-level="3.4.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#factor."><i class="fa fa-check"></i><b>3.4.2</b> Factor.</a></li>
<li class="chapter" data-level="3.4.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#matrix-and-array."><i class="fa fa-check"></i><b>3.4.3</b> Matrix and array.</a></li>
<li class="chapter" data-level="3.4.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#list-and-data-frame."><i class="fa fa-check"></i><b>3.4.4</b> List and data frame.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#loading-and-saving-data"><i class="fa fa-check"></i><b>3.5</b> Loading and saving data</a><ul>
<li class="chapter" data-level="3.5.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#the-read.csv-read_csv-and-read.table-read_table-functions."><i class="fa fa-check"></i><b>3.5.1</b> The <del>read.csv</del> <code>read_csv()</code> and <del>read.table</del> <code>read_table()</code> functions.</a></li>
<li class="chapter" data-level="3.5.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#saving-data-from-r."><i class="fa fa-check"></i><b>3.5.2</b> Saving data from R.</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#some-utility-functions"><i class="fa fa-check"></i><b>3.6</b> Some utility functions</a></li>
<li class="chapter" data-level="3.7" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-in-r"><i class="fa fa-check"></i><b>3.7</b> Programming in R</a><ul>
<li class="chapter" data-level="3.7.1" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#variable-names-in-r."><i class="fa fa-check"></i><b>3.7.1</b> Variable names in R.</a></li>
<li class="chapter" data-level="3.7.2" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#running-a-program."><i class="fa fa-check"></i><b>3.7.2</b> Running a program.</a></li>
<li class="chapter" data-level="3.7.3" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#programming-a-function."><i class="fa fa-check"></i><b>3.7.3</b> Programming a function.</a></li>
<li class="chapter" data-level="3.7.4" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#conditions-and-loops."><i class="fa fa-check"></i><b>3.7.4</b> Conditions and loops.</a></li>
<li class="chapter" data-level="3.7.5" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#measuring-processing-time."><i class="fa fa-check"></i><b>3.7.5</b> Measuring processing time.</a></li>
<li class="chapter" data-level="3.7.6" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#debugging."><i class="fa fa-check"></i><b>3.7.6</b> Debugging.</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#graphical-plots-opening-and-saving"><i class="fa fa-check"></i><b>3.8</b> Graphical plots: Opening and saving</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#reference-2"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="the-r-programming-language.html"><a href="the-r-programming-language.html#session-info-2"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html"><i class="fa fa-check"></i><b>4</b> What is This Stuff Called Probability?</a><ul>
<li class="chapter" data-level="4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#the-set-of-all-possible-events"><i class="fa fa-check"></i><b>4.1</b> The set of all possible events</a></li>
<li class="chapter" data-level="4.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-outside-or-inside-the-head"><i class="fa fa-check"></i><b>4.2</b> Probability: Outside or inside the head</a><ul>
<li class="chapter" data-level="4.2.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#outside-the-head-long-run-relative-frequency."><i class="fa fa-check"></i><b>4.2.1</b> Outside the head: Long-run relative frequency.</a></li>
<li class="chapter" data-level="4.2.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#inside-the-head-subjective-belief."><i class="fa fa-check"></i><b>4.2.2</b> Inside the head: Subjective belief.</a></li>
<li class="chapter" data-level="4.2.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probabilities-assign-numbers-to-possibilities."><i class="fa fa-check"></i><b>4.2.3</b> Probabilities assign numbers to possibilities.</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#probability-distributions"><i class="fa fa-check"></i><b>4.3</b> Probability distributions</a><ul>
<li class="chapter" data-level="4.3.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#discrete-distributions-probability-mass."><i class="fa fa-check"></i><b>4.3.1</b> Discrete distributions: Probability mass.</a></li>
<li class="chapter" data-level="4.3.2" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#continuous-distributions-rendezvous-with-density."><i class="fa fa-check"></i><b>4.3.2</b> Continuous distributions: Rendezvous with density.</a></li>
<li class="chapter" data-level="4.3.3" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#mean-and-variance-of-a-distribution."><i class="fa fa-check"></i><b>4.3.3</b> Mean and variance of a distribution.</a></li>
<li class="chapter" data-level="4.3.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#highest-density-interval-hdi."><i class="fa fa-check"></i><b>4.3.4</b> Highest density interval (HDI).</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#two-way-distributions"><i class="fa fa-check"></i><b>4.4</b> Two-way distributions</a><ul>
<li class="chapter" data-level="4.4.1" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#conditional-probability."><i class="fa fa-check"></i><b>4.4.1</b> Conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#reference-3"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="what-is-this-stuff-called-probability.html"><a href="what-is-this-stuff-called-probability.html#session-info-3"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="bayes-rule.html"><a href="bayes-rule.html"><i class="fa fa-check"></i><b>5</b> Bayes’ Rule</a><ul>
<li class="chapter" data-level="5.1" data-path="bayes-rule.html"><a href="bayes-rule.html#bayes-rule-1"><i class="fa fa-check"></i><b>5.1</b> Bayes’ rule</a><ul>
<li class="chapter" data-level="5.1.1" data-path="bayes-rule.html"><a href="bayes-rule.html#derived-from-definitions-of-conditional-probability."><i class="fa fa-check"></i><b>5.1.1</b> Derived from definitions of conditional probability.</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="bayes-rule.html"><a href="bayes-rule.html#applied-to-parameters-and-data"><i class="fa fa-check"></i><b>5.2</b> Applied to parameters and data</a></li>
<li class="chapter" data-level="5.3" data-path="bayes-rule.html"><a href="bayes-rule.html#complete-examples-estimating-bias-in-a-coin"><i class="fa fa-check"></i><b>5.3</b> Complete examples: Estimating bias in a coin</a><ul>
<li class="chapter" data-level="5.3.1" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-sample-size-on-the-posterior."><i class="fa fa-check"></i><b>5.3.1</b> Influence of sample size on the posterior.</a></li>
<li class="chapter" data-level="5.3.2" data-path="bayes-rule.html"><a href="bayes-rule.html#influence-of-prior-on-the-posterior."><i class="fa fa-check"></i><b>5.3.2</b> Influence of prior on the posterior.</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="bayes-rule.html"><a href="bayes-rule.html#why-bayesian-inference-can-be-difficult"><i class="fa fa-check"></i><b>5.4</b> Why Bayesian inference can be difficult</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#reference-4"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayes-rule.html"><a href="bayes-rule.html#session-info-4"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>II ALL THE FUNDAMENTALS APPLIED TO INFERRING A BINOMIAL PROBABILITY</b></span></li>
<li class="chapter" data-level="6" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><i class="fa fa-check"></i><b>6</b> Inferring a Binomial Probability via Exact Mathematical Analysis</a><ul>
<li class="chapter" data-level="6.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-likelihood-function-the-bernoulli-distribution"><i class="fa fa-check"></i><b>6.1</b> The likelihood function: The Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#a-description-of-credibilities-the-beta-distribution"><i class="fa fa-check"></i><b>6.2</b> A description of credibilities: The beta distribution</a><ul>
<li class="chapter" data-level="6.2.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#specifying-a-beta-prior."><i class="fa fa-check"></i><b>6.2.1</b> Specifying a beta prior.</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#the-posterior-beta"><i class="fa fa-check"></i><b>6.3</b> The posterior beta</a><ul>
<li class="chapter" data-level="6.3.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#posterior-is-compromise-of-prior-and-likelihood."><i class="fa fa-check"></i><b>6.3.1</b> Posterior is compromise of prior and likelihood.</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#examples"><i class="fa fa-check"></i><b>6.4</b> Examples</a><ul>
<li class="chapter" data-level="6.4.1" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.1</b> Prior knowledge expressed as a beta distribution.</a></li>
<li class="chapter" data-level="6.4.2" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#prior-knowledge-that-cannot-be-expressed-as-a-beta-distribution."><i class="fa fa-check"></i><b>6.4.2</b> Prior knowledge that cannot be expressed as a beta distribution.</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#summary"><i class="fa fa-check"></i><b>6.5</b> Summary</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#reference-5"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="inferring-a-binomial-probability-via-exact-mathematical-analysis.html"><a href="inferring-a-binomial-probability-via-exact-mathematical-analysis.html#session-info-5"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html"><i class="fa fa-check"></i><b>7</b> Markov Chain Monte Carlo</a><ul>
<li class="chapter" data-level="7.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#approximating-a-distribution-with-a-large-sample"><i class="fa fa-check"></i><b>7.1</b> Approximating a distribution with a large sample</a></li>
<li class="chapter" data-level="7.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-simple-case-of-the-metropolis-algorithm"><i class="fa fa-check"></i><b>7.2</b> A simple case of the Metropolis algorithm</a><ul>
<li class="chapter" data-level="7.2.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-politician-stumbles-upon-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.2.1</b> A politician stumbles upon the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.2.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#a-random-walk."><i class="fa fa-check"></i><b>7.2.2</b> A random walk.</a></li>
<li class="chapter" data-level="7.2.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#general-properties-of-a-random-walk."><i class="fa fa-check"></i><b>7.2.3</b> General properties of a random walk.</a></li>
<li class="chapter" data-level="7.2.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#why-we-care."><i class="fa fa-check"></i><b>7.2.4</b> Why we care.</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-metropolis-algorithm-more-generally"><i class="fa fa-check"></i><b>7.3</b> The Metropolis algorithm more generally</a><ul>
<li class="chapter" data-level="7.3.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#metropolis-algorithm-applied-to-bernoulli-likelihood-and-beta-prior."><i class="fa fa-check"></i><b>7.3.1</b> Metropolis algorithm applied to Bernoulli likelihood and beta prior.</a></li>
<li class="chapter" data-level="7.3.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#summary-of-metropolis-algorithm."><i class="fa fa-check"></i><b>7.3.2</b> Summary of Metropolis algorithm.</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#toward-gibbs-sampling-estimating-two-coin-biases"><i class="fa fa-check"></i><b>7.4</b> Toward Gibbs sampling: Estimating two coin biases</a><ul>
<li class="chapter" data-level="7.4.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#prior-likelihood-and-posterior-for-two-biases."><i class="fa fa-check"></i><b>7.4.1</b> Prior, likelihood and posterior for two biases.</a></li>
<li class="chapter" data-level="7.4.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-exact-formal-analysis."><i class="fa fa-check"></i><b>7.4.2</b> The posterior via exact formal analysis.</a></li>
<li class="chapter" data-level="7.4.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#the-posterior-via-the-metropolis-algorithm."><i class="fa fa-check"></i><b>7.4.3</b> The posterior via the Metropolis algorithm.</a></li>
<li class="chapter" data-level="7.4.4" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#gibbs-hamiltonian-monte-carlo-sampling."><i class="fa fa-check"></i><b>7.4.4</b> <del>Gibbs</del> Hamiltonian Monte Carlo sampling.</a></li>
<li class="chapter" data-level="7.4.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#is-there-a-difference-between-biases"><i class="fa fa-check"></i><b>7.4.5</b> Is there a difference between biases?</a></li>
<li class="chapter" data-level="7.4.6" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#terminology-mcmc."><i class="fa fa-check"></i><b>7.4.6</b> Terminology: MCMC.</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness-accuracy-and-efficiency"><i class="fa fa-check"></i><b>7.5</b> MCMC representativeness, accuracy, and efficiency</a><ul>
<li class="chapter" data-level="7.5.1" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-representativeness."><i class="fa fa-check"></i><b>7.5.1</b> MCMC representativeness.</a></li>
<li class="chapter" data-level="7.5.2" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-accuracy."><i class="fa fa-check"></i><b>7.5.2</b> MCMC accuracy.</a></li>
<li class="chapter" data-level="7.5.3" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#mcmc-efficiency."><i class="fa fa-check"></i><b>7.5.3</b> MCMC efficiency.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#reference-6"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="markov-chain-monte-carlo.html"><a href="markov-chain-monte-carlo.html#session-info-6"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="jags-brms.html"><a href="jags-brms.html"><i class="fa fa-check"></i><b>8</b> <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.1" data-path="jags-brms.html"><a href="jags-brms.html#jags-brms-and-its-relation-to-r"><i class="fa fa-check"></i><b>8.1</b> <del>JAGS</del> brms and its relation to R</a></li>
<li class="chapter" data-level="8.2" data-path="jags-brms.html"><a href="jags-brms.html#a-complete-example"><i class="fa fa-check"></i><b>8.2</b> A complete example</a><ul>
<li class="chapter" data-level="8.2.1" data-path="jags-brms.html"><a href="jags-brms.html#load-data."><i class="fa fa-check"></i><b>8.2.1</b> Load data.</a></li>
<li class="chapter" data-level="8.2.2" data-path="jags-brms.html"><a href="jags-brms.html#specify-model."><i class="fa fa-check"></i><b>8.2.2</b> Specify model.</a></li>
<li class="chapter" data-level="8.2.3" data-path="jags-brms.html"><a href="jags-brms.html#initialize-chains."><i class="fa fa-check"></i><b>8.2.3</b> Initialize chains.</a></li>
<li class="chapter" data-level="8.2.4" data-path="jags-brms.html"><a href="jags-brms.html#generate-chains."><i class="fa fa-check"></i><b>8.2.4</b> Generate chains.</a></li>
<li class="chapter" data-level="8.2.5" data-path="jags-brms.html"><a href="jags-brms.html#examine-chains."><i class="fa fa-check"></i><b>8.2.5</b> Examine chains.</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="jags-brms.html"><a href="jags-brms.html#simplified-scripts-for-frequently-used-analyses"><i class="fa fa-check"></i><b>8.3</b> Simplified scripts for frequently used analyses</a></li>
<li class="chapter" data-level="8.4" data-path="jags-brms.html"><a href="jags-brms.html#example-difference-of-biases"><i class="fa fa-check"></i><b>8.4</b> Example: Difference of biases</a></li>
<li class="chapter" data-level="8.5" data-path="jags-brms.html"><a href="jags-brms.html#sampling-from-the-prior-distribution-in-jags-brms"><i class="fa fa-check"></i><b>8.5</b> Sampling from the prior distribution in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="8.6" data-path="jags-brms.html"><a href="jags-brms.html#probability-distributions-available-in-jags-brms"><i class="fa fa-check"></i><b>8.6</b> Probability distributions available in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="8.6.1" data-path="jags-brms.html"><a href="jags-brms.html#defining-new-likelihood-functions."><i class="fa fa-check"></i><b>8.6.1</b> Defining new likelihood functions.</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="jags-brms.html"><a href="jags-brms.html#faster-sampling-with-parallel-processing-in-runjags-brmsbrm"><i class="fa fa-check"></i><b>8.7</b> Faster sampling with parallel processing in <del>runjags</del> <code>brms::brm()</code></a></li>
<li class="chapter" data-level="8.8" data-path="jags-brms.html"><a href="jags-brms.html#tips-for-expanding-jags-brms-models"><i class="fa fa-check"></i><b>8.8</b> Tips for expanding <del>JAGS</del> brms models</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#reference-7"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="jags-brms.html"><a href="jags-brms.html#session-info-7"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>9</b> Hierarchical Models</a><ul>
<li class="chapter" data-level="9.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-single-coin-from-a-single-mint"><i class="fa fa-check"></i><b>9.1</b> A single coin from a single mint</a><ul>
<li class="chapter" data-level="9.1.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation."><i class="fa fa-check"></i><b>9.1.1</b> Posterior via grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#multiple-coins-from-a-single-mint"><i class="fa fa-check"></i><b>9.2</b> Multiple coins from a single mint</a><ul>
<li class="chapter" data-level="9.2.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#posterior-via-grid-approximation.-1"><i class="fa fa-check"></i><b>9.2.1</b> Posterior via grid approximation.</a></li>
<li class="chapter" data-level="9.2.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-realistic-model-with-mcmc."><i class="fa fa-check"></i><b>9.2.2</b> A realistic model with MCMC.</a></li>
<li class="chapter" data-level="9.2.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#doing-it-with-jags-brms."><i class="fa fa-check"></i><b>9.2.3</b> Doing it with <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="9.2.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-therapeutic-touch."><i class="fa fa-check"></i><b>9.2.4</b> Example: Therapeutic touch.</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#shrinkage-in-hierarchical-models"><i class="fa fa-check"></i><b>9.3</b> Shrinkage in hierarchical models</a></li>
<li class="chapter" data-level="9.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#speeding-up-jags-brms"><i class="fa fa-check"></i><b>9.4</b> Speeding up <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="9.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#extending-the-hierarchy-subjects-within-categories"><i class="fa fa-check"></i><b>9.5</b> Extending the hierarchy: Subjects within categories</a><ul>
<li class="chapter" data-level="9.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-baseball-batting-abilities-by-position."><i class="fa fa-check"></i><b>9.5.1</b> Example: Baseball batting abilities by position.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#reference-8"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="hierarchical-models.html"><a href="hierarchical-models.html#session-info-8"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html"><i class="fa fa-check"></i><b>10</b> Model Comparison and Hierarchical Modeling</a><ul>
<li class="chapter" data-level="10.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#general-formula-and-the-bayes-factor"><i class="fa fa-check"></i><b>10.1</b> General formula and the Bayes factor</a></li>
<li class="chapter" data-level="10.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#example-two-factories-of-coins"><i class="fa fa-check"></i><b>10.2</b> Example: Two factories of coins</a><ul>
<li class="chapter" data-level="10.2.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-formal-analysis."><i class="fa fa-check"></i><b>10.2.1</b> Solution by formal analysis.</a></li>
<li class="chapter" data-level="10.2.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-grid-approximation."><i class="fa fa-check"></i><b>10.2.2</b> Solution by grid approximation.</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#solution-by-mcmc"><i class="fa fa-check"></i><b>10.3</b> Solution by MCMC</a><ul>
<li class="chapter" data-level="10.3.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#nonhierarchical-mcmc-computation-of-each-models-marginal-likelihood."><i class="fa fa-check"></i><b>10.3.1</b> Nonhierarchical MCMC computation of each model’s marginal likelihood.</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#hierarchical-mcmc-computation-of-relative-model-probability-is-not-available-in-brms-well-cover-information-criteria-instead."><i class="fa fa-check"></i><b>10.3.2</b> Hierarchical MCMC computation <del>of relative model probability</del> is not available in brms: We’ll cover information criteria instead.</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#models-with-different-noise-distributions-in-jags-brms."><i class="fa fa-check"></i><b>10.3.3</b> Models with different “noise” distributions in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#prediction-model-averaging"><i class="fa fa-check"></i><b>10.4</b> Prediction: Model averaging</a></li>
<li class="chapter" data-level="10.5" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#model-complexity-naturally-accounted-for"><i class="fa fa-check"></i><b>10.5</b> Model complexity naturally accounted for</a><ul>
<li class="chapter" data-level="10.5.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#caveats-regarding-nested-model-comparison."><i class="fa fa-check"></i><b>10.5.1</b> Caveats regarding nested model comparison.</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#extreme-sensitivity-to-the-prior-distribution"><i class="fa fa-check"></i><b>10.6</b> Extreme sensitivity to the prior distribution</a><ul>
<li class="chapter" data-level="10.6.1" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#priors-of-different-models-should-be-equally-informed."><i class="fa fa-check"></i><b>10.6.1</b> Priors of different models should be equally informed.</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#bonus-theres-danger-ahead"><i class="fa fa-check"></i><b>10.7</b> Bonus: There’s danger ahead</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#reference-9"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="model-comparison-and-hierarchical-modeling.html"><a href="model-comparison-and-hierarchical-modeling.html#session-info-9"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html"><i class="fa fa-check"></i><b>11</b> Null Hypothesis Significance Testing</a><ul>
<li class="chapter" data-level="11.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#paved-with-good-intentions"><i class="fa fa-check"></i><b>11.1</b> Paved with good intentions</a><ul>
<li class="chapter" data-level="11.1.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#definition-of-p-value."><i class="fa fa-check"></i><b>11.1.1</b> Definition of <span class="math inline">\(p\)</span> value.</a></li>
<li class="chapter" data-level="11.1.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-n."><i class="fa fa-check"></i><b>11.1.2</b> With intention to fix <span class="math inline">\(N\)</span>.</a></li>
<li class="chapter" data-level="11.1.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-z."><i class="fa fa-check"></i><b>11.1.3</b> With intention to fix <span class="math inline">\(z\)</span>.</a></li>
<li class="chapter" data-level="11.1.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-fix-duration."><i class="fa fa-check"></i><b>11.1.4</b> With intention to fix duration.</a></li>
<li class="chapter" data-level="11.1.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#with-intention-to-make-multiple-tests."><i class="fa fa-check"></i><b>11.1.5</b> With intention to make multiple tests.</a></li>
<li class="chapter" data-level="11.1.6" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#soul-searching."><i class="fa fa-check"></i><b>11.1.6</b> Soul searching.</a></li>
<li class="chapter" data-level="11.1.7" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis."><i class="fa fa-check"></i><b>11.1.7</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#prior-knowledge"><i class="fa fa-check"></i><b>11.2</b> Prior knowledge</a><ul>
<li class="chapter" data-level="11.2.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-analysis."><i class="fa fa-check"></i><b>11.2.1</b> NHST analysis.</a></li>
<li class="chapter" data-level="11.2.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-analysis.-1"><i class="fa fa-check"></i><b>11.2.2</b> Bayesian analysis.</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#confidence-interval-and-highest-density-interval"><i class="fa fa-check"></i><b>11.3</b> Confidence interval and highest density interval</a><ul>
<li class="chapter" data-level="11.3.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#ci-depends-on-intention."><i class="fa fa-check"></i><b>11.3.1</b> CI depends on intention.</a></li>
<li class="chapter" data-level="11.3.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#bayesian-hdi."><i class="fa fa-check"></i><b>11.3.2</b> Bayesian HDI.</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#multiple-comparisons"><i class="fa fa-check"></i><b>11.4</b> Multiple comparisons</a><ul>
<li class="chapter" data-level="11.4.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#nhst-correction-for-experiment-wise-error."><i class="fa fa-check"></i><b>11.4.1</b> NHST correction for experiment wise error.</a></li>
<li class="chapter" data-level="11.4.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#just-one-bayesian-posterior-no-matter-how-you-look-at-it."><i class="fa fa-check"></i><b>11.4.2</b> Just one Bayesian posterior no matter how you look at it.</a></li>
<li class="chapter" data-level="11.4.3" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#how-bayesian-analysis-mitigates-false-alarms."><i class="fa fa-check"></i><b>11.4.3</b> How Bayesian analysis mitigates false alarms.</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#what-a-sampling-distribution-is-good-for"><i class="fa fa-check"></i><b>11.5</b> What a sampling distribution is good for</a><ul>
<li class="chapter" data-level="11.5.1" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#planning-an-experiment."><i class="fa fa-check"></i><b>11.5.1</b> Planning an experiment.</a></li>
<li class="chapter" data-level="11.5.2" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#exploring-model-predictions-posterior-predictive-check."><i class="fa fa-check"></i><b>11.5.2</b> Exploring model predictions (posterior predictive check).</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#reference-10"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="null-hypothesis-significance-testing.html"><a href="null-hypothesis-significance-testing.html#session-info-10"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><i class="fa fa-check"></i><b>12</b> Bayesian Approaches to Testing a Point (“Null”) Hypothesis</a><ul>
<li class="chapter" data-level="12.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-estimation-approach"><i class="fa fa-check"></i><b>12.1</b> The estimation approach</a><ul>
<li class="chapter" data-level="12.1.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#region-of-practical-equivalence."><i class="fa fa-check"></i><b>12.1.1</b> Region of practical equivalence.</a></li>
<li class="chapter" data-level="12.1.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#some-examples."><i class="fa fa-check"></i><b>12.1.2</b> Some examples.</a></li>
<li class="chapter" data-level="12.1.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#differences-of-correlated-parameters."><i class="fa fa-check"></i><b>12.1.3</b> Differences of correlated parameters.</a></li>
<li class="chapter" data-level="12.1.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#why-hdi-and-not-equal-tailed-interval"><i class="fa fa-check"></i><b>12.1.4</b> Why HDI and not equal-tailed interval?</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#the-model-comparison-approach"><i class="fa fa-check"></i><b>12.2</b> The model-comparison approach</a><ul>
<li class="chapter" data-level="12.2.1" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#is-a-coin-fair-or-not"><i class="fa fa-check"></i><b>12.2.1</b> Is a coin fair or not?</a></li>
<li class="chapter" data-level="12.2.2" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#bayes-factor-can-accept-null-with-poor-precision."><i class="fa fa-check"></i><b>12.2.2</b> Bayes’ factor can accept null with poor precision.</a></li>
<li class="chapter" data-level="12.2.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#are-different-groups-equal-or-not"><i class="fa fa-check"></i><b>12.2.3</b> Are different groups equal or not?</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#relations-of-parameter-estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.3</b> Relations of parameter estimation and model comparison</a></li>
<li class="chapter" data-level="12.4" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#estimation-and-model-comparison"><i class="fa fa-check"></i><b>12.4</b> Estimation and model comparison?</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#reference-11"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="bayesian-approaches-to-testing-a-point-null-hypothesis.html"><a href="bayesian-approaches-to-testing-a-point-null-hypothesis.html#session-info-11"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html"><i class="fa fa-check"></i><b>13</b> Goals, Power, and Sample Size</a><ul>
<li class="chapter" data-level="13.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-will-to-power"><i class="fa fa-check"></i><b>13.1</b> The will to power</a><ul>
<li class="chapter" data-level="13.1.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#goals-and-obstacles."><i class="fa fa-check"></i><b>13.1.1</b> Goals and obstacles.</a></li>
<li class="chapter" data-level="13.1.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power."><i class="fa fa-check"></i><b>13.1.2</b> Power.</a></li>
<li class="chapter" data-level="13.1.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sample-size."><i class="fa fa-check"></i><b>13.1.3</b> Sample size.</a></li>
<li class="chapter" data-level="13.1.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#other-expressions-of-goals."><i class="fa fa-check"></i><b>13.1.4</b> Other expressions of goals.</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#computing-power-and-sample-size"><i class="fa fa-check"></i><b>13.2</b> Computing power and sample size</a><ul>
<li class="chapter" data-level="13.2.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-to-exclude-a-null-value."><i class="fa fa-check"></i><b>13.2.1</b> When the goal is to exclude a null value.</a></li>
<li class="chapter" data-level="13.2.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#formal-solution-and-implementation-in-r."><i class="fa fa-check"></i><b>13.2.2</b> Formal solution and implementation in R.</a></li>
<li class="chapter" data-level="13.2.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#when-the-goal-is-precision."><i class="fa fa-check"></i><b>13.2.3</b> When the goal is precision.</a></li>
<li class="chapter" data-level="13.2.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#monte-carlo-approximation-of-power."><i class="fa fa-check"></i><b>13.2.4</b> Monte Carlo approximation of power.</a></li>
<li class="chapter" data-level="13.2.5" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-from-idealized-or-actual-data."><i class="fa fa-check"></i><b>13.2.5</b> Power from idealized or actual data.</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#sequential-testing-and-the-goal-of-precision"><i class="fa fa-check"></i><b>13.3</b> Sequential testing and the goal of precision</a><ul>
<li class="chapter" data-level="13.3.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#examples-ofsequential-tests."><i class="fa fa-check"></i><b>13.3.1</b> Examples ofsequential tests.</a></li>
<li class="chapter" data-level="13.3.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#average-behavior-of-sequential-tests."><i class="fa fa-check"></i><b>13.3.2</b> Average behavior of sequential tests.</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#discussion"><i class="fa fa-check"></i><b>13.4</b> Discussion</a><ul>
<li class="chapter" data-level="13.4.1" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-and-multiple-comparisons."><i class="fa fa-check"></i><b>13.4.1</b> Power and multiple comparisons.</a></li>
<li class="chapter" data-level="13.4.2" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-prospective-retrospective-and-replication."><i class="fa fa-check"></i><b>13.4.2</b> Power: prospective, retrospective, and replication.</a></li>
<li class="chapter" data-level="13.4.3" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#power-analysis-requires-verisimilitude-of-simulated-data."><i class="fa fa-check"></i><b>13.4.3</b> Power analysis requires verisimilitude of simulated data.</a></li>
<li class="chapter" data-level="13.4.4" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#the-importance-of-planning."><i class="fa fa-check"></i><b>13.4.4</b> The importance of planning.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#reference-12"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="goals-power-and-sample-size.html"><a href="goals-power-and-sample-size.html#session-info-12"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="stan.html"><a href="stan.html"><i class="fa fa-check"></i><b>14</b> Stan</a><ul>
<li class="chapter" data-level="14.1" data-path="stan.html"><a href="stan.html#hmc-sampling"><i class="fa fa-check"></i><b>14.1</b> HMC sampling</a></li>
<li class="chapter" data-level="14.2" data-path="stan.html"><a href="stan.html#installing-stan"><i class="fa fa-check"></i><b>14.2</b> Installing Stan</a></li>
<li class="chapter" data-level="14.3" data-path="stan.html"><a href="stan.html#a-complete-example-1"><i class="fa fa-check"></i><b>14.3</b> A Complete example</a><ul>
<li class="chapter" data-level="14.3.1" data-path="stan.html"><a href="stan.html#reusing-the-compiled-model."><i class="fa fa-check"></i><b>14.3.1</b> Reusing the compiled model.</a></li>
<li class="chapter" data-level="14.3.2" data-path="stan.html"><a href="stan.html#general-structure-of-stan-model-specification."><i class="fa fa-check"></i><b>14.3.2</b> General structure of Stan model specification.</a></li>
<li class="chapter" data-level="14.3.3" data-path="stan.html"><a href="stan.html#think-log-probability-to-think-like-stan."><i class="fa fa-check"></i><b>14.3.3</b> Think log probability to think like Stan.</a></li>
<li class="chapter" data-level="14.3.4" data-path="stan.html"><a href="stan.html#sampling-the-prior-in-stan."><i class="fa fa-check"></i><b>14.3.4</b> Sampling the prior in Stan.</a></li>
<li class="chapter" data-level="14.3.5" data-path="stan.html"><a href="stan.html#simplified-scripts-for-frequently-used-analyses."><i class="fa fa-check"></i><b>14.3.5</b> Simplified scripts for frequently used analyses.</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="stan.html"><a href="stan.html#specify-models-top-down-in-stan"><i class="fa fa-check"></i><b>14.4</b> Specify models top-down in Stan</a></li>
<li class="chapter" data-level="14.5" data-path="stan.html"><a href="stan.html#limitations-and-extras"><i class="fa fa-check"></i><b>14.5</b> Limitations and extras</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#reference-13"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="stan.html"><a href="stan.html#session-info-13"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="part"><span><b>III THE GENERALIZED LINEAR MODEL</b></span></li>
<li class="chapter" data-level="15" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html"><i class="fa fa-check"></i><b>15</b> Overview of the Generalized Linear Model</a><ul>
<li class="chapter" data-level="15.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#types-of-variables"><i class="fa fa-check"></i><b>15.1</b> Types of variables</a><ul>
<li class="chapter" data-level="15.1.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#predictor-and-predicted-variables."><i class="fa fa-check"></i><b>15.1.1</b> Predictor and predicted variables.</a></li>
<li class="chapter" data-level="15.1.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#scale-types-metric-ordinal-nominal-and-count."><i class="fa fa-check"></i><b>15.1.2</b> Scale types: metric, ordinal, nominal, and count.</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-combination-of-predictors"><i class="fa fa-check"></i><b>15.2</b> Linear combination of predictors</a><ul>
<li class="chapter" data-level="15.2.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linear-function-of-a-single-metric-predictor."><i class="fa fa-check"></i><b>15.2.1</b> Linear function of a single metric predictor.</a></li>
<li class="chapter" data-level="15.2.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#additive-combination-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.2</b> Additive combination of metric predictors.</a></li>
<li class="chapter" data-level="15.2.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nonadditive-interaction-of-metric-predictors."><i class="fa fa-check"></i><b>15.2.3</b> Nonadditive interaction of metric predictors.</a></li>
<li class="chapter" data-level="15.2.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#nominal-predictors."><i class="fa fa-check"></i><b>15.2.4</b> Nominal predictors.</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#linking-from-combined-predictors-to-noisy-predicted-data"><i class="fa fa-check"></i><b>15.3</b> Linking from combined predictors to noisy predicted data</a><ul>
<li class="chapter" data-level="15.3.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predictors-to-predicted-central-tendency."><i class="fa fa-check"></i><b>15.3.1</b> From predictors to predicted central tendency.</a></li>
<li class="chapter" data-level="15.3.2" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#from-predicted-central-tendency-to-noisy-data."><i class="fa fa-check"></i><b>15.3.2</b> From predicted central tendency to noisy data.</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#formal-expression-of-the-glm"><i class="fa fa-check"></i><b>15.4</b> Formal expression of the GLM</a><ul>
<li class="chapter" data-level="15.4.1" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#cases-of-the-glm."><i class="fa fa-check"></i><b>15.4.1</b> Cases of the GLM.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#reference-14"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="overview-of-the-generalized-linear-model.html"><a href="overview-of-the-generalized-linear-model.html#session-info-14"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html"><i class="fa fa-check"></i><b>16</b> Metric-Predicted Variable on One or Two Groups</a><ul>
<li class="chapter" data-level="16.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#estimating-the-mean-and-standard-deviation-of-a-normal-distribution"><i class="fa fa-check"></i><b>16.1</b> Estimating the mean and standard deviation of a normal distribution</a><ul>
<li class="chapter" data-level="16.1.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#solution-by-mathematical-analysis-heads-up-on-precision."><i class="fa fa-check"></i><b>16.1.1</b> <del>Solution by mathematical analysis</del> Heads up on precision.</a></li>
<li class="chapter" data-level="16.1.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#approximation-by-mcmc-in-jags-hmc-in-brms."><i class="fa fa-check"></i><b>16.1.2</b> Approximation by <del>MCMC in JAGS</del> HMC in brms.</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#outliers-and-robust-estimation-the-t-distribution"><i class="fa fa-check"></i><b>16.2</b> Outliers and robust estimation: The <span class="math inline">\(t\)</span> distribution</a><ul>
<li class="chapter" data-level="16.2.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-jags-brms."><i class="fa fa-check"></i><b>16.2.1</b> Using the <span class="math inline">\(t\)</span> distribution in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="16.2.2" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#using-the-t-distribution-in-stan."><i class="fa fa-check"></i><b>16.2.2</b> Using the <span class="math inline">\(t\)</span> distribution in Stan.</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#two-groups"><i class="fa fa-check"></i><b>16.3</b> Two groups</a><ul>
<li class="chapter" data-level="16.3.1" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#analysis-by-nhst."><i class="fa fa-check"></i><b>16.3.1</b> Analysis by NHST.</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#other-noise-distributions-and-transforming-data"><i class="fa fa-check"></i><b>16.4</b> Other noise distributions and transforming data</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#reference-15"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-on-one-or-two-groups.html"><a href="metric-predicted-variable-on-one-or-two-groups.html#session-info-15"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html"><i class="fa fa-check"></i><b>17</b> Metric Predicted Variable with One Metric Predictor</a><ul>
<li class="chapter" data-level="17.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#simple-linear-regression"><i class="fa fa-check"></i><b>17.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="17.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression"><i class="fa fa-check"></i><b>17.2</b> Robust linear regression</a><ul>
<li class="chapter" data-level="17.2.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-jags-brms."><i class="fa fa-check"></i><b>17.2.1</b> Robust linear regression in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.2.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#robust-linear-regression-in-stan."><i class="fa fa-check"></i><b>17.2.2</b> Robust linear regression in Stan.</a></li>
<li class="chapter" data-level="17.2.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#stan-or-jags"><i class="fa fa-check"></i><b>17.2.3</b> Stan or JAGS?</a></li>
<li class="chapter" data-level="17.2.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#interpreting-the-posterior-distribution."><i class="fa fa-check"></i><b>17.2.4</b> Interpreting the posterior distribution.</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#hierarchical-regression-on-individuals-within-groups"><i class="fa fa-check"></i><b>17.3</b> Hierarchical regression on individuals within groups</a><ul>
<li class="chapter" data-level="17.3.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>17.3.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="17.3.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#the-posterior-distribution-shrinkage-and-prediction."><i class="fa fa-check"></i><b>17.3.2</b> The posterior distribution: Shrinkage and prediction.</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#quadratic-trend-and-weighted-data"><i class="fa fa-check"></i><b>17.4</b> Quadratic trend and weighted data</a><ul>
<li class="chapter" data-level="17.4.1" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#results-and-interpretation."><i class="fa fa-check"></i><b>17.4.1</b> Results and interpretation.</a></li>
<li class="chapter" data-level="17.4.2" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#further-extensions."><i class="fa fa-check"></i><b>17.4.2</b> Further extensions.</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#procedure-and-perils-for-expanding-a-model"><i class="fa fa-check"></i><b>17.5</b> Procedure and perils for expanding a model</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#reference-16"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-metric-predictor.html"><a href="metric-predicted-variable-with-one-metric-predictor.html#session-info-16"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html"><i class="fa fa-check"></i><b>18</b> Metric Predicted Variable with Multiple Metric Predictors</a><ul>
<li class="chapter" data-level="18.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiple-linear-regression"><i class="fa fa-check"></i><b>18.1</b> Multiple linear regression</a><ul>
<li class="chapter" data-level="18.1.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-perils-of-correlated-predictors."><i class="fa fa-check"></i><b>18.1.1</b> The perils of correlated predictors.</a></li>
<li class="chapter" data-level="18.1.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-model-and-implementation."><i class="fa fa-check"></i><b>18.1.2</b> The model and implementation.</a></li>
<li class="chapter" data-level="18.1.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#the-posterior-distribution."><i class="fa fa-check"></i><b>18.1.3</b> The posterior distribution.</a></li>
<li class="chapter" data-level="18.1.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#redundant-predictors."><i class="fa fa-check"></i><b>18.1.4</b> Redundant predictors.</a></li>
<li class="chapter" data-level="18.1.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#informative-priors-sparse-data-and-correlated-predictors."><i class="fa fa-check"></i><b>18.1.5</b> Informative priors, sparse data, and correlated predictors.</a></li>
</ul></li>
<li class="chapter" data-level="18.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#multiplicative-interaction-of-metric-predictors"><i class="fa fa-check"></i><b>18.2</b> Multiplicative interaction of metric predictors</a><ul>
<li class="chapter" data-level="18.2.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#an-example."><i class="fa fa-check"></i><b>18.2.1</b> An example.</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#shrinkage-of-regression-coefficients"><i class="fa fa-check"></i><b>18.3</b> Shrinkage of regression coefficients</a></li>
<li class="chapter" data-level="18.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection"><i class="fa fa-check"></i><b>18.4</b> Variable selection</a><ul>
<li class="chapter" data-level="18.4.1" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#inclusion-probability-is-strongly-affected-by-vagueness-of-prior."><i class="fa fa-check"></i><b>18.4.1</b> Inclusion probability is strongly affected by vagueness of prior.</a></li>
<li class="chapter" data-level="18.4.2" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#variable-selection-with-hierarchical-shrinkage."><i class="fa fa-check"></i><b>18.4.2</b> Variable selection with hierarchical shrinkage.</a></li>
<li class="chapter" data-level="18.4.3" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#what-to-report-and-what-to-conclude."><i class="fa fa-check"></i><b>18.4.3</b> What to report and what to conclude.</a></li>
<li class="chapter" data-level="18.4.4" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-computational-methods."><i class="fa fa-check"></i><b>18.4.4</b> Caution: Computational methods.</a></li>
<li class="chapter" data-level="18.4.5" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#caution-interaction-variables."><i class="fa fa-check"></i><b>18.4.5</b> Caution: Interaction variables.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#reference-17"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#session-info-17"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-metric-predictors.html"><a href="metric-predicted-variable-with-multiple-metric-predictors.html#footnote"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html"><i class="fa fa-check"></i><b>19</b> Metric Predicted Variable with One Nominal Predictor</a><ul>
<li class="chapter" data-level="19.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#describing-multiple-groups-of-metric-data"><i class="fa fa-check"></i><b>19.1</b> Describing multiple groups of metric data</a></li>
<li class="chapter" data-level="19.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#traditional-analysis-of-variance"><i class="fa fa-check"></i><b>19.2</b> Traditional analysis of variance</a></li>
<li class="chapter" data-level="19.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#hierarchical-bayesian-approach"><i class="fa fa-check"></i><b>19.3</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="19.3.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#implementation-in-jags-brms."><i class="fa fa-check"></i><b>19.3.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="19.3.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-and-death."><i class="fa fa-check"></i><b>19.3.2</b> Example: Sex and death.</a></li>
<li class="chapter" data-level="19.3.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#contrasts."><i class="fa fa-check"></i><b>19.3.3</b> Contrasts.</a></li>
<li class="chapter" data-level="19.3.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#multiple-comparisons-and-shrinkage."><i class="fa fa-check"></i><b>19.3.4</b> Multiple comparisons and shrinkage.</a></li>
<li class="chapter" data-level="19.3.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#the-two-group-case."><i class="fa fa-check"></i><b>19.3.5</b> The two-group case.</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#including-a-metric-predictor"><i class="fa fa-check"></i><b>19.4</b> Including a metric predictor</a><ul>
<li class="chapter" data-level="19.4.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-sex-death-and-size."><i class="fa fa-check"></i><b>19.4.1</b> Example: Sex, death, and size.</a></li>
<li class="chapter" data-level="19.4.2" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#analogous-to-traditional-ancova."><i class="fa fa-check"></i><b>19.4.2</b> Analogous to traditional ANCOVA.</a></li>
<li class="chapter" data-level="19.4.3" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#relation-to-hierarchical-linear-regression."><i class="fa fa-check"></i><b>19.4.3</b> Relation to hierarchical linear regression.</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#heterogeneous-variances-and-robustness-against-outliers"><i class="fa fa-check"></i><b>19.5</b> Heterogeneous variances and robustness against outliers</a><ul>
<li class="chapter" data-level="19.5.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#example-contrast-of-means-with-different-variances."><i class="fa fa-check"></i><b>19.5.1</b> Example: Contrast of means with different variances.</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#exercises-walk-out-an-effect-size"><i class="fa fa-check"></i><b>19.6</b> <del>Exercises</del> Walk out an effect size</a><ul>
<li class="chapter" data-level="19.6.1" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#populations-and-samples."><i class="fa fa-check"></i><b>19.6.1</b> Populations and samples.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#reference-18"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-one-nominal-predictor.html"><a href="metric-predicted-variable-with-one-nominal-predictor.html#session-info-18"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html"><i class="fa fa-check"></i><b>20</b> Metric Predicted Variable with Multiple Nominal Predictors</a><ul>
<li class="chapter" data-level="20.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#describing-groups-of-metric-data-with-multiple-nominal-predictors"><i class="fa fa-check"></i><b>20.1</b> Describing groups of metric data with multiple nominal predictors</a><ul>
<li class="chapter" data-level="20.1.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction."><i class="fa fa-check"></i><b>20.1.1</b> Interaction.</a></li>
<li class="chapter" data-level="20.1.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#traditional-anova."><i class="fa fa-check"></i><b>20.1.2</b> Traditional ANOVA.</a></li>
</ul></li>
<li class="chapter" data-level="20.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#hierarchical-bayesian-approach-1"><i class="fa fa-check"></i><b>20.2</b> Hierarchical Bayesian approach</a><ul>
<li class="chapter" data-level="20.2.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>20.2.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="20.2.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#example-its-only-money."><i class="fa fa-check"></i><b>20.2.2</b> Example: It’s only money.</a></li>
<li class="chapter" data-level="20.2.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#main-effect-contrasts."><i class="fa fa-check"></i><b>20.2.3</b> Main effect contrasts.</a></li>
<li class="chapter" data-level="20.2.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#interaction-contrasts-and-simple-effects."><i class="fa fa-check"></i><b>20.2.4</b> Interaction contrasts and simple effects.</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#rescaling-can-change-interactions-homogeneity-and-normality"><i class="fa fa-check"></i><b>20.3</b> Rescaling can change interactions, homogeneity, and normality</a></li>
<li class="chapter" data-level="20.4" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#heterogeneous-variances-and-robustness-against-outliers-1"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous variances and robustness against outliers</a></li>
<li class="chapter" data-level="20.5" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#within-subject-designs"><i class="fa fa-check"></i><b>20.5</b> Within-subject designs</a><ul>
<li class="chapter" data-level="20.5.1" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#why-use-a-within-subject-design-and-why-not"><i class="fa fa-check"></i><b>20.5.1</b> Why use a within-subject design? And why not?</a></li>
<li class="chapter" data-level="20.5.2" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#split-plot-design."><i class="fa fa-check"></i><b>20.5.2</b> Split-plot design.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#reference-19"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#session-info-19"><i class="fa fa-check"></i>Session info</a></li>
<li class="chapter" data-level="" data-path="metric-predicted-variable-with-multiple-nominal-predictors.html"><a href="metric-predicted-variable-with-multiple-nominal-predictors.html#footnote-1"><i class="fa fa-check"></i>Footnote</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html"><i class="fa fa-check"></i><b>21</b> Dichotomous Predicted Variable</a><ul>
<li class="chapter" data-level="21.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-metric-predictors"><i class="fa fa-check"></i><b>21.1</b> Multiple metric predictors</a><ul>
<li class="chapter" data-level="21.1.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#the-model-and-implementation-in-jags-brms.-1"><i class="fa fa-check"></i><b>21.1.1</b> The model and implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="21.1.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#example-height-weight-and-gender."><i class="fa fa-check"></i><b>21.1.2</b> Example: Height, weight, and gender.</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interpreting-the-regression-coefficients"><i class="fa fa-check"></i><b>21.2</b> Interpreting the regression coefficients</a><ul>
<li class="chapter" data-level="21.2.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#log-odds."><i class="fa fa-check"></i><b>21.2.1</b> Log odds.</a></li>
<li class="chapter" data-level="21.2.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#when-there-are-few-1s-or-0s-in-the-data."><i class="fa fa-check"></i><b>21.2.2</b> When there are few 1’s or 0’s in the data.</a></li>
<li class="chapter" data-level="21.2.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#correlated-predictors."><i class="fa fa-check"></i><b>21.2.3</b> Correlated predictors.</a></li>
<li class="chapter" data-level="21.2.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#interaction-of-metric-predictors."><i class="fa fa-check"></i><b>21.2.4</b> Interaction of metric predictors.</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#robust-logistic-regression"><i class="fa fa-check"></i><b>21.3</b> Robust logistic regression</a></li>
<li class="chapter" data-level="21.4" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#nominal-predictors"><i class="fa fa-check"></i><b>21.4</b> Nominal predictors</a><ul>
<li class="chapter" data-level="21.4.1" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#single-group."><i class="fa fa-check"></i><b>21.4.1</b> Single group.</a></li>
<li class="chapter" data-level="21.4.2" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#multiple-groups."><i class="fa fa-check"></i><b>21.4.2</b> Multiple groups.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#reference-20"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="dichotomous-predicted-variable.html"><a href="dichotomous-predicted-variable.html#session-info-20"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html"><i class="fa fa-check"></i><b>22</b> Nominal Predicted Variable</a><ul>
<li class="chapter" data-level="22.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-regression"><i class="fa fa-check"></i><b>22.1</b> Softmax regression</a><ul>
<li class="chapter" data-level="22.1.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-reduces-to-logistic-for-two-outcomes."><i class="fa fa-check"></i><b>22.1.1</b> Softmax reduces to logistic for two outcomes.</a></li>
<li class="chapter" data-level="22.1.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#independence-from-irrelevant-attributes."><i class="fa fa-check"></i><b>22.1.2</b> Independence from irrelevant attributes.</a></li>
</ul></li>
<li class="chapter" data-level="22.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-regression"><i class="fa fa-check"></i><b>22.2</b> Conditional logistic regression</a></li>
<li class="chapter" data-level="22.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#implementation-in-jags-brms"><i class="fa fa-check"></i><b>22.3</b> Implementation in <del>JAGS</del> brms</a><ul>
<li class="chapter" data-level="22.3.1" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#softmax-model."><i class="fa fa-check"></i><b>22.3.1</b> Softmax model.</a></li>
<li class="chapter" data-level="22.3.2" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#conditional-logistic-model."><i class="fa fa-check"></i><b>22.3.2</b> Conditional logistic model.</a></li>
<li class="chapter" data-level="22.3.3" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#results-interpreting-the-regression-coefficients."><i class="fa fa-check"></i><b>22.3.3</b> Results: Interpreting the regression coefficients.</a></li>
</ul></li>
<li class="chapter" data-level="22.4" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#generalizations-and-variations-of-the-models"><i class="fa fa-check"></i><b>22.4</b> Generalizations and variations of the models</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#reference-21"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="nominal-predicted-variable.html"><a href="nominal-predicted-variable.html#session-info-21"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html"><i class="fa fa-check"></i><b>23</b> Ordinal Predicted Variable</a><ul>
<li class="chapter" data-level="23.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#modeling-ordinal-data-with-an-underlying-metric-variable"><i class="fa fa-check"></i><b>23.1</b> Modeling ordinal data with an underlying metric variable</a></li>
<li class="chapter" data-level="23.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-a-single-group"><i class="fa fa-check"></i><b>23.2</b> The case of a single group</a><ul>
<li class="chapter" data-level="23.2.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-3"><i class="fa fa-check"></i><b>23.2.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.2.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-bayesian-estimation-recovers-true-parameter-values."><i class="fa fa-check"></i><b>23.2.2</b> Examples: Bayesian estimation recovers true parameter values.</a></li>
</ul></li>
<li class="chapter" data-level="23.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-two-groups"><i class="fa fa-check"></i><b>23.3</b> The case of two groups</a><ul>
<li class="chapter" data-level="23.3.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-4"><i class="fa fa-check"></i><b>23.3.1</b> Implementation in <del>JAGS</del> <strong>brms</strong>.</a></li>
<li class="chapter" data-level="23.3.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#examples-not-funny."><i class="fa fa-check"></i><b>23.3.2</b> Examples: Not funny.</a></li>
</ul></li>
<li class="chapter" data-level="23.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#the-case-of-metric-predictors"><i class="fa fa-check"></i><b>23.4</b> The Case of metric predictors</a><ul>
<li class="chapter" data-level="23.4.1" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#implementation-in-jags-brms.-5"><i class="fa fa-check"></i><b>23.4.1</b> Implementation in <del>JAGS</del> brms.</a></li>
<li class="chapter" data-level="23.4.2" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-happiness-and-money."><i class="fa fa-check"></i><b>23.4.2</b> Example: Happiness and money.</a></li>
<li class="chapter" data-level="23.4.3" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#example-moviesthey-dont-make-em-like-they-used-to."><i class="fa fa-check"></i><b>23.4.3</b> Example: Movies–They don’t make ’em like they used to.</a></li>
<li class="chapter" data-level="23.4.4" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#why-are-some-thresholds-outside-the-data"><i class="fa fa-check"></i><b>23.4.4</b> Why are some thresholds outside the data?</a></li>
</ul></li>
<li class="chapter" data-level="23.5" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#posterior-prediction"><i class="fa fa-check"></i><b>23.5</b> Posterior prediction</a></li>
<li class="chapter" data-level="23.6" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#generalizations-and-extensions"><i class="fa fa-check"></i><b>23.6</b> Generalizations and extensions</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#reference-22"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="ordinal-predicted-variable.html"><a href="ordinal-predicted-variable.html#session-info-22"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html"><i class="fa fa-check"></i><b>24</b> Count Predicted Variable</a><ul>
<li class="chapter" data-level="24.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-exponential-model"><i class="fa fa-check"></i><b>24.1</b> Poisson exponential model</a><ul>
<li class="chapter" data-level="24.1.1" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#data-structure."><i class="fa fa-check"></i><b>24.1.1</b> Data structure.</a></li>
<li class="chapter" data-level="24.1.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#exponential-link-function."><i class="fa fa-check"></i><b>24.1.2</b> Exponential link function.</a></li>
<li class="chapter" data-level="24.1.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#poisson-noise-distribution."><i class="fa fa-check"></i><b>24.1.3</b> Poisson noise distribution.</a></li>
<li class="chapter" data-level="24.1.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#the-complete-model-and-implementation-in-jags-brms."><i class="fa fa-check"></i><b>24.1.4</b> The complete model and implementation in <del>JAGS</del> brms.</a></li>
</ul></li>
<li class="chapter" data-level="24.2" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-hair-eye-go-again"><i class="fa fa-check"></i><b>24.2</b> Example: Hair eye go again</a></li>
<li class="chapter" data-level="24.3" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#example-interaction-contrasts-shrinkage-and-omnibus-test"><i class="fa fa-check"></i><b>24.3</b> Example: Interaction contrasts, shrinkage, and omnibus test</a></li>
<li class="chapter" data-level="24.4" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#log-linear-models-for-contingency-tables-bonus-alternative-parameterization"><i class="fa fa-check"></i><b>24.4</b> <del>Log-linear models for contingency tables</del> Bonus: Alternative parameterization</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#reference-23"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="count-predicted-variable.html"><a href="count-predicted-variable.html#session-info-23"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html"><i class="fa fa-check"></i><b>25</b> Tools in the Trunk</a><ul>
<li class="chapter" data-level="25.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reporting-a-bayesian-analysis"><i class="fa fa-check"></i><b>25.1</b> Reporting a Bayesian analysis</a><ul>
<li class="chapter" data-level="25.1.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#essential-points."><i class="fa fa-check"></i><b>25.1.1</b> Essential points.</a></li>
<li class="chapter" data-level="25.1.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#optional-points."><i class="fa fa-check"></i><b>25.1.2</b> Optional points.</a></li>
<li class="chapter" data-level="25.1.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#helpful-points."><i class="fa fa-check"></i><b>25.1.3</b> Helpful points.</a></li>
</ul></li>
<li class="chapter" data-level="25.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#functions-for-computing-highest-density-intervals"><i class="fa fa-check"></i><b>25.2</b> Functions for computing highest density intervals</a><ul>
<li class="chapter" data-level="25.2.1" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-grid-approximation."><i class="fa fa-check"></i><b>25.2.1</b> R code for computing HDI of a grid approximation.</a></li>
<li class="chapter" data-level="25.2.2" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#hdi-of-unimodal-distribution-is-shortest-interval."><i class="fa fa-check"></i><b>25.2.2</b> HDI of unimodal distribution is shortest interval.</a></li>
<li class="chapter" data-level="25.2.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-mcmc-sample."><i class="fa fa-check"></i><b>25.2.3</b> R code for computing HDI of a MCMC sample.</a></li>
<li class="chapter" data-level="25.2.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#r-code-for-computing-hdi-of-a-function."><i class="fa fa-check"></i><b>25.2.4</b> R code for computing HDI of a function.</a></li>
</ul></li>
<li class="chapter" data-level="25.3" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reparameterization"><i class="fa fa-check"></i><b>25.3</b> Reparameterization</a></li>
<li class="chapter" data-level="25.4" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#censored-data-in-jags-brms"><i class="fa fa-check"></i><b>25.4</b> Censored Data in <del>JAGS</del> brms</a></li>
<li class="chapter" data-level="25.5" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#what-next"><i class="fa fa-check"></i><b>25.5</b> What Next?</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#reference-24"><i class="fa fa-check"></i>Reference</a></li>
<li class="chapter" data-level="" data-path="tools-in-the-trunk.html"><a href="tools-in-the-trunk.html#session-info-24"><i class="fa fa-check"></i>Session info</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><em>Doing Bayesian Data Analysis</em> in brms and the tidyverse</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ordinal-predicted-variable" class="section level1">
<h1><span class="header-section-number">23</span> Ordinal Predicted Variable</h1>
<blockquote>
<p>This chapter considers data that have an ordinal predicted variable. For example, we might want to predict people’s happiness ratings on a 1-to-7 scale as a function of their total financial assets. Or we might want to predict ratings of movies as a function of the year they were made.</p>
<p>One traditional treatment of this sort of data structure is called <em>ordinal or ordered probit regression</em>. We will consider a Bayesian approach to this model. As usual, in Bayesian software, it is easy to generalize the traditional model so it is robust to outliers, allows different variances within levels of a nominal predictor, or has hierarchical structure to share information across levels or factors as appropriate.</p>
<p>In the context of the generalized linear model (GLM) introduced in Chapter 15, this chapter’s situation involves an inverse-link function that is a thresholded cumulative normal with a categorical distribution for describing noise in the data, as indicated in the fourth row of Table 15.2 (p. 443). For a reminder of how this chapter’s combination of predicted and predictor variables relates to other combinations, see Table 15.3 (p. 444). (p. 671, <em>emphasis</em> in the original)</p>
</blockquote>
<p>We might follow Kruschke’s advice and rewind a little before tackling this chapter. The cumulative normal function is denoted <span class="math inline">\(\Phi(x; \mu, \sigma)\)</span>, where <span class="math inline">\(x\)</span> is some real number and <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> have their typical meaning. The function is cumulative in that it produces values ranging from zero to 1. Figure 15.8 showed an example of the normal distribution atop of the cumulative normal. Here it is, again.</p>
<div class="sourceCode" id="cb2028"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2028-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb2028-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2028-3" data-line-number="3">d &lt;-</a>
<a class="sourceLine" id="cb2028-4" data-line-number="4"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">z =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2028-5" data-line-number="5"><span class="st">  </span><span class="co"># add the density values</span></a>
<a class="sourceLine" id="cb2028-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(z)</span><span class="st">`</span>   =<span class="st"> </span><span class="kw">dnorm</span>(z, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2028-7" data-line-number="7">         <span class="co"># add the CDF values</span></a>
<a class="sourceLine" id="cb2028-8" data-line-number="8">         <span class="st">`</span><span class="dt">Phi(z)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">pnorm</span>(z, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb2028-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2028-10" data-line-number="10"><span class="kw">head</span>(d)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##       z  `p(z)` `Phi(z)`
##   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
## 1  -3   0.00443  0.00135
## 2  -2.9 0.00595  0.00187
## 3  -2.8 0.00792  0.00256
## 4  -2.7 0.0104   0.00347
## 5  -2.6 0.0136   0.00466
## 6  -2.5 0.0175   0.00621</code></pre>
<p>Make the plot.</p>
<div class="sourceCode" id="cb2030"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2030-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb2030-2" data-line-number="2"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2030-3" data-line-number="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2030-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(z <span class="op">&lt;=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2030-5" data-line-number="5">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="st">`</span><span class="dt">p(z)</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb2030-6" data-line-number="6">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2030-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="st">`</span><span class="dt">p(z)</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb2030-8" data-line-number="8">            <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2030-9" data-line-number="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Normal Density&quot;</span>,</a>
<a class="sourceLine" id="cb2030-10" data-line-number="10">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">p</span>(<span class="kw">italic</span>(z)))) </a>
<a class="sourceLine" id="cb2030-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2030-12" data-line-number="12">p2 &lt;-</a>
<a class="sourceLine" id="cb2030-13" data-line-number="13"><span class="st">  </span>d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2030-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> z)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2030-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> . <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(z <span class="op">&lt;=</span><span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2030-16" data-line-number="16">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> <span class="st">`</span><span class="dt">Phi(z)</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb2030-17" data-line-number="17">              <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2030-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="st">`</span><span class="dt">Phi(z)</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb2030-19" data-line-number="19">            <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2030-20" data-line-number="20"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Cumulative Normal&quot;</span>,</a>
<a class="sourceLine" id="cb2030-21" data-line-number="21">       <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">Phi</span>(<span class="kw">italic</span>(z))))</a>
<a class="sourceLine" id="cb2030-22" data-line-number="22"></a>
<a class="sourceLine" id="cb2030-23" data-line-number="23"><span class="co"># combine and adjust with patchwork</span></a>
<a class="sourceLine" id="cb2030-24" data-line-number="24"><span class="kw">library</span>(patchwork)</a>
<a class="sourceLine" id="cb2030-25" data-line-number="25"></a>
<a class="sourceLine" id="cb2030-26" data-line-number="26">p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2030-27" data-line-number="27"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2030-28" data-line-number="28"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>)) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2030-29" data-line-number="29"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) </a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /></p>
<p>For both plots, <code>z</code> is in a standardized metric (i.e., <span class="math inline">\(z\)</span>-score). With the cumulative normal function, the cumulative probability <span class="math inline">\(\Phi(z)\)</span> increases nonlinearly with the <span class="math inline">\(z\)</span>-scores such that, much like with the logistic curve, the greatest change occurs around <span class="math inline">\(z = 0\)</span> and tapers off in the tails.</p>
<p>The inverse of <span class="math inline">\(\Phi(x)\)</span> is the <em>probit</em> function. As indicated in the above block quote, we’ll be making extensive use of the probit function in this chapter for our Bayesian models.</p>
<div id="modeling-ordinal-data-with-an-underlying-metric-variable" class="section level2">
<h2><span class="header-section-number">23.1</span> Modeling ordinal data with an underlying metric variable</h2>
<blockquote>
<p>You can imagine that the distribution of ordinal values might not resemble a normal distribution, even though the underlying metric values are normally distributed. Figure 23.1 shows some examples of ordinal outcome probabilities generated from an underlying normal distribution. The horizontal axis is the underlying continuous metric value. Thresholds are plotted as vertical dashed lines, labeled <span class="math inline">\(\theta\)</span>. In all examples, the ordinal scale has 7 levels, and hence, there are 6 thresholds. The lowest threshold is set at <span class="math inline">\(\theta_1 = 1.5\)</span> (to separate outcomes 1 and 2), and the highest threshold is set at <span class="math inline">\(\theta_1 = 6.5\)</span> (to separate outcomes 6 and 7). The normal curve in each panel shows the distribution of underlying continuous values. What differs across panels are the settings of means, standard deviations, and remaining thresholds. (p. 672)</p>
</blockquote>
<p>The various Figure 23.1 subplots require a lot of ins and outs. We’ll start with the top panel and build from there. Here is how we might make the values necessary for the density curve.</p>
<div class="sourceCode" id="cb2031"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2031-1" data-line-number="1">den &lt;-</a>
<a class="sourceLine" id="cb2031-2" data-line-number="2"><span class="st">  </span><span class="co"># define the parameters for the underlying normal distribution</span></a>
<a class="sourceLine" id="cb2031-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">mu    =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2031-4" data-line-number="4">         <span class="dt">sigma =</span> <span class="fl">1.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2031-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strip =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu==&quot;</span>, mu, <span class="st">&quot;~~sigma==&quot;</span>, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2031-6" data-line-number="6"><span class="st">  </span><span class="co"># this will allow us to rescale the density in terms of the bar plot</span></a>
<a class="sourceLine" id="cb2031-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">multiplier =</span> <span class="dv">26</span> <span class="op">/</span><span class="st"> </span><span class="kw">dnorm</span>(mu, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2031-8" data-line-number="8"><span class="st">  </span><span class="co"># we need values for the x-axis</span></a>
<a class="sourceLine" id="cb2031-9" data-line-number="9"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(mu, sigma, strip, multiplier),</a>
<a class="sourceLine" id="cb2031-10" data-line-number="10">         <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-1</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2031-11" data-line-number="11"><span class="st">  </span><span class="co"># compute the density values</span></a>
<a class="sourceLine" id="cb2031-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(y, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2031-13" data-line-number="13"><span class="st">  </span><span class="co"># use that multiplier value from above to rescale the density values</span></a>
<a class="sourceLine" id="cb2031-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> density <span class="op">*</span><span class="st"> </span>multiplier)</a>
<a class="sourceLine" id="cb2031-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2031-16" data-line-number="16"><span class="kw">head</span>(den)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##      mu sigma strip             multiplier     y density percent
##   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;                  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     4   1.5 mu==4~~sigma==1.5       97.8  -1   0.00103   0.101
## 2     4   1.5 mu==4~~sigma==1.5       97.8  -0.9 0.00128   0.125
## 3     4   1.5 mu==4~~sigma==1.5       97.8  -0.8 0.00159   0.155
## 4     4   1.5 mu==4~~sigma==1.5       97.8  -0.7 0.00196   0.192
## 5     4   1.5 mu==4~~sigma==1.5       97.8  -0.6 0.00241   0.236
## 6     4   1.5 mu==4~~sigma==1.5       97.8  -0.5 0.00295   0.289</code></pre>
<p>Before making the data for the bar portion of the plot, we’ll need to define the <span class="math inline">\(\theta\)</span>-values they’ll be placed between. We also need to define the exact points on the x-axis from which we’d like those bars to originate. Those points, which we’ll call <code>label_1</code>, will double as names for the individual bars.</p>
<div class="sourceCode" id="cb2033"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2033-1" data-line-number="1">(theta_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">1.5</span>, <span class="dt">to =</span> <span class="fl">6.5</span>, <span class="dt">by =</span> <span class="dv">1</span>))</a></code></pre></div>
<pre><code>## [1] 1.5 2.5 3.5 4.5 5.5 6.5</code></pre>
<div class="sourceCode" id="cb2035"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2035-1" data-line-number="1">(label_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">7</span>)</a></code></pre></div>
<pre><code>## [1] 1 2 3 4 5 6 7</code></pre>
<p>Now we can define the data for the bars.</p>
<div class="sourceCode" id="cb2037"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2037-1" data-line-number="1">bar &lt;-</a>
<a class="sourceLine" id="cb2037-2" data-line-number="2"><span class="st">  </span><span class="co"># define the parameters for the underlying normal distribution</span></a>
<a class="sourceLine" id="cb2037-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">mu    =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2037-4" data-line-number="4">         <span class="dt">sigma =</span> <span class="fl">1.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strip =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu==&quot;</span>, mu, <span class="st">&quot;~~sigma==&quot;</span>, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-6" data-line-number="6"><span class="st">  </span><span class="co"># take random draws from the underlying normal distribution</span></a>
<a class="sourceLine" id="cb2037-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">draw =</span> <span class="kw">map2</span>(mu, sigma, <span class="op">~</span><span class="kw">rnorm</span>(<span class="fl">1e4</span>, <span class="dt">mean =</span> .x, <span class="dt">sd =</span> .y))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-8" data-line-number="8"><span class="st">  </span><span class="kw">unnest</span>(draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-9" data-line-number="9"><span class="st">  </span><span class="co"># bin those draws into ordinal categories defined by `theta_1`</span></a>
<a class="sourceLine" id="cb2037-10" data-line-number="10"><span class="st">  </span><span class="co"># and named by `label_1`</span></a>
<a class="sourceLine" id="cb2037-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb2037-12" data-line-number="12">    draw  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">1</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2037-13" data-line-number="13">    draw  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">2</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2037-14" data-line-number="14">    draw  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">3</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2037-15" data-line-number="15">    draw  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">4</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2037-16" data-line-number="16">    draw  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">5</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2037-17" data-line-number="17">    draw  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2037-18" data-line-number="18">    draw <span class="op">&gt;=</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2037-19" data-line-number="19">  )) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-20" data-line-number="20"><span class="st">  </span><span class="co"># summarize</span></a>
<a class="sourceLine" id="cb2037-21" data-line-number="21"><span class="st">  </span><span class="kw">count</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-22" data-line-number="22"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> (<span class="dv">100</span> <span class="op">*</span><span class="st"> </span>n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>))   <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2037-23" data-line-number="23"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent_label =</span> <span class="kw">str_c</span>(percent, <span class="st">&quot;%&quot;</span>),</a>
<a class="sourceLine" id="cb2037-24" data-line-number="24">         <span class="dt">percent_max   =</span> <span class="kw">max</span>(percent))</a>
<a class="sourceLine" id="cb2037-25" data-line-number="25"></a>
<a class="sourceLine" id="cb2037-26" data-line-number="26"><span class="kw">head</span>(bar)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##       y     n percent percent_label percent_max
##   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1     1   484       5 5%                     26
## 2     2  1094      11 11%                    26
## 3     3  2225      22 22%                    26
## 4     4  2571      26 26%                    26
## 5     5  2106      21 21%                    26
## 6     6  1047      10 10%                    26</code></pre>
<p>Make the top subplot.</p>
<div class="sourceCode" id="cb2039"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2039-1" data-line-number="1">bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2039-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> den,</a>
<a class="sourceLine" id="cb2039-4" data-line-number="4">              <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> percent),</a>
<a class="sourceLine" id="cb2039-5" data-line-number="5">              <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> theta_<span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">y =</span> percent),</a>
<a class="sourceLine" id="cb2039-8" data-line-number="8">           <span class="dt">width =</span> <span class="fl">.5</span>, <span class="dt">alpha =</span> <span class="fl">.85</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> percent <span class="op">+</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">label =</span> percent_label),</a>
<a class="sourceLine" id="cb2039-10" data-line-number="10">            <span class="dt">size =</span> <span class="fl">3.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-11" data-line-number="11"><span class="st">  </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> theta_<span class="dv">1</span>, <span class="dt">y =</span> <span class="fl">-6.5</span>,</a>
<a class="sourceLine" id="cb2039-12" data-line-number="12">           <span class="dt">label =</span> theta_<span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb2039-14" data-line-number="14">                     <span class="dt">breaks =</span> theta_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2039-15" data-line-number="15">                     <span class="dt">labels =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="st">&quot;]&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-17" data-line-number="17"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">28.5</span>), <span class="dt">clip =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb2039-19" data-line-number="19">        <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="dv">11</span>, <span class="fl">5.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2039-20" data-line-number="20"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strip, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-7-1.png" style="display: block; margin: auto;" /></p>
<p>This method works okay for plotting one or two panels. The sheer number of code lines and moving parts seem unwieldy for plotting four. It’d be convenient if we could save the density information for all four panels in one data object. Here’s one way how.</p>
<div class="sourceCode" id="cb2040"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2040-1" data-line-number="1">den &lt;-</a>
<a class="sourceLine" id="cb2040-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">panel =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2040-3" data-line-number="3">         <span class="dt">mu    =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb2040-4" data-line-number="4">         <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2040-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strip =</span> <span class="kw">factor</span>(panel,</a>
<a class="sourceLine" id="cb2040-6" data-line-number="6">                        <span class="dt">labels  =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu==&quot;</span>, mu, <span class="st">&quot;~~sigma==&quot;</span>, sigma),</a>
<a class="sourceLine" id="cb2040-7" data-line-number="7">                        <span class="dt">ordered =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2040-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">multiplier =</span> <span class="kw">c</span>(<span class="dv">26</span>, <span class="dv">58</span>, <span class="dv">24</span>, <span class="dv">26</span>) <span class="op">/</span><span class="st"> </span><span class="kw">dnorm</span>(mu, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2040-9" data-line-number="9"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(panel, mu, sigma, strip, multiplier),</a>
<a class="sourceLine" id="cb2040-10" data-line-number="10">         <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-1</span>, <span class="dt">to =</span> <span class="dv">9</span>, <span class="dt">by =</span> <span class="fl">.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2040-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(y, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2040-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> density <span class="op">*</span><span class="st"> </span>multiplier)</a>
<a class="sourceLine" id="cb2040-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2040-14" data-line-number="14"><span class="kw">head</span>(den)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   panel    mu sigma strip             multiplier     y density percent
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;ord&gt;                  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
## 1     1     4   1.5 mu==4~~sigma==1.5       97.8  -1   0.00103   0.101
## 2     1     4   1.5 mu==4~~sigma==1.5       97.8  -0.9 0.00128   0.125
## 3     1     4   1.5 mu==4~~sigma==1.5       97.8  -0.8 0.00159   0.155
## 4     1     4   1.5 mu==4~~sigma==1.5       97.8  -0.7 0.00196   0.192
## 5     1     4   1.5 mu==4~~sigma==1.5       97.8  -0.6 0.00241   0.236
## 6     1     4   1.5 mu==4~~sigma==1.5       97.8  -0.5 0.00295   0.289</code></pre>
<p>Notice we added a <code>panel</code> column for indexing the subplots. Next we’ll need to define <code>theta_[i]</code> and <code>label_[i]</code> values for the remaining plots.</p>
<div class="sourceCode" id="cb2042"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2042-1" data-line-number="1">theta_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">3.1</span>, <span class="fl">3.7</span>, <span class="fl">4.3</span>, <span class="fl">4.9</span>, <span class="fl">6.5</span>)</a>
<a class="sourceLine" id="cb2042-2" data-line-number="2">theta_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">2.25</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="fl">5.75</span>, <span class="fl">6.5</span>)</a>
<a class="sourceLine" id="cb2042-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2042-4" data-line-number="4">label_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">2.2</span>, <span class="fl">3.4</span>, <span class="dv">4</span>, <span class="fl">4.6</span>, <span class="fl">5.7</span>, <span class="dv">7</span>)</a>
<a class="sourceLine" id="cb2042-5" data-line-number="5">label_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.875</span>, <span class="fl">2.625</span>, <span class="dv">4</span>, <span class="fl">5.375</span>, <span class="fl">6.125</span>, <span class="dv">7</span>)</a></code></pre></div>
<p>Since the values are the same for the top two panels, we didn’t bother defining a <code>theta_2</code> or <code>label_2</code>. Now we have all the <code>theta_[i]</code> and <code>label_[i]</code> values, we’ll want to make a function that can use them within <code>case_when()</code> for any of the four panels. Here’s one way to make such a function, which we’ll call <code>make_ordinal()</code>.</p>
<div class="sourceCode" id="cb2043"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2043-1" data-line-number="1">make_ordinal &lt;-<span class="st"> </span><span class="cf">function</span>(x, panel) {</a>
<a class="sourceLine" id="cb2043-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb2043-3" data-line-number="3">  <span class="cf">if</span> (panel <span class="op">&lt;</span><span class="st"> </span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb2043-4" data-line-number="4">    </a>
<a class="sourceLine" id="cb2043-5" data-line-number="5">    <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb2043-6" data-line-number="6">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">1</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2043-7" data-line-number="7">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">2</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2043-8" data-line-number="8">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">3</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2043-9" data-line-number="9">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">4</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2043-10" data-line-number="10">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">5</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2043-11" data-line-number="11">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2043-12" data-line-number="12">      x <span class="op">&gt;=</span><span class="st"> </span>theta_<span class="dv">1</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">1</span>[<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2043-13" data-line-number="13">    )</a>
<a class="sourceLine" id="cb2043-14" data-line-number="14">    </a>
<a class="sourceLine" id="cb2043-15" data-line-number="15">  } <span class="cf">else</span> <span class="cf">if</span> (panel <span class="op">==</span><span class="st"> </span><span class="dv">3</span>) {</a>
<a class="sourceLine" id="cb2043-16" data-line-number="16">    </a>
<a class="sourceLine" id="cb2043-17" data-line-number="17">    <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb2043-18" data-line-number="18">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">1</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2043-19" data-line-number="19">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">2</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2043-20" data-line-number="20">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">3</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2043-21" data-line-number="21">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">4</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2043-22" data-line-number="22">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">5</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2043-23" data-line-number="23">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2043-24" data-line-number="24">      x <span class="op">&gt;=</span><span class="st"> </span>theta_<span class="dv">3</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">3</span>[<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2043-25" data-line-number="25">    )</a>
<a class="sourceLine" id="cb2043-26" data-line-number="26">    </a>
<a class="sourceLine" id="cb2043-27" data-line-number="27">  } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb2043-28" data-line-number="28">    </a>
<a class="sourceLine" id="cb2043-29" data-line-number="29">    <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb2043-30" data-line-number="30">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">1</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2043-31" data-line-number="31">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">2</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2043-32" data-line-number="32">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">3</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2043-33" data-line-number="33">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">4</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2043-34" data-line-number="34">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">5</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2043-35" data-line-number="35">      x  <span class="op">&lt;</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2043-36" data-line-number="36">      x <span class="op">&gt;=</span><span class="st"> </span>theta_<span class="dv">4</span>[<span class="dv">6</span>] <span class="op">~</span><span class="st"> </span>label_<span class="dv">4</span>[<span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2043-37" data-line-number="37">    )</a>
<a class="sourceLine" id="cb2043-38" data-line-number="38">   }</a>
<a class="sourceLine" id="cb2043-39" data-line-number="39">}</a></code></pre></div>
<p>Now put those values and our <code>make_ordinal()</code> function to work to make the data for the bar plots.</p>
<div class="sourceCode" id="cb2044"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2044-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2044-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2044-3" data-line-number="3">bar &lt;-</a>
<a class="sourceLine" id="cb2044-4" data-line-number="4"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">panel =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2044-5" data-line-number="5">         <span class="dt">mu    =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb2044-6" data-line-number="6">         <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">1</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strip =</span> <span class="kw">factor</span>(panel,</a>
<a class="sourceLine" id="cb2044-8" data-line-number="8">                        <span class="dt">labels  =</span> <span class="kw">str_c</span>(<span class="st">&quot;mu==&quot;</span>, mu, <span class="st">&quot;~~sigma==&quot;</span>, sigma),</a>
<a class="sourceLine" id="cb2044-9" data-line-number="9">                        <span class="dt">ordered =</span> T)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">draw =</span> <span class="kw">map2</span>(mu, sigma, <span class="op">~</span><span class="kw">rnorm</span>(<span class="fl">1e5</span>, <span class="dt">mean =</span> .x, <span class="dt">sd =</span> .y))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-11" data-line-number="11"><span class="st">  </span><span class="kw">unnest</span>(draw) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">y =</span> <span class="kw">map2_dbl</span>(draw, panel, make_ordinal)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-13" data-line-number="13"><span class="st">  </span><span class="kw">group_by</span>(panel, strip) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-14" data-line-number="14"><span class="st">  </span><span class="kw">count</span>(y) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-15" data-line-number="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> (<span class="dv">100</span> <span class="op">*</span><span class="st"> </span>n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dv">0</span>))   <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2044-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent_label =</span> <span class="kw">str_c</span>(percent, <span class="st">&quot;%&quot;</span>),</a>
<a class="sourceLine" id="cb2044-17" data-line-number="17">         <span class="dt">percent_max   =</span> <span class="kw">max</span>(percent))</a>
<a class="sourceLine" id="cb2044-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2044-19" data-line-number="19"><span class="kw">head</span>(bar)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 7
## # Groups:   panel, strip [1]
##   panel strip                 y     n percent percent_label percent_max
##   &lt;int&gt; &lt;ord&gt;             &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               &lt;dbl&gt;
## 1     1 mu==4~~sigma==1.5     1  4763       5 5%                     26
## 2     1 mu==4~~sigma==1.5     2 10844      11 11%                    26
## 3     1 mu==4~~sigma==1.5     3 21174      21 21%                    26
## 4     1 mu==4~~sigma==1.5     4 26256      26 26%                    26
## 5     1 mu==4~~sigma==1.5     5 21233      21 21%                    26
## 6     1 mu==4~~sigma==1.5     6 10951      11 11%                    26</code></pre>
<p>Like before, we added a <code>panel</code> index. As our final preparatory step, we will make something of a super function with which we’ll plug the desired information into <strong>ggplot2</strong>, which will then make each subplot. Much of the plotting and data wrangling code will be the same across subplots. As far as I can tell, we only need to vary four parameters. First, we’ll want to be able to subset the data by <code>panel</code> index. We’ll do that with the <code>panel_n</code> argument. Second, we’ll want to select which of the <code>theta_[i]</code> values we’d like to use in <code>geom_vline()</code>, <code>annotate()</code>, and <code>scale_x_continuous()</code>. We’ll do that with the <code>theta</code> argument. We’ll make a <code>y_second_x</code> to pin down exactly where below the x-axis we’d like to put those secondary axis values defined by the <code>theta_[i]</code> values. Finally, we’ll want an <code>ylim_ub</code> parameter to set the upper limit of the y-axis with. The name of our four-parameter super function will be <code>plot_bar_den()</code>.</p>
<div class="sourceCode" id="cb2046"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2046-1" data-line-number="1">plot_bar_den &lt;-<span class="st"> </span><span class="cf">function</span>(panel_n, theta, y_second_x, ylim_ub) {</a>
<a class="sourceLine" id="cb2046-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb2046-3" data-line-number="3">  bar <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2046-4" data-line-number="4"><span class="st">    </span><span class="kw">filter</span>(panel <span class="op">==</span><span class="st"> </span>panel_n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2046-5" data-line-number="5"><span class="st">    </span></a>
<a class="sourceLine" id="cb2046-6" data-line-number="6"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-7" data-line-number="7"><span class="st">    </span><span class="kw">geom_ribbon</span>(<span class="dt">data =</span> den <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(panel <span class="op">==</span><span class="st"> </span>panel_n),</a>
<a class="sourceLine" id="cb2046-8" data-line-number="8">                <span class="kw">aes</span>(<span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> percent),</a>
<a class="sourceLine" id="cb2046-9" data-line-number="9">                <span class="dt">fill =</span> <span class="st">&quot;grey75&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-10" data-line-number="10"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> theta, <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-11" data-line-number="11"><span class="st">    </span><span class="kw">geom_col</span>(<span class="kw">aes</span>(<span class="dt">y =</span> percent),</a>
<a class="sourceLine" id="cb2046-12" data-line-number="12">             <span class="dt">width =</span> <span class="fl">.5</span>, <span class="dt">alpha =</span> <span class="fl">.85</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-13" data-line-number="13"><span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y =</span> percent <span class="op">+</span><span class="st"> </span>(percent_max <span class="op">/</span><span class="st"> </span><span class="dv">15</span>), <span class="dt">label =</span> percent_label),</a>
<a class="sourceLine" id="cb2046-14" data-line-number="14">              <span class="dt">size =</span> <span class="fl">3.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-15" data-line-number="15"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> theta, <span class="dt">y =</span> y_second_x,</a>
<a class="sourceLine" id="cb2046-16" data-line-number="16">             <span class="dt">label =</span> theta, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-17" data-line-number="17"><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, </a>
<a class="sourceLine" id="cb2046-18" data-line-number="18">                       <span class="dt">breaks =</span> theta,</a>
<a class="sourceLine" id="cb2046-19" data-line-number="19">                       <span class="dt">labels =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="st">&quot;]&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-20" data-line-number="20"><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-21" data-line-number="21"><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, ylim_ub), </a>
<a class="sourceLine" id="cb2046-22" data-line-number="22">                    <span class="dt">clip =</span> F) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-23" data-line-number="23"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb2046-24" data-line-number="24">          <span class="dt">plot.margin =</span> <span class="kw">margin</span>(<span class="fl">5.5</span>, <span class="fl">5.5</span>, <span class="dv">11</span>, <span class="fl">5.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2046-25" data-line-number="25"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strip, <span class="dt">labeller =</span> label_parsed)</a>
<a class="sourceLine" id="cb2046-26" data-line-number="26">  </a>
<a class="sourceLine" id="cb2046-27" data-line-number="27">}</a></code></pre></div>
<p>Finally, make all four subplots and combine them with <strong>patchwork</strong> syntax!</p>
<div class="sourceCode" id="cb2047"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2047-1" data-line-number="1">p1 &lt;-<span class="st"> </span><span class="kw">plot_bar_den</span>(<span class="dt">panel_n    =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb2047-2" data-line-number="2">                   <span class="dt">theta      =</span> theta_<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb2047-3" data-line-number="3">                   <span class="dt">y_second_x =</span> <span class="fl">-6.75</span>, </a>
<a class="sourceLine" id="cb2047-4" data-line-number="4">                   <span class="dt">ylim_ub    =</span> <span class="dv">28</span>)</a>
<a class="sourceLine" id="cb2047-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2047-6" data-line-number="6">p2 &lt;-<span class="st"> </span><span class="kw">plot_bar_den</span>(<span class="dt">panel_n    =</span> <span class="dv">2</span>, </a>
<a class="sourceLine" id="cb2047-7" data-line-number="7">                   <span class="dt">theta      =</span> theta_<span class="dv">1</span>, </a>
<a class="sourceLine" id="cb2047-8" data-line-number="8">                   <span class="dt">y_second_x =</span> <span class="fl">-15.5</span>, </a>
<a class="sourceLine" id="cb2047-9" data-line-number="9">                   <span class="dt">ylim_ub    =</span> <span class="dv">63</span>)</a>
<a class="sourceLine" id="cb2047-10" data-line-number="10"></a>
<a class="sourceLine" id="cb2047-11" data-line-number="11">p3 &lt;-<span class="st"> </span><span class="kw">plot_bar_den</span>(<span class="dt">panel_n    =</span> <span class="dv">3</span>, </a>
<a class="sourceLine" id="cb2047-12" data-line-number="12">                   <span class="dt">theta      =</span> theta_<span class="dv">3</span>, </a>
<a class="sourceLine" id="cb2047-13" data-line-number="13">                   <span class="dt">y_second_x =</span> <span class="fl">-6.25</span>, </a>
<a class="sourceLine" id="cb2047-14" data-line-number="14">                   <span class="dt">ylim_ub    =</span> <span class="fl">25.75</span>)</a>
<a class="sourceLine" id="cb2047-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2047-16" data-line-number="16">p4 &lt;-<span class="st"> </span><span class="kw">plot_bar_den</span>(<span class="dt">panel_n    =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb2047-17" data-line-number="17">                   <span class="dt">theta      =</span> theta_<span class="dv">4</span>, </a>
<a class="sourceLine" id="cb2047-18" data-line-number="18">                   <span class="dt">y_second_x =</span> <span class="fl">-6.75</span>, </a>
<a class="sourceLine" id="cb2047-19" data-line-number="19">                   <span class="dt">ylim_ub    =</span> <span class="dv">28</span>)</a>
<a class="sourceLine" id="cb2047-20" data-line-number="20"></a>
<a class="sourceLine" id="cb2047-21" data-line-number="21">p1 <span class="op">/</span><span class="st"> </span>p2 <span class="op">/</span><span class="st"> </span>p3 <span class="op">/</span><span class="st"> </span>p4</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-13-1.png" style="display: block; margin: auto;" /></p>
<p>Oh mamma. “<em>The crucial concept in Figure 23.1 is that the probability of a particular ordinal outcome is the area under the normal curve between the thresholds of that outcome</em>” (p. 672, <em>emphasis</em> in the original). In each of the subplots, we used six thresholds to descritize the continuous data into seven categories. More generally, we need <span class="math inline">\(K\)</span> thresholds to make <span class="math inline">\(K + 1\)</span> ordinal categories. To make this work,</p>
<blockquote>
<p>the idea is that we consider the cumulative area under the normal up the high-side threshold, and subtract away the cumulative area under the normal up to the low-side threshold. Recall that the cumulative area under the standardized normal is denoted <span class="math inline">\(\Phi(z)\)</span>, as was illustrated in Figure 15.8 [which we remade at the top of this chapter]. Thus, the area under the normal to the left of <span class="math inline">\(\theta_k\)</span> is <span class="math inline">\(\Phi((\theta_k - \mu) / \sigma)\)</span>, and the area under the normal to the left of <span class="math inline">\(\theta_{k - 1}\)</span> is <span class="math inline">\(\Phi((\theta_{k - 1} - \mu) / \sigma)\)</span>. Therefore, the area under the normal curve between the two thresholds, which is the probability of outcome <span class="math inline">\(k\)</span>, is</p>
<p><span class="math display">\[p(y = k | \mu, \sigma, \{ \theta_j \}) = \Phi((\theta_k - \mu) / \sigma) - \Phi((\theta_{k - 1} - \mu) / \sigma)\]</span></p>
<p>[This equation] applies even to the least and greatest ordinal values if we append two “virtual” thresholds at <span class="math inline">\(- \infty\)</span> and <span class="math inline">\(+ \infty\)</span>…</p>
<p>Thus, a normally distributed underlying metric value can yield a clearly non-normal distribution of discrete ordinal values. This result does not imply that the ordinal values can be treated as if they were themselves metric and normally distributed; in fact it implies the opposite: We might be able to model a distribution of ordinal values as consecutive intervals of a normal distribution on an underlying metric scale with appropriately positioned thresholds. (pp. 674–675)</p>
</blockquote>
</div>
<div id="the-case-of-a-single-group" class="section level2">
<h2><span class="header-section-number">23.2</span> The case of a single group</h2>
<p>Given a model with no predictors, “if there are <span class="math inline">\(K\)</span> ordinal values, the model has <span class="math inline">\(K + 1\)</span> parameters: <span class="math inline">\(\theta_1,...,\theta_{K - 1}, \mu\)</span>, and <span class="math inline">\(\sigma\)</span>. If you think about it a moment, you’ll realize that the parameter values trade-off and are undetermined” (p. 675). The solution Kruschke took throughout this chapter was to fix the two thresholds at the ends, <span class="math inline">\(\theta_1\)</span> and <span class="math inline">\(\theta_{K - 1}\)</span>, to the constants</p>
<p><span class="math display">\[\begin{align*}
\theta_1 \equiv 1 + 0.5 &amp;&amp; \text{and}  &amp;&amp; \theta_{K - 1} \equiv K - 0.5.
\end{align*}\]</span></p>
<p>For example, all four subplots from Figure 23.1 had <span class="math inline">\(K = 7\)</span> categories, ranging from 1 to 7. Following Kruschke’s convention would mean setting the endmost thresholds to</p>
<p><span class="math display">\[\begin{align*}
\theta_1 \equiv 1.5 &amp;&amp; \text{and}  &amp;&amp; \theta_6 \equiv 6.5.
\end{align*}\]</span></p>
<p>As we’ll see, there are other ways to parameterize these models.</p>
<div id="implementation-in-jags-brms.-3" class="section level3">
<h3><span class="header-section-number">23.2.1</span> Implementation in <del>JAGS</del> <strong>brms</strong>.</h3>
<p>The syntax to fit a basic ordered probit model with <code>brms::brm()</code> is pretty simple.</p>
<div class="sourceCode" id="cb2048"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2048-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb2048-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2048-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2048-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2048-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept))</a></code></pre></div>
<p>The <code>family = cumulative(probit)</code> tells <strong>brms</strong> you’d like to use the probit link for the ordered-categorical data. It’s important to specify <code>probit</code> because the <strong>brms</strong> default is to use the <code>logit</code> link, instead. We’ll talk more about that approach at the end of this chapter.</p>
<p>Remember how, at the end of the last section, we said there are other ways to parameterize the ordered probit model? As it turns out, <strong>brms</strong> does not follow Kruschke’s approach for fixing the thresholds on the ends. Rather, <strong>brms</strong> freely estimates all thresholds, <span class="math inline">\(\theta_1,...,\theta_{K - 1}\)</span>, by fixing <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\sigma = 1\)</span>. That is, instead of estimating <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> from the normal cumulative density function <span class="math inline">\(\Phi(x)\)</span>, <code>brms::brm()</code> uses the standard normal cumulative density function <span class="math inline">\(\Phi(z)\)</span>.</p>
<p>This all probably seems abstract. We’ll get a lot of practice comparing the two approaches as we go along. Each has its strengths and weaknesses. At this point, the thing to get is that when fitting a single-group ordered-probit model with the <code>brm()</code> function, there will be no priors for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>. We only have to worry about setting the priors for all <span class="math inline">\(K - 1\)</span> thresholds. And because those thresholds are conditional on <span class="math inline">\(\Phi(z)\)</span>, we should think about their priors with respect to the scale of standard normal distribution. Thus, to continue on with Kruschke’s minimally-informative prior approach, something like <code>prior(normal(0, 4), class = Intercept)</code> might be a good starting place. Do feel free to experiment with different settings.</p>
</div>
<div id="examples-bayesian-estimation-recovers-true-parameter-values." class="section level3">
<h3><span class="header-section-number">23.2.2</span> Examples: Bayesian estimation recovers true parameter values.</h3>
<p>The data for Kruschke’s first example come from his <code>OrdinalProbitData-1grp-1.csv</code> file. Load the data.</p>
<div class="sourceCode" id="cb2049"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2049-1" data-line-number="1">my_data_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/OrdinalProbitData-1grp-1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2049-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2049-3" data-line-number="3"><span class="kw">glimpse</span>(my_data_<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Observations: 100
## Variables: 1
## $ Y &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
<p>Plot the distribution for <code>Y</code>.</p>
<div class="sourceCode" id="cb2051"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2051-1" data-line-number="1">my_data_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2051-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y =</span> <span class="kw">factor</span>(Y)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2051-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb2051-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2051-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2051-6" data-line-number="6"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-16-1.png" style="display: block; margin: auto;" /></p>
<p>It looks a lot like the distribution of the data from one of the panels from Figure 23.1. Load <strong>brms</strong>.</p>
<div class="sourceCode" id="cb2052"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2052-1" data-line-number="1"><span class="kw">library</span>(brms)</a></code></pre></div>
<p>Fit the first cumulative-probit model.</p>
<div class="sourceCode" id="cb2053"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2053-1" data-line-number="1">fit23<span class="fl">.1</span> &lt;-</a>
<a class="sourceLine" id="cb2053-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2053-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2053-4" data-line-number="4">      Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2053-5" data-line-number="5">      <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2053-6" data-line-number="6">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2053-7" data-line-number="7">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2053-8" data-line-number="8">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.01&quot;</span>)</a></code></pre></div>
<p>Examine the model summary.</p>
<div class="sourceCode" id="cb2054"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2054-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.1</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = identity 
## Formula: Y ~ 1 
##    Data: my_data_1 (Number of observations: 100) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]     0.18      0.13    -0.06     0.43 1.00    10343     6333
## Intercept[2]     0.60      0.13     0.34     0.87 1.00    11769     6851
## Intercept[3]     1.04      0.15     0.74     1.34 1.00    11542     6613
## Intercept[4]     1.50      0.19     1.14     1.88 1.00    12314     6356
## Intercept[5]     1.96      0.25     1.50     2.49 1.00    11738     7449
## Intercept[6]     2.57      0.40     1.89     3.45 1.00    12330     7001
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>The <strong>brms</strong> output for these kinds of models names the thresholds <span class="math inline">\(\theta_{[i]}\)</span> as <code>Intercept[i]</code>. Again, whereas Kruschke identified his model by fixing <span class="math inline">\(\theta_1 = 1.5\)</span> (i.e., <span class="math inline">\(1 + 0.5\)</span>) and <span class="math inline">\(\theta_6 = 5.5\)</span> (i.e., <span class="math inline">\(6 - 0.5\)</span>), we freely estimated all six thresholds by using the cumulative density function for the standard normal. As a result, our thresholds are in a different metric from Kruschke’s.</p>
<p>Let’s extract the posterior draws.</p>
<div class="sourceCode" id="cb2056"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2056-1" data-line-number="1">post &lt;-<span class="st"> </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.1</span>)</a>
<a class="sourceLine" id="cb2056-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2056-3" data-line-number="3"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 8,000
## Variables: 7
## $ `b_Intercept[1]` &lt;dbl&gt; 0.185364034, 0.165876358, 0.438520914, 0.206087790, 0.131577665, 0.189973985, 0.19…
## $ `b_Intercept[2]` &lt;dbl&gt; 0.6662789, 0.6199828, 0.7796308, 0.6214409, 0.4437972, 0.5546956, 0.7037654, 0.454…
## $ `b_Intercept[3]` &lt;dbl&gt; 1.1525861, 1.1466193, 1.1683288, 1.0015953, 1.0178535, 0.9794249, 1.1422900, 0.864…
## $ `b_Intercept[4]` &lt;dbl&gt; 1.495071, 1.527385, 1.681138, 1.388764, 1.561751, 1.390207, 1.364145, 1.575484, 1.…
## $ `b_Intercept[5]` &lt;dbl&gt; 1.705743, 1.752142, 2.057058, 2.024601, 1.758377, 1.882053, 1.577857, 2.116130, 1.…
## $ `b_Intercept[6]` &lt;dbl&gt; 2.155234, 2.081832, 2.817471, 2.708599, 2.235552, 3.252597, 1.714304, 3.205844, 2.…
## $ lp__             &lt;dbl&gt; -151.4273, -151.4265, -151.7556, -149.8376, -152.3254, -150.8681, -155.6359, -151.…</code></pre>
<p>Wrangle <code>post</code> a bit.</p>
<div class="sourceCode" id="cb2058"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2058-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb2058-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2058-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2058-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a></code></pre></div>
<p>Here’s our <strong>brms</strong> version of the bottom plot of Figure 23.2</p>
<div class="sourceCode" id="cb2059"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2059-1" data-line-number="1">means &lt;-</a>
<a class="sourceLine" id="cb2059-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2059-3" data-line-number="3"><span class="st">  </span><span class="kw">summarise_at</span>(<span class="kw">vars</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>), mean) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2059-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(),</a>
<a class="sourceLine" id="cb2059-5" data-line-number="5">               <span class="dt">values_to =</span> <span class="st">&quot;mean&quot;</span>)</a>
<a class="sourceLine" id="cb2059-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2059-7" data-line-number="7">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2059-8" data-line-number="8"><span class="st">  </span><span class="kw">gather</span>(name, threshold, <span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2059-9" data-line-number="9"><span class="st">  </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2059-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">theta_bar =</span> <span class="kw">mean</span>(threshold)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2059-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb2059-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> threshold, <span class="dt">y =</span> theta_bar, <span class="dt">color =</span> name)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2059-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> means,</a>
<a class="sourceLine" id="cb2059-14" data-line-number="14">             <span class="kw">aes</span>(<span class="dt">xintercept =</span> mean, <span class="dt">color =</span> name),</a>
<a class="sourceLine" id="cb2059-15" data-line-number="15">             <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2059-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2059-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.85</span>, <span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2059-18" data-line-number="18"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;mean threshold&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2059-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb2059-20" data-line-number="20">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-21-1.png" style="display: block; margin: auto;" /></p>
<p>The initial <code>means</code> data at the top contains the <span class="math inline">\(\theta_i\)</span>-specific means, which we used to make the dashed vertical lines with <code>geom_vline()</code>. Did you see what we did there with those <code>group_by()</code> and <code>mutate()</code> lines? That’s how we computed the mean threshold within each step of the HMC chain, what Kruschke (p. 680) denoted as <span class="math inline">\(\bar \theta (s) = \sum_k^{K-1} \theta_k (s) / (K - 1)\)</span>, where <span class="math inline">\(s\)</span> refers to particular steps in the HMC chain.</p>
<p>Perhaps of greater interest, you might have noticed how different our plot is from the one in the text. We might should compare the results of our <strong>brms</strong> parameterization of <span class="math inline">\(\theta_{[i]}\)</span> with one based on the parameterization in the text in an expanded version of the bottom plot of Figure 23.2. To convert our <strong>brms</strong> output to match Kruschke’s, we’ll rescale our <span class="math inline">\(\theta_{[i]}\)</span> draws with help from the <code>scales::rescale()</code> function, about which you might learn more <a href="https://www.rdocumentation.org/packages/scales/versions/0.4.1/topics/rescale">here</a>.</p>
<div class="sourceCode" id="cb2060"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2060-1" data-line-number="1"><span class="co"># primary data wrangling</span></a>
<a class="sourceLine" id="cb2060-2" data-line-number="2">p &lt;-</a>
<a class="sourceLine" id="cb2060-3" data-line-number="3"><span class="st">  </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb2060-4" data-line-number="4">    <span class="co"># brms parameterization</span></a>
<a class="sourceLine" id="cb2060-5" data-line-number="5">    post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-6" data-line-number="6"><span class="st">      </span><span class="kw">gather</span>(name, threshold, <span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-7" data-line-number="7"><span class="st">      </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-8" data-line-number="8"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">theta_bar =</span> <span class="kw">mean</span>(threshold)),</a>
<a class="sourceLine" id="cb2060-9" data-line-number="9">    <span class="co"># Kruschke&#39;s parameterization</span></a>
<a class="sourceLine" id="cb2060-10" data-line-number="10">    post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-11" data-line-number="11"><span class="st">      </span><span class="kw">gather</span>(name, threshold, <span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-12" data-line-number="12"><span class="st">      </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-13" data-line-number="13"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">threshold =</span> scales<span class="op">::</span><span class="kw">rescale</span>(threshold, <span class="dt">to =</span> <span class="kw">c</span>(<span class="fl">1.5</span>, <span class="fl">6.5</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-14" data-line-number="14"><span class="st">      </span><span class="kw">mutate</span>(<span class="dt">theta_bar =</span> <span class="kw">mean</span>(threshold))</a>
<a class="sourceLine" id="cb2060-15" data-line-number="15">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-16" data-line-number="16"><span class="st">  </span><span class="co"># add an index</span></a>
<a class="sourceLine" id="cb2060-17" data-line-number="17"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;brms parameterization&quot;</span>, <span class="st">&quot;Kruschke&#39;s parameterization&quot;</span>), <span class="dt">each =</span> <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb2060-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2060-19" data-line-number="19"><span class="co"># compute the means by model and threshold for the vertical lines</span></a>
<a class="sourceLine" id="cb2060-20" data-line-number="20">means &lt;-</a>
<a class="sourceLine" id="cb2060-21" data-line-number="21"><span class="st">  </span>p <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-22" data-line-number="22"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-23" data-line-number="23"><span class="st">  </span><span class="kw">group_by</span>(model, name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-24" data-line-number="24"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(threshold))</a>
<a class="sourceLine" id="cb2060-25" data-line-number="25"></a>
<a class="sourceLine" id="cb2060-26" data-line-number="26"><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb2060-27" data-line-number="27">p <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2060-28" data-line-number="28"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> threshold, <span class="dt">y =</span> theta_bar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2060-29" data-line-number="29"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> means,</a>
<a class="sourceLine" id="cb2060-30" data-line-number="30">             <span class="kw">aes</span>(<span class="dt">xintercept =</span> mean, <span class="dt">color =</span> name),</a>
<a class="sourceLine" id="cb2060-31" data-line-number="31">             <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2060-32" data-line-number="32"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> name),</a>
<a class="sourceLine" id="cb2060-33" data-line-number="33">             <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2060-34" data-line-number="34"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.85</span>, <span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2060-35" data-line-number="35"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;mean threshold&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2060-36" data-line-number="36"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb2060-37" data-line-number="37">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2060-38" data-line-number="38"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>model, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-22-1.png" style="display: block; margin: auto;" /></p>
<p>We can take our rescaling approach further to convert the posterior distributions for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> from the <strong>brms</strong> <span class="math inline">\(\operatorname{Normal} (0, 1)\)</span> constants to the metric from Kruschke’s approach. Say <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> are two draws from some Gaussian and <span class="math inline">\(z_1\)</span> and <span class="math inline">\(z_2\)</span> are their corresponding <span class="math inline">\(z\)</span>-scores. Here’s how to solve for <span class="math inline">\(\sigma\)</span>.</p>
<p><span class="math display">\[\begin{align*}
z_1 - z_2 &amp; = \frac{(y_1 - \mu)}{\sigma} - \frac{(y_2 - \mu)}{\sigma} \\
          &amp; = \frac{(y_1 - \mu) - (y_2 - \mu)}{\sigma} \\
          &amp; = \frac{y_1 - \mu - y_2 + \mu}{\sigma} \\
          &amp; = \frac{y_1 - y_2}{\sigma}, \;\; \text{therefore} \\
\sigma    &amp; = \frac{y_1 - y_2}{z_1 – z_2}.
\end{align*}\]</span></p>
<p>If you’d like to compute <span class="math inline">\(\mu\)</span>, it’s even simpler.</p>
<p><span class="math display">\[\begin{align*}
z_1 &amp; = \frac{y_1 - \mu}{\sigma} \\
z_1 \sigma &amp; = y_1 - \mu \\
z_1 \sigma + \mu &amp; = y_1, \;\; \text{therefore}  \\
\mu &amp; = y_1 - z_1 \sigma
\end{align*}\]</span></p>
<p>Big shout out to my math-stats savvy friends academic twitter for the formulas, especially <a href="https://twitter.com/PhDemetri">Ph.Demetri</a>, <a href="https://twitter.com/lukasneugebau">Lukas Neugebauer</a>, and <a href="https://twitter.com/bmwiernik">Brenton Wiernik</a> for walking the formulas out (see <a href="https://twitter.com/SolomonKurz/status/1219649489016958976">this twitter thread</a>). For our application, <code>Intercept[1]</code> and <code>Intercept[6]</code> will be our two <span class="math inline">\(z\)</span>-scores and Kruschke’s 1.5 and 6.5 will be their corresponding <span class="math inline">\(y\)</span>-values.</p>
<div class="sourceCode" id="cb2061"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2061-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb2061-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2061-3" data-line-number="3">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2061-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(iter, <span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2061-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">y[1]</span><span class="st">`</span> =<span class="st"> </span><span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb2061-6" data-line-number="6">         <span class="st">`</span><span class="dt">y[6]</span><span class="st">`</span> =<span class="st"> </span><span class="fl">6.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2061-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu    =</span> <span class="st">`</span><span class="dt">y[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2061-8" data-line-number="8">         <span class="dt">sigma =</span> (<span class="st">`</span><span class="dt">y[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">y[6]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2061-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">(mu-2)/sigma</span><span class="st">`</span> =<span class="st"> </span>(mu <span class="op">-</span><span class="st"> </span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2061-10" data-line-number="10"><span class="st">  </span><span class="kw">pivot_longer</span>(mu<span class="op">:</span><span class="st">`</span><span class="dt">(mu-2)/sigma</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2061-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb2061-12" data-line-number="12">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;(mu-2)/sigma&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2061-13" data-line-number="13"><span class="st">  </span></a>
<a class="sourceLine" id="cb2061-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2061-15" data-line-number="15"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2061-16" data-line-number="16">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2061-17" data-line-number="17">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2061-18" data-line-number="18">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2061-19" data-line-number="19"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2061-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2061-21" data-line-number="21"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /></p>
<p>Our results are similar to Kruschke’s. Given we used a different algorithm, a different parameterization, and different priors, I’m not terribly surprised. If you have more insight on the matter or have spotted a flaw in this method, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share with the rest of us</a>.</p>
<p>It’s unclear, to me, how we’d interpret the effect size. The difficulty isn’t that Kruschke’s comparison of <span class="math inline">\(C = 2.0\)</span> is arbitrary, but that we can only interpret the comparison given the model assumption of <span class="math inline">\(\theta_1 = 1.5\)</span> and <span class="math inline">\(\theta_6 = 6.5\)</span>. If your theory doesn’t allow you to understand the meaning of those constants and why you’d prefer them to slightly different ones, you’d be fooling yourself if you attempted to interpret any effect sizes conditional on those values. Proceed with caution.</p>
<p>In the large paragraph on the lower part of page 679, Kruschke discussed why the thresholds tend to have nontrivial covariances. This is what he was trying to convey with the bottom subplot in Figure 23.2. If you’re curious, here is the correlation matrix among the thresholds.</p>
<div class="sourceCode" id="cb2062"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2062-1" data-line-number="1"><span class="kw">vcov</span>(fit23<span class="fl">.1</span>, <span class="dt">correlation =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##              Intercept[1] Intercept[2] Intercept[3] Intercept[4] Intercept[5] Intercept[6]
## Intercept[1]         1.00         0.72         0.51         0.33         0.21         0.13
## Intercept[2]         0.72         1.00         0.71         0.45         0.29         0.16
## Intercept[3]         0.51         0.71         1.00         0.65         0.41         0.21
## Intercept[4]         0.33         0.45         0.65         1.00         0.64         0.32
## Intercept[5]         0.21         0.29         0.41         0.64         1.00         0.51
## Intercept[6]         0.13         0.16         0.21         0.32         0.51         1.00</code></pre>
<p>Kruschke didn’t do this in the text, but it might be informative to plot the probability distributions for the seven categories from <code>Y</code> (i.e., <span class="math inline">\(p(y = k | \mu = 0, \sigma = 1, \{ \theta_i \})\)</span>).</p>
<div class="sourceCode" id="cb2064"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2064-1" data-line-number="1"><span class="kw">library</span>(tidybayes)</a>
<a class="sourceLine" id="cb2064-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2064-3" data-line-number="3">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2064-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2064-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span> <span class="op">~</span><span class="kw">pnorm</span>(. ,<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2064-6" data-line-number="6"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">p[Y==1]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2064-7" data-line-number="7">            <span class="st">`</span><span class="dt">p[Y==2]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[2]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2064-8" data-line-number="8">            <span class="st">`</span><span class="dt">p[Y==3]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[3]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[2]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2064-9" data-line-number="9">            <span class="st">`</span><span class="dt">p[Y==4]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[4]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[3]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2064-10" data-line-number="10">            <span class="st">`</span><span class="dt">p[Y==5]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[5]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[4]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2064-11" data-line-number="11">            <span class="st">`</span><span class="dt">p[Y==6]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[5]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2064-12" data-line-number="12">            <span class="st">`</span><span class="dt">p[Y==7]</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2064-13" data-line-number="13"><span class="st">  </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2064-14" data-line-number="14"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(), <span class="dt">names_to =</span> <span class="st">&quot;Y&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2064-15" data-line-number="15"><span class="st">  </span></a>
<a class="sourceLine" id="cb2064-16" data-line-number="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2064-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2064-18" data-line-number="18"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(p)<span class="op">*</span><span class="st">&quot;[&quot;</span><span class="op">*</span>Y<span class="op">==</span><span class="kw">italic</span>(i)<span class="op">*</span><span class="st">&quot;]&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2064-19" data-line-number="19"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2064-20" data-line-number="20"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-26-1.png" style="display: block; margin: auto;" /></p>
<p>Happily, the model produces data that look a lot like those from which it was generated.</p>
<div class="sourceCode" id="cb2065"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2065-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2065-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2065-3" data-line-number="3">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2065-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">z =</span> <span class="kw">rnorm</span>(<span class="kw">n</span>(), <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2065-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y =</span> <span class="kw">case_when</span>(</a>
<a class="sourceLine" id="cb2065-6" data-line-number="6">    z <span class="op">&lt;</span><span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2065-7" data-line-number="7">    z <span class="op">&lt;</span><span class="st"> `</span><span class="dt">b_Intercept[2]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2065-8" data-line-number="8">    z <span class="op">&lt;</span><span class="st"> `</span><span class="dt">b_Intercept[3]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2065-9" data-line-number="9">    z <span class="op">&lt;</span><span class="st"> `</span><span class="dt">b_Intercept[4]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2065-10" data-line-number="10">    z <span class="op">&lt;</span><span class="st"> `</span><span class="dt">b_Intercept[5]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb2065-11" data-line-number="11">    z <span class="op">&lt;</span><span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">6</span>,</a>
<a class="sourceLine" id="cb2065-12" data-line-number="12">    z <span class="op">&gt;=</span><span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span> <span class="op">~</span><span class="st"> </span><span class="dv">7</span></a>
<a class="sourceLine" id="cb2065-13" data-line-number="13">  ) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.factor</span>(.)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2065-14" data-line-number="14"></a>
<a class="sourceLine" id="cb2065-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2065-16" data-line-number="16"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2065-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-27-1.png" style="display: block; margin: auto;" /></p>
<p>Along similar lines, we can use the <code>pp_check()</code> function to make a version of the upper right panel of Figure 23.2. The <code>type = &quot;bars&quot;</code> argument will allow us to summarize the posterior predictions as a dot (mean) and standard error bars superimposed on a bar plot of the original data. Note how this differs a little from Kruschke’s use of the posterior median and 95% HDIs. The <code>nsamples = 1000</code> argument controls how many posterior predictions we wanted to summarize over. The rest is just formatting.</p>
<div class="sourceCode" id="cb2066"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2066-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2066-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2066-3" data-line-number="3"><span class="kw">pp_check</span>(fit23<span class="fl">.1</span>, <span class="dt">type =</span> <span class="st">&quot;bars&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">1000</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2066-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2066-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2066-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with posterior predictions&quot;</span>,</a>
<a class="sourceLine" id="cb2066-7" data-line-number="7">          <span class="dt">subtitle =</span> <span class="st">&quot;N = 100&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2066-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>, <span class="fl">.8</span>))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /></p>
<p>Load the data for the next model.</p>
<div class="sourceCode" id="cb2067"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2067-1" data-line-number="1">my_data_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/OrdinalProbitData-1grp-2.csv&quot;</span>)</a></code></pre></div>
<p>Since we’re reusing all the specifications from the last model for this one, we can just use <code>update()</code>.</p>
<div class="sourceCode" id="cb2068"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2068-1" data-line-number="1">fit23<span class="fl">.2</span> &lt;-</a>
<a class="sourceLine" id="cb2068-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit23<span class="fl">.1</span>, </a>
<a class="sourceLine" id="cb2068-3" data-line-number="3">         <span class="dt">newdata =</span> my_data_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2068-4" data-line-number="4">         <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2068-5" data-line-number="5">         <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2068-6" data-line-number="6">         <span class="dt">file =</span> <span class="st">&quot;fits/fit23.02&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2069"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2069-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.2</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = identity 
## Formula: Y ~ 1 
##    Data: my_data_2 (Number of observations: 70) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]    -1.41      0.22    -1.85    -1.00 1.00     5467     5039
## Intercept[2]    -0.18      0.15    -0.47     0.12 1.00     9230     6898
## Intercept[3]     0.17      0.15    -0.12     0.46 1.00     9458     6989
## Intercept[4]     0.46      0.16     0.15     0.76 1.00     8971     6719
## Intercept[5]     0.83      0.17     0.50     1.16 1.00     8841     6441
## Intercept[6]     2.00      0.31     1.44     2.66 1.00     9194     6731
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract and wrangle the posterior draws.</p>
<div class="sourceCode" id="cb2071"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2071-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2071-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2071-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2071-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a></code></pre></div>
<p>Now we might compare the <strong>brms</strong> parameterization of <span class="math inline">\(\theta_{[i]}\)</span> with Kruschke’s parameterization in an expanded version of the bottom plot of Figure 23.3. As we’ll be making a lot of these plots throughout this chapter, it might be worthwhile to just make a custom function. We’ll call it <code>compare_thresholds()</code>.</p>
<div class="sourceCode" id="cb2072"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2072-1" data-line-number="1">compare_thresholds &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">6.5</span>) {</a>
<a class="sourceLine" id="cb2072-2" data-line-number="2">  </a>
<a class="sourceLine" id="cb2072-3" data-line-number="3">  <span class="co"># we have two parameters:</span></a>
<a class="sourceLine" id="cb2072-4" data-line-number="4">  <span class="co"># lb = lower bound</span></a>
<a class="sourceLine" id="cb2072-5" data-line-number="5">  <span class="co"># ub = upper bound</span></a>
<a class="sourceLine" id="cb2072-6" data-line-number="6">  </a>
<a class="sourceLine" id="cb2072-7" data-line-number="7">  <span class="co"># primary data wrangling</span></a>
<a class="sourceLine" id="cb2072-8" data-line-number="8">  p &lt;-</a>
<a class="sourceLine" id="cb2072-9" data-line-number="9"><span class="st">    </span><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb2072-10" data-line-number="10">      data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-11" data-line-number="11"><span class="st">        </span><span class="kw">gather</span>(name, threshold, <span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-12" data-line-number="12"><span class="st">        </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-13" data-line-number="13"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">theta_bar =</span> <span class="kw">mean</span>(threshold)),</a>
<a class="sourceLine" id="cb2072-14" data-line-number="14">      data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-15" data-line-number="15"><span class="st">        </span><span class="kw">gather</span>(name, threshold, <span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-16" data-line-number="16"><span class="st">        </span><span class="kw">group_by</span>(iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-17" data-line-number="17"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">threshold =</span> scales<span class="op">::</span><span class="kw">rescale</span>(threshold, <span class="dt">to =</span> <span class="kw">c</span>(lb, ub))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-18" data-line-number="18"><span class="st">        </span><span class="kw">mutate</span>(<span class="dt">theta_bar =</span> <span class="kw">mean</span>(threshold))</a>
<a class="sourceLine" id="cb2072-19" data-line-number="19">    ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-20" data-line-number="20"><span class="st">    </span><span class="kw">mutate</span>(<span class="dt">model =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;brms parameterization&quot;</span>, <span class="st">&quot;Kruschke&#39;s parameterization&quot;</span>), <span class="dt">each =</span> <span class="kw">n</span>() <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb2072-21" data-line-number="21">  </a>
<a class="sourceLine" id="cb2072-22" data-line-number="22">  <span class="co"># compute the means by model and threshold for the vertical lines</span></a>
<a class="sourceLine" id="cb2072-23" data-line-number="23">  means &lt;-</a>
<a class="sourceLine" id="cb2072-24" data-line-number="24"><span class="st">    </span>p <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-25" data-line-number="25"><span class="st">    </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-26" data-line-number="26"><span class="st">    </span><span class="kw">group_by</span>(model, name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-27" data-line-number="27"><span class="st">    </span><span class="kw">summarise</span>(<span class="dt">mean =</span> <span class="kw">mean</span>(threshold))</a>
<a class="sourceLine" id="cb2072-28" data-line-number="28">  </a>
<a class="sourceLine" id="cb2072-29" data-line-number="29">  <span class="co"># plot!</span></a>
<a class="sourceLine" id="cb2072-30" data-line-number="30">  p <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2072-31" data-line-number="31"><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> threshold, <span class="dt">y =</span> theta_bar)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2072-32" data-line-number="32"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">data =</span> means,</a>
<a class="sourceLine" id="cb2072-33" data-line-number="33">               <span class="kw">aes</span>(<span class="dt">xintercept =</span> mean, <span class="dt">color =</span> name),</a>
<a class="sourceLine" id="cb2072-34" data-line-number="34">               <span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2072-35" data-line-number="35"><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> name),</a>
<a class="sourceLine" id="cb2072-36" data-line-number="36">               <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">10</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2072-37" data-line-number="37"><span class="st">    </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">end =</span> <span class="fl">.85</span>, <span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2072-38" data-line-number="38"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;mean threshold&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2072-39" data-line-number="39"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb2072-40" data-line-number="40">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2072-41" data-line-number="41"><span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span>model, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a>
<a class="sourceLine" id="cb2072-42" data-line-number="42">  </a>
<a class="sourceLine" id="cb2072-43" data-line-number="43">}</a></code></pre></div>
<p>Take that puppy for a spin.</p>
<div class="sourceCode" id="cb2073"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2073-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2073-2" data-line-number="2"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">6.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-33-1.png" style="display: block; margin: auto;" /></p>
<p>Oh man, that works sweet. Now let’s use the same parameter-transformation approach from before to get our un-standardized posteriors for <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\sigma\)</span>, and the effect size.</p>
<div class="sourceCode" id="cb2074"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2074-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2074-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(iter, <span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2074-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">y[1]</span><span class="st">`</span> =<span class="st"> </span><span class="fl">1.5</span>,</a>
<a class="sourceLine" id="cb2074-4" data-line-number="4">         <span class="st">`</span><span class="dt">y[6]</span><span class="st">`</span> =<span class="st"> </span><span class="fl">6.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2074-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu    =</span> <span class="st">`</span><span class="dt">y[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span> <span class="op">*</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2074-6" data-line-number="6">         <span class="dt">sigma =</span> (<span class="st">`</span><span class="dt">y[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">y[6]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2074-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">(mu-4)/sigma</span><span class="st">`</span> =<span class="st"> </span>(mu <span class="op">-</span><span class="st"> </span><span class="dv">4</span>) <span class="op">/</span><span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2074-8" data-line-number="8"><span class="st">  </span><span class="kw">pivot_longer</span>(mu<span class="op">:</span><span class="st">`</span><span class="dt">(mu-4)/sigma</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2074-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb2074-10" data-line-number="10">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;mu&quot;</span>, <span class="st">&quot;sigma&quot;</span>, <span class="st">&quot;(mu-4)/sigma&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2074-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb2074-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2074-13" data-line-number="13"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2074-14" data-line-number="14">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2074-15" data-line-number="15">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2074-16" data-line-number="16">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2074-17" data-line-number="17"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2074-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2074-19" data-line-number="19"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-34-1.png" style="display: block; margin: auto;" /></p>
<p>Use <code>pp_check()</code> to make our version of the upper-right panel of Figure 23.3.</p>
<div class="sourceCode" id="cb2075"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2075-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2075-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2075-3" data-line-number="3"><span class="kw">pp_check</span>(fit23<span class="fl">.2</span>, <span class="dt">type =</span> <span class="st">&quot;bars&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">1000</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2075-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2075-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2075-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with posterior predictions&quot;</span>,</a>
<a class="sourceLine" id="cb2075-7" data-line-number="7">          <span class="dt">subtitle =</span> <span class="st">&quot;N = 70&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2075-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>, <span class="fl">.8</span>))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-35-1.png" style="display: block; margin: auto;" /></p>
<p>Just as in the text, “the posterior predictive distribution in the top-right subpanel accurately describes the bimodal distribution of the outcomes” (p. 680).</p>
<p>Here are the probability distributions for each of the 7 categories of <code>Y</code>.</p>
<div class="sourceCode" id="cb2076"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2076-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2076-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2076-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate_all</span>(<span class="dt">.funs =</span> <span class="op">~</span><span class="kw">pnorm</span>(. ,<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2076-4" data-line-number="4"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">p[Y==1]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2076-5" data-line-number="5">            <span class="st">`</span><span class="dt">p[Y==2]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[2]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2076-6" data-line-number="6">            <span class="st">`</span><span class="dt">p[Y==3]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[3]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[2]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2076-7" data-line-number="7">            <span class="st">`</span><span class="dt">p[Y==4]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[4]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[3]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2076-8" data-line-number="8">            <span class="st">`</span><span class="dt">p[Y==5]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[5]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[4]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2076-9" data-line-number="9">            <span class="st">`</span><span class="dt">p[Y==6]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[5]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2076-10" data-line-number="10">            <span class="st">`</span><span class="dt">p[Y==7]</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> `</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2076-11" data-line-number="11"><span class="st">  </span><span class="kw">set_names</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2076-12" data-line-number="12"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>(), <span class="dt">names_to =</span> <span class="st">&quot;Y&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2076-13" data-line-number="13"><span class="st">  </span></a>
<a class="sourceLine" id="cb2076-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2076-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>, <span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2076-16" data-line-number="16"><span class="st">  </span><span class="kw">xlab</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(p)<span class="op">*</span><span class="st">&quot;[&quot;</span><span class="op">*</span>Y<span class="op">==</span><span class="kw">italic</span>(i)<span class="op">*</span><span class="st">&quot;]&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2076-17" data-line-number="17"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2076-18" data-line-number="18"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-36-1.png" style="display: block; margin: auto;" /></p>
<p>Before we move on, it might be helpful to nail down what the thresholds mean within the context of our <strong>brms</strong> parameterization. To keep things simple, we’ll focus on their posterior means.</p>
<div class="sourceCode" id="cb2077"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2077-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2077-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dnorm</span>(x)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2077-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb2077-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">fixef</span>(fit23<span class="fl">.2</span>)[, <span class="dv">1</span>], <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">fixef</span>(fit23<span class="fl">.2</span>)[, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2077-8" data-line-number="8">                     <span class="dt">labels =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="st">&quot;]&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-10" data-line-number="10"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Standard normal distribution underlying the ordinal Y data:&quot;</span>,</a>
<a class="sourceLine" id="cb2077-11" data-line-number="11">          <span class="dt">subtitle =</span> <span class="st">&quot;The dashed vertical lines mark the posterior means for the thresholds.&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-12" data-line-number="12"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-3</span><span class="op">:</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2077-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-37-1.png" style="display: block; margin: auto;" /></p>
<p>Compare that to Figure 23.1.</p>
<div id="not-the-same-results-as-pretending-the-data-are-metric." class="section level4">
<h4><span class="header-section-number">23.2.2.1</span> Not the same results as pretending the data are metric.</h4>
<p>“In some conventional approaches to ordinal data, the data are treated as if they were metric and normally distributed” (p. 681). Here’s what that <code>brms::brm()</code> model might look like using methods from back in Chapter 16. First, we’ll define our <code>stanvars</code>.</p>
<div class="sourceCode" id="cb2078"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2078-1" data-line-number="1">mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data_<span class="dv">1</span><span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2078-2" data-line-number="2">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data_<span class="dv">1</span><span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2078-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2078-4" data-line-number="4">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2078-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2078-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a></code></pre></div>
<p>Fit the model.</p>
<div class="sourceCode" id="cb2079"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2079-1" data-line-number="1">fit23<span class="fl">.3</span> &lt;-</a>
<a class="sourceLine" id="cb2079-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data_<span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2079-3" data-line-number="3">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb2079-4" data-line-number="4">      Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2079-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2079-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb2079-7" data-line-number="7">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2079-8" data-line-number="8">      <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb2079-9" data-line-number="9">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2079-10" data-line-number="10">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.03&quot;</span>)</a></code></pre></div>
<p>Check the results.</p>
<div class="sourceCode" id="cb2080"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2080-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.3</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = identity 
## Formula: Y ~ 1 
##    Data: my_data_1 (Number of observations: 100) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept     1.95      0.14     1.68     2.23 1.00     3377     2534
## 
## Family Specific Parameters: 
##       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## sigma     1.41      0.10     1.23     1.63 1.00     3141     2417
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>As Kruschke indicated in the text, it yielded a distributional mean of about 1.95 and a standard deviation of about 1.41. Here we’ll use a posterior predictive check to compare histograms of data generated from this model to that of the original data.</p>
<div class="sourceCode" id="cb2082"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2082-1" data-line-number="1"><span class="kw">pp_check</span>(fit23<span class="fl">.3</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">10</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2082-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2082-3" data-line-number="3"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>, <span class="fl">.15</span>))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-40-1.png" style="display: block; margin: auto;" /></p>
<p>Yeah, that’s not a good fit. We won’t be conducting a <span class="math inline">\(t\)</span>-test like Kruschke did on page 681. But we might compromise and take a look at the marginal distribution of the intercept (i.e., for <span class="math inline">\(\mu\)</span>) and its difference from 2, the reference value.</p>
<div class="sourceCode" id="cb2083"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2083-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit23<span class="fl">.3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2083-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">2 - b_Intercept</span><span class="st">`</span> =<span class="st"> </span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>b_Intercept,</a>
<a class="sourceLine" id="cb2083-3" data-line-number="3">         <span class="st">`</span><span class="dt">effect size</span><span class="st">`</span>     =<span class="st"> </span>(<span class="dv">2</span> <span class="op">-</span><span class="st"> </span>b_Intercept) <span class="op">/</span><span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2083-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span><span class="kw">c</span>(sigma, b_Intercept, lp__)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2083-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2083-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2083-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2083-8" data-line-number="8">                <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2083-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2083-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2083-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-41-1.png" style="display: block; margin: auto;" /></p>
<p>Yes indeed, 2 is a credible value for the intercept. And as reported in the text, we got a very small <span class="math inline">\(d\)</span> effect size. Now we repeat the process for the second data set.</p>
<div class="sourceCode" id="cb2084"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2084-1" data-line-number="1">mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data_<span class="dv">2</span><span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2084-2" data-line-number="2">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data_<span class="dv">2</span><span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2084-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2084-4" data-line-number="4">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2084-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2084-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a>
<a class="sourceLine" id="cb2084-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2084-8" data-line-number="8">fit23<span class="fl">.4</span> &lt;-</a>
<a class="sourceLine" id="cb2084-9" data-line-number="9"><span class="st">  </span><span class="kw">update</span>(fit23<span class="fl">.3</span>,</a>
<a class="sourceLine" id="cb2084-10" data-line-number="10">         <span class="dt">newdata =</span> my_data_<span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2084-11" data-line-number="11">         <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2084-12" data-line-number="12">         <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb2084-13" data-line-number="13">         <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2084-14" data-line-number="14">         <span class="dt">file =</span> <span class="st">&quot;fits/fit23.04&quot;</span>)</a></code></pre></div>
<p>Let’s just jump to the plot. This time we’re comparing the <code>b_Intercept</code> to the value of 4.0.</p>
<div class="sourceCode" id="cb2085"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2085-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit23<span class="fl">.4</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2085-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">2 - b_Intercept</span><span class="st">`</span> =<span class="st"> </span><span class="dv">4</span> <span class="op">-</span><span class="st"> </span>b_Intercept,</a>
<a class="sourceLine" id="cb2085-3" data-line-number="3">         <span class="st">`</span><span class="dt">effect size</span><span class="st">`</span>     =<span class="st"> </span>(<span class="dv">4</span> <span class="op">-</span><span class="st"> </span>b_Intercept) <span class="op">/</span><span class="st"> </span>sigma) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2085-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span><span class="kw">c</span>(sigma, b_Intercept, lp__)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2085-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2085-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2085-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_halfeyeh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2085-8" data-line-number="8">                <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2085-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2085-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2085-11" data-line-number="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-42-1.png" style="display: block; margin: auto;" /></p>
<p>As in the text, our <span class="math inline">\(d\)</span> is centered around 0.3. Let’s use a posterior predictive check to see how well <code>fit23.4</code> summarized these data.</p>
<div class="sourceCode" id="cb2086"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2086-1" data-line-number="1"><span class="kw">pp_check</span>(fit23<span class="fl">.4</span>, <span class="dt">type =</span> <span class="st">&quot;hist&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">10</span>, <span class="dt">binwidth =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2086-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">7</span>, <span class="dt">by =</span> <span class="dv">2</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2086-3" data-line-number="3"><span class="st">  </span><span class="kw">theme_grey</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2086-4" data-line-number="4"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>, <span class="fl">.15</span>),</a>
<a class="sourceLine" id="cb2086-5" data-line-number="5">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-43-1.png" style="display: block; margin: auto;" /></p>
<p>The histograms aren’t as awful as the ones for the previous model. But they’re still not great. We might further inspect the model misspecification with a cumulative distribution function overlay, this time comparing <code>fit23.2</code> directly to <code>fit23.4</code>.</p>
<div class="sourceCode" id="cb2087"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2087-1" data-line-number="1">p1 &lt;-</a>
<a class="sourceLine" id="cb2087-2" data-line-number="2"><span class="st">  </span><span class="kw">pp_check</span>(fit23<span class="fl">.2</span>, <span class="dt">type =</span> <span class="st">&quot;ecdf_overlay&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">50</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2087-3" data-line-number="3"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Cumulative-normal (fit23.2)&quot;</span>)</a>
<a class="sourceLine" id="cb2087-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2087-5" data-line-number="5">p2 &lt;-</a>
<a class="sourceLine" id="cb2087-6" data-line-number="6"><span class="st">  </span><span class="kw">pp_check</span>(fit23<span class="fl">.4</span>, <span class="dt">type =</span> <span class="st">&quot;ecdf_overlay&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">50</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2087-7" data-line-number="7"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Conventional-normal (fit23.4)&quot;</span>)</a>
<a class="sourceLine" id="cb2087-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb2087-9" data-line-number="9">(p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2087-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">7</span>)) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb2087-11" data-line-number="11"><span class="st">  </span><span class="kw">theme_grey</span>() <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb2087-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb2087-13" data-line-number="13">        <span class="dt">title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="fl">10.5</span>))) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2087-14" data-line-number="14"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">guides =</span> <span class="st">&#39;collect&#39;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-44-1.png" style="display: block; margin: auto;" /></p>
<p>“Which of the analyses yields the more trustworthy conclusion? The one that describes the data better. In these cases, there is no doubt that the cumulative-normal model is the better description of the data” than the conventional Gaussian model (p. 682).</p>
</div>
<div id="ordinal-outcomes-versus-likert-scales." class="section level4">
<h4><span class="header-section-number">23.2.2.2</span> Ordinal outcomes versus Likert scales.</h4>
<p>Just for fun,</p>
<blockquote>
<p>rate how much you agree with the statement, “Bayesian estimation is more informative than null-hypothesis significance testing,” by selecting one option from the following: 1 = strongly disagree; 2 = disagree; 3 = undecided; 4 = agree; 5 = strongly agree. This sort of ordinal response interface is often called a Likert-type response (<a href="https://legacy.voteview.com/pdf/Likert_1932.pdf">Likert, 1932</a>, pronounced LICK-ert not LIKE-ert). Sometimes, it is called a Likert “scale” but the term “scale” in this context is more properly reserved for referring to an underlying metric variable that is indicated by the arithmetic mean of several meaningfully related Likert-type responses (e.g., Carifio &amp; Perla, <a href="https://thescipub.com/pdf/10.3844/jssp.2007.106.116">2007</a>, <a href="https://pdfs.semanticscholar.org/795d/7d9c30bb0ba54d078215f9239a865960eea6.pdf">2008</a>; <a href="https://www.researchgate.net/publication/41420484_LIkert_scales_levels_of_measurement_adn_the_laws_of_statistics">Norman, 2010</a>). (p. 681)</p>
</blockquote>
<p>Kruschke then briefly introduced how one might combine several such meaningfully-related Likert-type responses with latent variable methods. He then clarified this text will not explore that approach, further. The current version of <strong>brms</strong> (i.e., <a href="https://CRAN.R-project.org/package=brms/news/news.html">2.11.1</a>) has very limited latent variable capacities. However, they are in the works. Interested modelers can follow Bürkner’s progress in <a href="https://github.com/paul-buerkner/brms/issues/304">GitHub issue #304</a>. He also has <a href="https://arxiv.org/pdf/1905.09501.pdf">a paper</a> on how one might use <strong>brms</strong> to fit item response theory models, which can be viewed as a special family of latent variable models. One can also fit Bayesian latent variable models with the <a href="https://faculty.missouri.edu/~merklee/blavaan/"><strong>blavaan</strong> package</a>.</p>
</div>
</div>
</div>
<div id="the-case-of-two-groups" class="section level2">
<h2><span class="header-section-number">23.3</span> The case of two groups</h2>
<blockquote>
<p>In both examples in the preceding text, the two groups of outcomes were on the same ordinal scale. In the first example, both questionnaire statements were answered on the same disagree–agree scale. In the second example, both groups responded on the same very unhappy–very happy scale. Therefore, we assume that both groups have the same underlying metric variable with the same thresholds. (p. 682)</p>
</blockquote>
<div id="implementation-in-jags-brms.-4" class="section level3">
<h3><span class="header-section-number">23.3.1</span> Implementation in <del>JAGS</del> <strong>brms</strong>.</h3>
<p>The <code>brm()</code> syntax for adding a single categorical predictor to an ordered-probit model is much like that for any other likelihood. We just add the variable name to the right side of the <code>~</code> in the <code>formula</code> argument. If you’re like me and like to use the verbose <code>1</code> syntax for your model intercepts–thresholds in these models–just use the <code>+</code> operator between them. For example, this is what it’d look like for an ordered-categorical criterion <code>y</code> and a single categorical predictor <code>x</code>.</p>
<div class="sourceCode" id="cb2088"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2088-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb2088-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2088-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2088-4" data-line-number="4">      y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x,</a>
<a class="sourceLine" id="cb2088-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2088-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b)))</a></code></pre></div>
<p>Also of note, we’ve expanded the <code>prior</code> section to include a line for <code>class = b</code>. As with the thresholds, interpret this prior through the context of the underlying standard normal cumulative distribution, <span class="math inline">\(\Phi(z)\)</span>. Note the interpretation, though. By <strong>brms</strong> defaults, the underlying Gaussian for the reference category of <code>x</code> will be <span class="math inline">\(\operatorname{Normal} (0, 1)\)</span>. Thus whatever parameter value you get for the other categories in <code>x</code>, those will be standardized mean differences, making them a kind of effect size.</p>
<p>Note, the above all presumes you’re only interested in comparing means between groups. Things get more complicated if you want groups to vary by <span class="math inline">\(\sigma\)</span>, too. Hold on tight!</p>
<p>First, look back at the output from <code>print(fit1)</code> or <code>print(fit2)</code>. The second line for both reads: <code>Links: mu = probit; disc = identity</code>. Hopefully the <code>mu = probit</code> part is no surprise. Probit regression is the primary focus of this chapter. But check out the <code>disc = identity</code> part and notice that nowhere in there is there any mention of <code>sigma = identity</code> like we get when treating the criterion as metric as in conventional Gaussian models (i.e., execute <code>print(fit3)</code> or <code>print(fit4)</code>).</p>
<p>Yes, there is a relationship between <code>disc</code> and <code>sigma</code>. <code>disc</code> is shorthand for <em>discrimination</em>. The term comes from the item response theory (IRT) literature and discrimination is the inverse of <span class="math inline">\(\sigma\)</span> (see Bürkner’s <a href="https://arxiv.org/pdf/1905.09501.pdf"><em>Bayesian Item Response Modelling in R with brms and Stan</em></a>). In IRT, discrimination is often denoted <span class="math inline">\(a\)</span> or <span class="math inline">\(\alpha\)</span>. Here I’ll adopt the latter, making <span class="math inline">\(\sigma = 1 / \alpha\)</span>. But focusing back on <strong>brms</strong> summary output, notice how both <code>disc</code> and <code>sigma</code> are modeled using the identity link. If you recall from earlier chapters, we switched to the log link to constrain the values to zero and above when we allowed <span class="math inline">\(\sigma\)</span> to vary across groups. It’s the same thing for our discrimination parameter, <span class="math inline">\(\alpha\)</span>. Because <span class="math inline">\(\alpha\)</span> should always be zero or above, <strong>brms</strong> defaults to the log link when modeling it with predictors.</p>
<p>As with <span class="math inline">\(\sigma\)</span> in conventional Gaussian models, we’ll be using some version of the <code>bf()</code> syntax when modeling the discrimination parameter in <strong>brms</strong>. For a general introduction to what Bürkner calls distributional modeling, see his vignette, <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_distreg.html"><em>Estimating Distributional Models with brms</em></a>. In the case of the discrimination parameter for the cumulative model, we’ll want more focused instructions. Happily, Bürkner and Vouree <a href="https://journals.sagepub.com/doi/abs/10.1177/2515245918823199">(2019)</a> have our backs. We read:</p>
<blockquote>
<p>Conceptually, unequal variances are incorporated in the model by specifying an additional regression formula for the variance component of the latent variable <span class="math inline">\(\tilde Y\)</span>. In brms, the parameter related to latent variances is called <em>disc</em> (short for “discrimination”), following conventions in item response theory. Note that disc is not the variance itself, but the inverse of the standard deviation, <span class="math inline">\(s.\)</span> That is, <span class="math inline">\(s = 1/ \text{disc}\)</span>. Further, because disc must be strictly positive, it is by default modeled on the log scale.</p>
<p>Predicting auxiliary parameters (parameters of the distribution other than the mean/location) in brms is accomplished by passing multiple regression formulas to the <code>brm()</code> function. Each formula must first be wrapped in another function, <code>bf()</code> or <code>lf()</code> (for “linear formula”)–depending on whether it is a main or an auxiliary formula, respectively. The formulas are then combined and passed to the <code>formula</code> argument of <code>brm()</code>. Because the standard deviation of the latent variable is fixed to 1 for the baseline [group, disc cannot be estimated for the baseline group]. We must therefore ensure that disc is estimated only for [non-baseline groups]. To do so, we omit the intercept from the model of disc by writing <code>0 + ...</code> on the right-hand side of the regression formula. By default, R applies cell-mean coding to factors in formulas without an intercept. That would lead to disc being estimated for [all groups], so we must deactivate it via the <code>cmc</code> argument of <code>lf()</code>. (pp. 11–12)</p>
</blockquote>
<p>Here’s what that might look like.</p>
<div class="sourceCode" id="cb2089"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2089-1" data-line-number="1">fit &lt;-</a>
<a class="sourceLine" id="cb2089-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2089-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2089-4" data-line-number="4">      <span class="kw">bf</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x) <span class="op">+</span></a>
<a class="sourceLine" id="cb2089-5" data-line-number="5"><span class="st">        </span><span class="kw">lf</span>(disc <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">cmc =</span> F),</a>
<a class="sourceLine" id="cb2089-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2089-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2089-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b, <span class="dt">dpar =</span> disc)))</a></code></pre></div>
<p>Note how when using the <code>disc ~ 0 + ...</code> syntax, the <code>disc</code> parameters are of <code>class = b</code> within the <code>prior()</code> function. If you’d like to assign them priors differing from the other <code>b</code> parameters, you’ll need to specify <code>dpar = disc</code>. Again, though the mean structure for this model is on the probit scale, the discrimination structure is on the log scale. Recalling that <span class="math inline">\(\sigma = 1/\alpha\)</span>, which means <span class="math inline">\(\alpha = 1/\sigma\)</span>, and also that we’re modeling <span class="math inline">\(\log (\alpha)\)</span>, the priors for the standard deviations of the non-reference category groups are on the scale of <span class="math inline">\(\log (1 / \sigma)\)</span>.</p>
<p>To get a better sense of how one might set a prior on such a scale, we might compare <span class="math inline">\(\sigma\)</span>, <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(\log (\alpha)\)</span>. Here are the density and cumulative density functions for <span class="math inline">\(\operatorname{Normal} (0, 0.5)\)</span>, <span class="math inline">\(\operatorname{Normal} (0, 1)\)</span>, and <span class="math inline">\(\operatorname{Normal} (0, 2)\)</span>.</p>
<div class="sourceCode" id="cb2090"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2090-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">mu    =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2090-2" data-line-number="2">       <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2090-3" data-line-number="3"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(mu, sigma),</a>
<a class="sourceLine" id="cb2090-4" data-line-number="4">         <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2090-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span>   =<span class="st"> </span><span class="kw">dnorm</span>(y, mu, sigma),</a>
<a class="sourceLine" id="cb2090-6" data-line-number="6">         <span class="st">`</span><span class="dt">Phi(y)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">pnorm</span>(y, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2090-7" data-line-number="7"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">alpha =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sigma,</a>
<a class="sourceLine" id="cb2090-8" data-line-number="8">         <span class="dt">loga  =</span> <span class="kw">log</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2090-9" data-line-number="9"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">label =</span> <span class="kw">str_c</span>(<span class="st">&quot;list(sigma==&quot;</span>, sigma, <span class="st">&quot;,alpha==&quot;</span>, alpha, <span class="st">&quot;,log(alpha)==&quot;</span>, <span class="kw">round</span>(loga, <span class="dv">2</span>), <span class="st">&quot;)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2090-10" data-line-number="10"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">p(y)</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Phi(y)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2090-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb2090-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2090-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2090-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2090-15" data-line-number="15"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2090-16" data-line-number="16"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="dv">-4</span><span class="op">:</span><span class="dv">4</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2090-17" data-line-number="17"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2090-18" data-line-number="18"><span class="st">  </span><span class="kw">facet_grid</span>(name<span class="op">~</span>label, <span class="dt">labeller =</span> label_parsed, <span class="dt">switch =</span> <span class="st">&quot;y&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-47-1.png" style="display: block; margin: auto;" /></p>
<p>Put another way, here’s how <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\log (\alpha)\)</span> scale on values of <span class="math inline">\(\sigma\)</span> ranging from 0.0001 to 10.</p>
<div class="sourceCode" id="cb2091"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2091-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">sigma =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.0001</span>, <span class="dt">to =</span> <span class="dv">10</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2091-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">alpha        =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sigma,</a>
<a class="sourceLine" id="cb2091-3" data-line-number="3">         <span class="st">`</span><span class="dt">log(alpha)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2091-4" data-line-number="4"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>sigma, <span class="dt">names_to =</span> <span class="st">&quot;labels&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2091-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2091-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> sigma, <span class="dt">y =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2091-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2091-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2091-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2091-10" data-line-number="10"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">-2</span><span class="op">:</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2091-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2091-12" data-line-number="12"><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>labels, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-48-1.png" style="display: block; margin: auto;" /></p>
<p>When <span class="math inline">\(\sigma\)</span> goes below 1, both explode upward. As <span class="math inline">\(\sigma\)</span> increases, <span class="math inline">\(\alpha\)</span> asymptotes at zero and <span class="math inline">\(\log (\alpha)\)</span> slowly descends below zero. Put another way, here is how <span class="math inline">\(\sigma\)</span> scales as a function of <span class="math inline">\(\log (\alpha)\)</span>.</p>
<div class="sourceCode" id="cb2092"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2092-1" data-line-number="1"><span class="kw">tibble</span>(<span class="st">`</span><span class="dt">log(alpha)</span><span class="st">`</span> =<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.01</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2092-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sigma =</span> <span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(<span class="st">`</span><span class="dt">log(alpha)</span><span class="st">`</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2092-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb2092-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">log(alpha)</span><span class="st">`</span>, <span class="dt">y =</span> sigma)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2092-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2092-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="fl">1.5</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2092-7" data-line-number="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">expression</span>(<span class="kw">log</span>(alpha)),</a>
<a class="sourceLine" id="cb2092-8" data-line-number="8">       <span class="dt">y =</span> <span class="kw">expression</span>(sigma)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2092-9" data-line-number="9"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>, <span class="fl">2.5</span>),</a>
<a class="sourceLine" id="cb2092-10" data-line-number="10">                  <span class="dt">ylim =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">10</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2092-11" data-line-number="11"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-49-1.png" style="display: block; margin: auto;" /></p>
<p>In the context where the underlying distribution for the reference category will be the standard normal, it seems like a <span class="math inline">\(\operatorname{Normal} (0, 1)\)</span> prior would be fairly permissive for <span class="math inline">\(\log (\alpha)\)</span>. This is what I will use going forward. Choose your priors with care.</p>
</div>
<div id="examples-not-funny." class="section level3">
<h3><span class="header-section-number">23.3.2</span> Examples: Not funny.</h3>
<p>Load the data for the next model.</p>
<div class="sourceCode" id="cb2093"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2093-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/OrdinalProbitData1.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2093-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2093-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 88
## Variables: 2
## $ X &lt;chr&gt; &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A&quot;, &quot;A…
## $ Y &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2…</code></pre>
<p>Fit the first ordinal probit model with group-specific <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> values for the underlying normal distributions for the ordinal variable <code>Y</code>.</p>
<div class="sourceCode" id="cb2095"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2095-1" data-line-number="1">fit23<span class="fl">.5</span> &lt;-</a>
<a class="sourceLine" id="cb2095-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2095-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2095-4" data-line-number="4">      <span class="kw">bf</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>X) <span class="op">+</span></a>
<a class="sourceLine" id="cb2095-5" data-line-number="5"><span class="st">        </span><span class="kw">lf</span>(disc <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X, <span class="dt">cmc =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb2095-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2095-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2095-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> b, <span class="dt">dpar =</span> disc)),</a>
<a class="sourceLine" id="cb2095-9" data-line-number="9">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2095-10" data-line-number="10">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2095-11" data-line-number="11">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.05&quot;</span>)</a></code></pre></div>
<p>Look over the summary.</p>
<div class="sourceCode" id="cb2096"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2096-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.5</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = log 
## Formula: Y ~ 1 + X 
##          disc ~ 0 + X
##    Data: my_data (Number of observations: 88) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]     0.49      0.20     0.11     0.89 1.00     9299     6066
## Intercept[2]     1.30      0.23     0.85     1.76 1.00    10487     5485
## Intercept[3]     2.20      0.38     1.54     3.01 1.00     5559     5620
## Intercept[4]     3.43      0.83     2.16     5.42 1.00     4253     5610
## XB               0.44      0.34    -0.28     1.05 1.00     4716     3738
## disc_XB         -0.31      0.28    -0.86     0.22 1.00     3433     4450
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Because our fancy new parameter <code>disc_XB</code> is on the <span class="math inline">\(\log (\alpha)\)</span> scale, we can convert it to the <span class="math inline">\(\sigma\)</span> scale with <span class="math inline">\(\frac{1}{\exp (\log \alpha)}\)</span>. For a quick and dirty example, here it is with the posterior mean.</p>
<div class="sourceCode" id="cb2098"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2098-1" data-line-number="1"><span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">fixef</span>(fit23<span class="fl">.5</span>)[<span class="st">&quot;disc_XB&quot;</span>, <span class="dv">1</span>]))</a></code></pre></div>
<pre><code>## [1] 1.368896</code></pre>
<p>Before we follow along with Kruschke, let’s hammer the meaning of these model parameters home. Here is a density plot of the two underlying latent distributions for <code>Y</code>, given <code>X</code>. We’ll throw in the thresholds for good measure. To keep things simple, we’ll just express the distributions in terms of the posterior means of each parameter.</p>
<div class="sourceCode" id="cb2100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2100-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">X     =</span> LETTERS[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2100-2" data-line-number="2">       <span class="dt">mu    =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">fixef</span>(fit23<span class="fl">.5</span>)[<span class="st">&quot;XB&quot;</span>, <span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb2100-3" data-line-number="3">       <span class="dt">sigma =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span> <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="kw">fixef</span>(fit23<span class="fl">.5</span>)[<span class="st">&quot;disc_XB&quot;</span>, <span class="dv">1</span>])))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2100-4" data-line-number="4"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(X, mu, sigma),</a>
<a class="sourceLine" id="cb2100-5" data-line-number="5">         <span class="dt">y =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2100-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dnorm</span>(y, mu, sigma)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2100-7" data-line-number="7"><span class="st">  </span></a>
<a class="sourceLine" id="cb2100-8" data-line-number="8"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> X),</a>
<a class="sourceLine" id="cb2100-10" data-line-number="10">              <span class="dt">alpha =</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">fixef</span>(fit23<span class="fl">.5</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2100-12" data-line-number="12">             <span class="dt">color =</span> <span class="st">&quot;grey75&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-13" data-line-number="13"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">sec.axis =</span> <span class="kw">dup_axis</span>(<span class="dt">breaks =</span> <span class="kw">fixef</span>(fit23<span class="fl">.5</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.double</span>(),</a>
<a class="sourceLine" id="cb2100-14" data-line-number="14">                                         <span class="dt">labels =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="st">&quot;]&quot;</span>)))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-15" data-line-number="15"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_fill_viridis_d</span>(<span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">begin =</span> <span class="fl">.33</span>, <span class="dt">end =</span> <span class="fl">.67</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Underlying latent scale for Y, given X&quot;</span>,</a>
<a class="sourceLine" id="cb2100-18" data-line-number="18">       <span class="dt">x =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2100-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),</a>
<a class="sourceLine" id="cb2100-20" data-line-number="20">        <span class="dt">axis.ticks.x.top =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-53-1.png" style="display: block; margin: auto;" /></p>
<p>Returning to our previous workflow, extract the posterior draws and wrangle.</p>
<div class="sourceCode" id="cb2101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2101-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2101-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.5</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2101-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb2101-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2101-5" data-line-number="5"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 8,000
## Variables: 8
## $ `b_Intercept[1]` &lt;dbl&gt; 0.367300818, 0.382564379, 0.409425986, 0.288490883, 0.008978847, 0.643486264, 0.76…
## $ `b_Intercept[2]` &lt;dbl&gt; 1.3844545, 1.0726888, 1.1754398, 0.9113326, 0.9676571, 1.3374801, 1.4323809, 1.501…
## $ `b_Intercept[3]` &lt;dbl&gt; 2.242209, 2.073569, 2.091679, 1.993377, 1.911539, 2.290516, 2.281980, 2.353368, 2.…
## $ `b_Intercept[4]` &lt;dbl&gt; 3.394341, 3.393257, 3.350974, 2.801191, 2.636229, 3.168556, 3.780114, 4.075613, 4.…
## $ b_XB             &lt;dbl&gt; 0.67918461, 0.22528956, 0.50615392, 0.01511700, -0.71507783, -0.07491061, 0.151551…
## $ b_disc_XB        &lt;dbl&gt; -0.66137007, -0.49036663, -0.05895237, -0.41540676, -0.56076002, -0.58665895, -0.4…
## $ lp__             &lt;dbl&gt; -109.8339, -107.9836, -107.6560, -109.3514, -113.1869, -110.4044, -110.1080, -110.…
## $ iter             &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,…</code></pre>
<p>Now, let’s use our handy <code>compare_thresholds()</code> function to make an expanded version of the lower-left plot of Figure 23.4.</p>
<div class="sourceCode" id="cb2103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2103-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2103-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[4]</span><span class="st">`</span>, iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2103-3" data-line-number="3"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">4.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-55-1.png" style="display: block; margin: auto;" /></p>
<p>It will no longer be straightforward to use the formulas from 23.2.2 to convert the output from our <strong>brms</strong> parameterization to match the way Kruschke parameterized his conditional means and standard deviations. I will leave the conversion up to the interested reader. Going forward, we will focus on the output from our <strong>brms</strong> parameterization.</p>
<div class="sourceCode" id="cb2104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2104-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2104-2" data-line-number="2"><span class="st">  </span><span class="co"># simple parameters</span></a>
<a class="sourceLine" id="cb2104-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">mu[A]</span><span class="st">`</span>    =<span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2104-4" data-line-number="4">         <span class="st">`</span><span class="dt">mu[B]</span><span class="st">`</span>    =<span class="st"> </span>b_XB,</a>
<a class="sourceLine" id="cb2104-5" data-line-number="5">         <span class="st">`</span><span class="dt">sigma[A]</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2104-6" data-line-number="6">         <span class="st">`</span><span class="dt">sigma[B]</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(b_disc_XB)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2104-7" data-line-number="7"><span class="st">  </span><span class="co"># simple differences</span></a>
<a class="sourceLine" id="cb2104-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">mu[B]-mu[A]</span><span class="st">`</span>       =<span class="st"> `</span><span class="dt">mu[B]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">mu[A]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2104-9" data-line-number="9">         <span class="st">`</span><span class="dt">sigma[B]-sigma[A]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">sigma[B]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">sigma[A]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2104-10" data-line-number="10"><span class="st">  </span><span class="co"># effect size</span></a>
<a class="sourceLine" id="cb2104-11" data-line-number="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">(mu[B]-mu[A])/sqrt((sigma[A]^2+sigma[B]^2)/2)</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">mu[B]-mu[A]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="st">`</span><span class="dt">sigma[A]</span><span class="st">`</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> `</span><span class="dt">sigma[B]</span><span class="st">`</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2104-12" data-line-number="12"><span class="st">  </span><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb2104-13" data-line-number="13"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">mu[A]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">(mu[B]-mu[A])/sqrt((sigma[A]^2+sigma[B]^2)/2)</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2104-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb2104-15" data-line-number="15">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;mu[A]&quot;</span>, <span class="st">&quot;mu[B]&quot;</span>, <span class="st">&quot;mu[B]-mu[A]&quot;</span>,</a>
<a class="sourceLine" id="cb2104-16" data-line-number="16">                                  <span class="st">&quot;sigma[A]&quot;</span>, <span class="st">&quot;sigma[B]&quot;</span>, <span class="st">&quot;sigma[B]-sigma[A]&quot;</span>,</a>
<a class="sourceLine" id="cb2104-17" data-line-number="17">                                  <span class="st">&quot;(mu[B]-mu[A])/sqrt((sigma[A]^2+sigma[B]^2)/2)&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2104-18" data-line-number="18"><span class="st">  </span></a>
<a class="sourceLine" id="cb2104-19" data-line-number="19"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb2104-20" data-line-number="20"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2104-21" data-line-number="21"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2104-22" data-line-number="22">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2104-23" data-line-number="23">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2104-24" data-line-number="24">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2104-25" data-line-number="25"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2104-26" data-line-number="26"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2104-27" data-line-number="27"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2104-28" data-line-number="28"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-57-1.png" style="display: block; margin: auto;" /></p>
<p><span class="math inline">\(\mu_A\)</span> and <span class="math inline">\(\sigma_A\)</span> are both constants, which doesn’t show up well with our <code>geom_histogram()</code> approach with the scales freed across facets. If these plots really mattered for a scientific presentation or something for industry, you could experiment using either a common scale across all facets, or making the plots individually and then combining them with <strong>patchwork</strong> syntax. Returning to interpretation, because <span class="math inline">\(\mu_A = 0\)</span>, it turns out that <span class="math inline">\(\mu_B - \mu_A = \mu_B\)</span>, which is on display on the top row. Because <span class="math inline">\(\sigma_A = 1\)</span>, it turns out that <span class="math inline">\(\sigma_B - \sigma_A\)</span> is just <span class="math inline">\(\sigma_B\)</span> moved over one unit to the left, which is hopefully clear in the panels of the second row. Very happily, the effect size formula worked with our <strong>brms</strong> parameters the same way it did for Kruschke’s. Both yield an effect size of about 0.5, with 95% intervals extending about <span class="math inline">\(\mp 0.5\)</span>.</p>
<p>Here we make good use of the <code>type = &quot;bars_grouped&quot;</code> and <code>group = &quot;X&quot;</code> arguments to make the posterior predictive plots at the top right of Figure 23.4 with the <code>brms::pp_check()</code> function.</p>
<div class="sourceCode" id="cb2105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2105-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2105-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2105-3" data-line-number="3"><span class="kw">pp_check</span>(fit23<span class="fl">.5</span>, <span class="dt">type =</span> <span class="st">&quot;bars_grouped&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">100</span>, <span class="dt">group =</span> <span class="st">&quot;X&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2105-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2105-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2105-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with posterior predictions&quot;</span>,</a>
<a class="sourceLine" id="cb2105-7" data-line-number="7">          <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">list</span>(<span class="kw">italic</span>(N[A])<span class="op">==</span><span class="dv">44</span>, <span class="kw">italic</span>(N[B])<span class="op">==</span><span class="dv">44</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2105-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">9</span>, <span class="fl">.8</span>))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-58-1.png" style="display: block; margin: auto;" /></p>
<p>Using more tricks from back in Chapter 16, here’s the corresponding conventional Gaussian model for metric data.</p>
<div class="sourceCode" id="cb2106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2106-1" data-line-number="1">mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2106-2" data-line-number="2">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2106-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2106-4" data-line-number="4">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2106-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2106-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a>
<a class="sourceLine" id="cb2106-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2106-8" data-line-number="8">fit23<span class="fl">.6</span> &lt;-</a>
<a class="sourceLine" id="cb2106-9" data-line-number="9"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2106-10" data-line-number="10">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb2106-11" data-line-number="11">      <span class="kw">bf</span>(Y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X, sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>X),</a>
<a class="sourceLine" id="cb2106-12" data-line-number="12">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2106-13" data-line-number="13">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> b, <span class="dt">dpar =</span> sigma)),</a>
<a class="sourceLine" id="cb2106-14" data-line-number="14">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2106-15" data-line-number="15">      <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb2106-16" data-line-number="16">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2106-17" data-line-number="17">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.06&quot;</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb2107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2107-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.6</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = log 
## Formula: Y ~ 0 + X 
##          sigma ~ 0 + X
##    Data: my_data (Number of observations: 88) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##          Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## XA           1.43      0.12     1.19     1.66 1.00     3892     3041
## XB           1.86      0.16     1.55     2.18 1.00     4238     2770
## sigma_XA    -0.26      0.11    -0.45    -0.03 1.00     3664     2789
## sigma_XB     0.08      0.11    -0.13     0.30 1.00     4071     2889
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Here are the marginal posteriors, including the effect size.</p>
<div class="sourceCode" id="cb2109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2109-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit23<span class="fl">.6</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2109-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">A mean</span><span class="st">`</span>      =<span class="st"> </span>b_XA,</a>
<a class="sourceLine" id="cb2109-3" data-line-number="3">         <span class="st">`</span><span class="dt">B mean</span><span class="st">`</span>      =<span class="st"> </span>b_XB,</a>
<a class="sourceLine" id="cb2109-4" data-line-number="4">         <span class="st">`</span><span class="dt">A Std. Dev.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_XA),</a>
<a class="sourceLine" id="cb2109-5" data-line-number="5">         <span class="st">`</span><span class="dt">B Std. Dev.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_XB)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2109-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Difference of Means</span><span class="st">`</span>     =<span class="st"> `</span><span class="dt">B mean</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">A mean</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2109-7" data-line-number="7">         <span class="st">`</span><span class="dt">Difference of Std. Devs</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">B Std. Dev.</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">A Std. Dev.</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2109-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">Difference of Means</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span>((<span class="st">`</span><span class="dt">A Std. Dev.</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">B Std. Dev.</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2109-9" data-line-number="9"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">A mean</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2109-10" data-line-number="10"><span class="st">  </span></a>
<a class="sourceLine" id="cb2109-11" data-line-number="11"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2109-12" data-line-number="12"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2109-13" data-line-number="13">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2109-14" data-line-number="14">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2109-15" data-line-number="15">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2109-16" data-line-number="16"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2109-17" data-line-number="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;These are based on the conventional Gaussian model, NOT the cumulative-normal</span><span class="ch">\n</span><span class="st">model Kruschke displayed in Figure 23.4&quot;</span>,</a>
<a class="sourceLine" id="cb2109-18" data-line-number="18">       <span class="dt">x =</span> <span class="st">&quot;Marginal posterior&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2109-19" data-line-number="19"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2109-20" data-line-number="20"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-60-1.png" style="display: block; margin: auto;" /></p>
<p>Compare those results to those Kruschke reported from an NHST analysis in the note below Figure 23.4:</p>
<blockquote>
<p><span class="math inline">\(M_1 = 1.43, M_2 = 1.86, t = 2.18, p = 0.032\)</span>, with effect size <span class="math inline">\(d = 0.466\)</span> with 95% CI of <span class="math inline">\(0.036-0.895\)</span>. An <span class="math inline">\(F\)</span> test of the variances concludes that the standard deviations are significantly different: <span class="math inline">\(S_1 = 0.76, S_2 = 1.07, p = 0.027\)</span>. Notice in this case that treating the values as metric greatly underestimates their variances, as well as erroneously concludes the variances are different. (p. 684)</p>
</blockquote>
<p>As to the data in the analyses Kruschke reported in Figure 23.5 and the prose in the second paragraph on page 685, I’m not aware that Kruschke provided them. From his footnote #2, we read: “Data in Figure 23.5 are from an as-yet unpublished study I conducted with the collaboration of Allison Vollmer as part of her undergraduate honors project.” In place of the real data, I eyeballed the values based on the upper-right panels in Figure 23.5. Here they are.</p>
<div class="sourceCode" id="cb2110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2110-1" data-line-number="1">d &lt;-</a>
<a class="sourceLine" id="cb2110-2" data-line-number="2"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">rep</span>(<span class="kw">str_c</span>(<span class="st">&quot;joke &quot;</span>, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">6</span>)), <span class="dt">each =</span> <span class="dv">177</span>),</a>
<a class="sourceLine" id="cb2110-3" data-line-number="3">         <span class="dt">y =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">95</span>, <span class="dv">19</span>, <span class="dv">18</span>, <span class="dv">10</span>, <span class="dv">17</span>, <span class="dv">10</span>, <span class="dv">8</span>)),</a>
<a class="sourceLine" id="cb2110-4" data-line-number="4">               <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">53</span>, <span class="dv">33</span>, <span class="dv">31</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">14</span>, <span class="dv">1</span>))))</a>
<a class="sourceLine" id="cb2110-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2110-6" data-line-number="6"><span class="kw">glimpse</span>(d)</a></code></pre></div>
<pre><code>## Observations: 354
## Variables: 2
## $ x &lt;chr&gt; &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1&quot;, &quot;joke 1…
## $ y &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…</code></pre>
<p>My approximation to Kruschke’s data looks like this.</p>
<div class="sourceCode" id="cb2112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2112-1" data-line-number="1">d <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2112-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2112-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2112-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2112-5" data-line-number="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2112-6" data-line-number="6"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>x, <span class="dt">ncol =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-62-1.png" style="display: block; margin: auto;" /></p>
<p>Here we fit the cumulative-normal model based on our version of the data, continuing to allow both <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> (i.e., <span class="math inline">\(1 / \exp(\log \alpha)\)</span>) to differ across groups.</p>
<div class="sourceCode" id="cb2113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2113-1" data-line-number="1">fit23<span class="fl">.7</span> &lt;-</a>
<a class="sourceLine" id="cb2113-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb2113-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2113-4" data-line-number="4">      <span class="kw">bf</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x) <span class="op">+</span></a>
<a class="sourceLine" id="cb2113-5" data-line-number="5"><span class="st">        </span><span class="kw">lf</span>(disc <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, <span class="dt">cmc =</span> <span class="ot">FALSE</span>),</a>
<a class="sourceLine" id="cb2113-6" data-line-number="6">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2113-7" data-line-number="7">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2113-8" data-line-number="8">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">class =</span> b, <span class="dt">dpar =</span> disc)),</a>
<a class="sourceLine" id="cb2113-9" data-line-number="9">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2113-10" data-line-number="10">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2113-11" data-line-number="11">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.07&quot;</span>)</a></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb2114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2114-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.7</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = log 
## Formula: y ~ 1 + x 
##          disc ~ 0 + x
##    Data: d (Number of observations: 354) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]     0.07      0.09    -0.11     0.26 1.00     5213     5865
## Intercept[2]     0.37      0.09     0.19     0.54 1.00     7007     6115
## Intercept[3]     0.65      0.09     0.48     0.83 1.00     8519     6245
## Intercept[4]     0.87      0.10     0.69     1.06 1.00     8483     6724
## Intercept[5]     1.26      0.12     1.04     1.49 1.00     6803     6073
## Intercept[6]     1.81      0.16     1.51     2.15 1.00     6934     5574
## xjoke6           0.39      0.10     0.20     0.59 1.00     7524     6368
## disc_xjoke6      0.49      0.12     0.26     0.72 1.00     4006     5322
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Save and wrangle the posterior draws, then use our <code>compare_thresholds()</code> function to compare the <strong>brms</strong> parameterization of <span class="math inline">\(\theta_{[i]}\)</span> with the parameterization in the text in an expanded version of the lower-left plot of Figure 23.5.</p>
<div class="sourceCode" id="cb2116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2116-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2116-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.7</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2116-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb2116-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2116-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2116-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>, iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2116-7" data-line-number="7"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">6.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-64-1.png" style="display: block; margin: auto;" /></p>
<p>Given our data are only approximations of Kruschke’s, I think we did pretty good. Here are the histograms for our <strong>brms</strong> versions of the <span class="math inline">\(\mu\)</span>- and <span class="math inline">\(\sigma\)</span>-related parameters.</p>
<div class="sourceCode" id="cb2117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2117-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2117-2" data-line-number="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="st">`</span><span class="dt">mu[Joke~1]</span><span class="st">`</span>    =<span class="st"> </span><span class="dv">0</span>,</a>
<a class="sourceLine" id="cb2117-3" data-line-number="3">            <span class="st">`</span><span class="dt">mu[Joke~6]</span><span class="st">`</span>    =<span class="st"> </span>b_xjoke6,</a>
<a class="sourceLine" id="cb2117-4" data-line-number="4">            <span class="st">`</span><span class="dt">sigma[Joke~1]</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2117-5" data-line-number="5">            <span class="st">`</span><span class="dt">sigma[Joke~6]</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw">exp</span>(b_disc_xjoke6)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2117-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">mu[Joke~6]-mu[Joke~1]</span><span class="st">`</span>       =<span class="st"> `</span><span class="dt">mu[Joke~6]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">mu[Joke~1]</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2117-7" data-line-number="7">         <span class="st">`</span><span class="dt">sigma[Joke~6]-sigma[Joke~1]</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">sigma[Joke~6]</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">sigma[Joke~1]</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2117-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">(mu[Joke~6]-mu[Joke~1])/sqrt((sigma[Joke~1]^2+sigma[Joke~6]^2)/2)</span><span class="st">`</span> =<span class="st"> </span>(<span class="st">`</span><span class="dt">mu[Joke~6]-mu[Joke~1]</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>((<span class="st">`</span><span class="dt">sigma[Joke~1]</span><span class="st">`</span><span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> `</span><span class="dt">sigma[Joke~6]</span><span class="st">`</span><span class="op">^</span><span class="dv">2</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2117-9" data-line-number="9"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2117-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb2117-11" data-line-number="11">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;mu[Joke~1]&quot;</span>, <span class="st">&quot;mu[Joke~6]&quot;</span>, <span class="st">&quot;mu[Joke~6]-mu[Joke~1]&quot;</span>,</a>
<a class="sourceLine" id="cb2117-12" data-line-number="12">                                  <span class="st">&quot;sigma[Joke~1]&quot;</span>, <span class="st">&quot;sigma[Joke~6]&quot;</span>, <span class="st">&quot;sigma[Joke~6]-sigma[Joke~1]&quot;</span>,</a>
<a class="sourceLine" id="cb2117-13" data-line-number="13">                                  <span class="st">&quot;(mu[Joke~6]-mu[Joke~1])/sqrt((sigma[Joke~1]^2+sigma[Joke~6]^2)/2)&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2117-14" data-line-number="14"><span class="st">  </span></a>
<a class="sourceLine" id="cb2117-15" data-line-number="15"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2117-16" data-line-number="16"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2117-17" data-line-number="17">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2117-18" data-line-number="18">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2117-19" data-line-number="19">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2117-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2117-21" data-line-number="21"><span class="st">  </span><span class="kw">xlab</span>(<span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2117-22" data-line-number="22"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2117-23" data-line-number="23"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">labeller =</span> label_parsed)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-65-1.png" style="display: block; margin: auto;" /></p>
<p>Here are our versions of the two panels in the upper right of Figure 23.5.</p>
<div class="sourceCode" id="cb2118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2118-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2118-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2118-3" data-line-number="3"><span class="kw">pp_check</span>(fit23<span class="fl">.7</span>, <span class="dt">type =</span> <span class="st">&quot;bars_grouped&quot;</span>, <span class="dt">nsamples =</span> <span class="dv">100</span>, <span class="dt">group =</span> <span class="st">&quot;x&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2118-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2118-5" data-line-number="5"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2118-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Data with posterior predictions&quot;</span>,</a>
<a class="sourceLine" id="cb2118-7" data-line-number="7">          <span class="dt">subtitle =</span> <span class="kw">expression</span>(<span class="kw">list</span>(<span class="kw">italic</span>(N[<span class="st">&quot;joke &quot;</span><span class="op">*</span><span class="dv">1</span>])<span class="op">==</span><span class="dv">177</span>, <span class="kw">italic</span>(N[<span class="st">&quot;joke &quot;</span><span class="op">*</span><span class="dv">6</span>])<span class="op">==</span><span class="dv">177</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2118-8" data-line-number="8"><span class="st">  </span><span class="kw">theme_grey</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2118-9" data-line-number="9"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb2118-10" data-line-number="10">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-66-1.png" style="display: block; margin: auto;" /></p>
<p>Now here’s the corresponding model where we treat the <code>y</code> data as metric.</p>
<div class="sourceCode" id="cb2119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2119-1" data-line-number="1">mean_y &lt;-<span class="st"> </span><span class="kw">mean</span>(d<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb2119-2" data-line-number="2">sd_y   &lt;-<span class="st"> </span><span class="kw">sd</span>(d<span class="op">$</span>y)</a>
<a class="sourceLine" id="cb2119-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2119-4" data-line-number="4">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2119-5" data-line-number="5"><span class="st">  </span><span class="kw">stanvar</span>(mean_y, <span class="dt">name =</span> <span class="st">&quot;mean_y&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2119-6" data-line-number="6"><span class="st">  </span><span class="kw">stanvar</span>(sd_y,   <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a>
<a class="sourceLine" id="cb2119-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2119-8" data-line-number="8">fit23<span class="fl">.8</span> &lt;-</a>
<a class="sourceLine" id="cb2119-9" data-line-number="9"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> d,</a>
<a class="sourceLine" id="cb2119-10" data-line-number="10">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb2119-11" data-line-number="11">      <span class="kw">bf</span>(y <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x, sigma <span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>x),</a>
<a class="sourceLine" id="cb2119-12" data-line-number="12">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(mean_y, sd_y <span class="op">*</span><span class="st"> </span><span class="dv">100</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2119-13" data-line-number="13">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="kw">exp</span>(sd_y)), <span class="dt">class =</span> b, <span class="dt">dpar =</span> sigma)),</a>
<a class="sourceLine" id="cb2119-14" data-line-number="14">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2119-15" data-line-number="15">      <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb2119-16" data-line-number="16">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2119-17" data-line-number="17">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.08&quot;</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb2120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2120-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.8</span>)</a></code></pre></div>
<pre><code>##  Family: gaussian 
##   Links: mu = identity; sigma = log 
## Formula: y ~ 0 + x 
##          sigma ~ 0 + x
##    Data: d (Number of observations: 354) 
## Samples: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
##          total post-warmup samples = 4000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## xjoke1           2.42      0.14     2.13     2.71 1.00     4069     2870
## xjoke6           2.86      0.13     2.60     3.11 1.00     4204     2955
## sigma_xjoke1     0.64      0.05     0.54     0.75 1.00     4299     2812
## sigma_xjoke6     0.52      0.05     0.42     0.63 1.00     4529     2910
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Make the marginal posteriors, including the effect size.</p>
<div class="sourceCode" id="cb2122"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2122-1" data-line-number="1"><span class="kw">posterior_samples</span>(fit23<span class="fl">.8</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2122-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Joke 1 Mean</span><span class="st">`</span>      =<span class="st"> </span>b_xjoke1,</a>
<a class="sourceLine" id="cb2122-3" data-line-number="3">         <span class="st">`</span><span class="dt">Joke 6 Mean</span><span class="st">`</span>      =<span class="st"> </span>b_xjoke6,</a>
<a class="sourceLine" id="cb2122-4" data-line-number="4">         <span class="st">`</span><span class="dt">Joke 1 Std. Dev.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_xjoke1),</a>
<a class="sourceLine" id="cb2122-5" data-line-number="5">         <span class="st">`</span><span class="dt">Joke 6 Std. Dev.</span><span class="st">`</span> =<span class="st"> </span><span class="kw">exp</span>(b_sigma_xjoke6)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2122-6" data-line-number="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Difference of Means</span><span class="st">`</span>     =<span class="st"> `</span><span class="dt">Joke 6 Mean</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">Joke 1 Mean</span><span class="st">`</span>,</a>
<a class="sourceLine" id="cb2122-7" data-line-number="7">         <span class="st">`</span><span class="dt">Difference of Std. Devs</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">Joke 6 Std. Dev.</span><span class="st">`</span> <span class="op">-</span><span class="st"> `</span><span class="dt">Joke 1 Std. Dev.</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2122-8" data-line-number="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span> =<span class="st"> `</span><span class="dt">Difference of Means</span><span class="st">`</span> <span class="op">/</span><span class="st"> </span>((<span class="st">`</span><span class="dt">Joke 1 Std. Dev.</span><span class="st">`</span> <span class="op">+</span><span class="st"> `</span><span class="dt">Joke 6 Std. Dev.</span><span class="st">`</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2122-9" data-line-number="9"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="st">`</span><span class="dt">Joke 1 Mean</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">Effect Size</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2122-10" data-line-number="10"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name, </a>
<a class="sourceLine" id="cb2122-11" data-line-number="11">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;Joke 1 Mean&quot;</span>, <span class="st">&quot;Joke 1 Std. Dev.&quot;</span>, </a>
<a class="sourceLine" id="cb2122-12" data-line-number="12">                                  <span class="st">&quot;Joke 6 Mean&quot;</span>, <span class="st">&quot;Joke 6 Std. Dev.&quot;</span>, </a>
<a class="sourceLine" id="cb2122-13" data-line-number="13">                                  <span class="st">&quot;Difference of Means&quot;</span>, <span class="st">&quot;Difference of Std. Devs&quot;</span>, </a>
<a class="sourceLine" id="cb2122-14" data-line-number="14">                                  <span class="st">&quot;Effect Size&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2122-15" data-line-number="15"><span class="st">  </span></a>
<a class="sourceLine" id="cb2122-16" data-line-number="16"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2122-17" data-line-number="17"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2122-18" data-line-number="18">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2122-19" data-line-number="19">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2122-20" data-line-number="20">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2122-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2122-22" data-line-number="22"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle =</span> <span class="st">&quot;These are based on the conventional Gaussian model, NOT the cumulative-normal</span><span class="ch">\n</span><span class="st">model Kruschke displayed in Figure 23.5&quot;</span>,</a>
<a class="sourceLine" id="cb2122-23" data-line-number="23">       <span class="dt">x =</span> <span class="st">&quot;Marginal posterior&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2122-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2122-25" data-line-number="25"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-68-1.png" style="display: block; margin: auto;" /></p>
<p>If you think you have a better approximation of Kruschke’s data, <a href="https://github.com/ASKurz/Doing-Bayesian-Data-Analysis-in-brms-and-the-tidyverse/issues">please share</a>.</p>
</div>
</div>
<div id="the-case-of-metric-predictors" class="section level2">
<h2><span class="header-section-number">23.4</span> The Case of metric predictors</h2>
<p>“This type of model is often referred to as <em>ordinal probit regression</em> or <em>ordered probit regression</em> because the probit function is the link function corresponding to the cumulative-normal inverse-link function” (p. 688, <em>emphasis</em> in the original).</p>
<div id="implementation-in-jags-brms.-5" class="section level3">
<h3><span class="header-section-number">23.4.1</span> Implementation in <del>JAGS</del> brms.</h3>
<p>This model is easy to specify in <strong>brms</strong>. Just make sure to think clearly about your priors.</p>
</div>
<div id="example-happiness-and-money." class="section level3">
<h3><span class="header-section-number">23.4.2</span> Example: Happiness and money.</h3>
<p>Load the data for the next model.</p>
<div class="sourceCode" id="cb2123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2123-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/OrdinalProbitData-LinReg-2.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2123-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2123-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 200
## Variables: 2
## $ X &lt;dbl&gt; 1.386389, 1.223879, 1.454505, 1.112068, 1.222715, 1.545099, 1.360256, 1.533071, 1.501657, 1.42675…
## $ Y &lt;dbl&gt; 1, 1, 5, 5, 1, 4, 6, 2, 5, 4, 1, 4, 4, 4, 4, 6, 1, 1, 6, 2, 1, 7, 1, 3, 1, 1, 7, 5, 7, 1, 4, 6, 7…</code></pre>
<p>Take a quick look at the data.</p>
<div class="sourceCode" id="cb2125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2125-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2125-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X, <span class="dt">y =</span> Y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2125-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2125-4" data-line-number="4"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2125-5" data-line-number="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-70-1.png" style="display: block; margin: auto;" /></p>
<p>Kruschke standardized his predictor within his model code. Here we’ll standardize <code>X</code> before fitting the model.</p>
<div class="sourceCode" id="cb2126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2126-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb2126-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2126-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">X_s =</span> (X <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(X)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(X))</a></code></pre></div>
<p>Fit the model.</p>
<div class="sourceCode" id="cb2127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2127-1" data-line-number="1">fit23<span class="fl">.9</span> &lt;-</a>
<a class="sourceLine" id="cb2127-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2127-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2127-4" data-line-number="4">      Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>X_s,</a>
<a class="sourceLine" id="cb2127-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2127-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb2127-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2127-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2127-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.09&quot;</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb2128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2128-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.9</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = identity 
## Formula: Y ~ 1 + X_s 
##    Data: my_data (Number of observations: 200) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]    -1.18      0.12    -1.43    -0.94 1.00     6043     6040
## Intercept[2]    -0.76      0.11    -0.99    -0.54 1.00     7685     6760
## Intercept[3]    -0.29      0.11    -0.50    -0.08 1.00     9232     6766
## Intercept[4]     0.25      0.11     0.04     0.46 1.00     9432     7184
## Intercept[5]     0.73      0.11     0.51     0.96 1.00     8372     7269
## Intercept[6]     1.26      0.13     1.02     1.52 1.00     8655     6940
## X_s              1.16      0.10     0.97     1.35 1.00     7167     5953
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract the posterior draws and compare the <strong>brms</strong> parameterization of <span class="math inline">\(\theta_{[i]}\)</span> with the parameterization in the text in an expanded version of the bottom panel of Figure 23.7.</p>
<div class="sourceCode" id="cb2130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2130-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2130-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.9</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2130-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb2130-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2130-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2130-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>, iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2130-7" data-line-number="7"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">6.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-73-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s the marginal distribution of <code>b_X_s</code>, our effect size for the number of jokes.</p>
<div class="sourceCode" id="cb2131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2131-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2131-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_X_s, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2131-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2131-4" data-line-number="4">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2131-5" data-line-number="5">                     <span class="dt">breaks =</span> <span class="dv">50</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2131-6" data-line-number="6">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2131-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2131-8" data-line-number="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-74-1.png" style="display: block; margin: auto;" /></p>
<p>This differs from Kruschks’s <span class="math inline">\(\beta_1\)</span>, which is in an unstandardized metric based on the parameters in his version of the model. But unlike the effect sizes from previous models, this one is not in a Cohen’s-<span class="math inline">\(d\)</span> metric. Rather, this is a fully-standardized regression coefficient. As to the large subplot at the top of Figure 23.7, we can make something like it by nesting <code>conditional_effects()</code> within <code>plot()</code>.</p>
<div class="sourceCode" id="cb2132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2132-1" data-line-number="1"><span class="kw">conditional_effects</span>(fit23<span class="fl">.9</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2132-2" data-line-number="2"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<pre><code>## Warning: Predictions are treated as continuous variables in &#39;conditional_effects&#39; by default which is likely
## invalid for ordinal families. Please set &#39;categorical&#39; to TRUE.</code></pre>
<p><img src="23_files/figure-gfm/unnamed-chunk-75-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s a more elaborated version of the same plot, this time depicting the model with 100 fitted lines randomly drawn from the posterior.</p>
<div class="sourceCode" id="cb2134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2134-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2134-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2134-3" data-line-number="3"><span class="kw">conditional_effects</span>(fit23<span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb2134-4" data-line-number="4">                    <span class="dt">spaghetti =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb2134-5" data-line-number="5">                    <span class="dt">nsamples =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2134-6" data-line-number="6"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">points =</span> T,</a>
<a class="sourceLine" id="cb2134-7" data-line-number="7">       <span class="dt">point_args =</span> <span class="kw">c</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb2134-8" data-line-number="8">       <span class="dt">line_args =</span> <span class="kw">c</span>(<span class="dt">size =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb2134-9" data-line-number="9">       <span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-76-1.png" style="display: block; margin: auto;" /></p>
<p>Note the warning message. There was a similar one in the first plot, which I suppressed for simplicity sake. The message suggests treating the fitted lines as “continuous variables” might lead to a deceptive plot. Here’s what happens if we follow the suggestion.</p>
<div class="sourceCode" id="cb2135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2135-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2135-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2135-3" data-line-number="3"><span class="kw">conditional_effects</span>(fit23<span class="fl">.9</span>, <span class="dt">categorical =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2135-4" data-line-number="4"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-77-1.png" style="display: block; margin: auto;" /></p>
<p>Recall that our thresholds, <span class="math inline">\(\theta_1,...,\theta_{K-1}\)</span>, in conjunction with the standard normal density, give us the probability of a given <code>Y</code> value, given <code>X_s</code> (i.e., <span class="math inline">\(p(y = k | \mu, \sigma, \{ \theta_j \})\)</span>, where <span class="math inline">\(\mu\)</span> is conditional on <span class="math inline">\(x\)</span>). This plot returned the fitted lines of those conditional probabilities, each depicted by the posterior mean and percentile-based 95% intervals. At lower values of <code>X_s</code>, lower values of <code>Y</code> are more probable. At higher values of <code>X_s</code>, higher values of <code>Y</code> are more probable.</p>
<p>It might be useful to get more practice in with this model. Here we’ll use <code>fitted()</code> to make a similar plot, depicting the model with may fitted lines instead of summary statistics.</p>
<div class="sourceCode" id="cb2136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2136-1" data-line-number="1"><span class="co"># how many fitted lines do you want?</span></a>
<a class="sourceLine" id="cb2136-2" data-line-number="2">n_iter &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb2136-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2136-4" data-line-number="4"><span class="co"># define the `X_s` values you want to condition on</span></a>
<a class="sourceLine" id="cb2136-5" data-line-number="5"><span class="co"># because the lines are nonlinear, you&#39;ll need many of them</span></a>
<a class="sourceLine" id="cb2136-6" data-line-number="6">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">X_s =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-2</span>, <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">by =</span> <span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb2136-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2136-8" data-line-number="8">f &lt;-</a>
<a class="sourceLine" id="cb2136-9" data-line-number="9"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb2136-10" data-line-number="10">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb2136-11" data-line-number="11">         <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb2136-12" data-line-number="12">         <span class="dt">nsamples =</span> n_iter)</a>
<a class="sourceLine" id="cb2136-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2136-14" data-line-number="14"><span class="co"># inspect the output</span></a>
<a class="sourceLine" id="cb2136-15" data-line-number="15">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2136-16" data-line-number="16"><span class="st">  </span><span class="kw">str</span>()</a></code></pre></div>
<pre><code>##  num [1:50, 1:81, 1:7] 0.876 0.811 0.92 0.934 0.837 ...
##  - attr(*, &quot;dimnames&quot;)=List of 3
##   ..$ : NULL
##   ..$ : NULL
##   ..$ : chr [1:7] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</code></pre>
<p>Our output came in three dimensions. We have 50 rows, corresponding to <code>n_iter &lt;- 50</code> (i.e., 50 posterior draws). There are 81 columns, based on how we defined the <code>X_s</code> values within our <code>nd</code> data (i.e., <code>seq(from = -2, to = 2, by = 0.05)</code>). The third dimension has seven levels, one corresponding to each of the seven levels of our criterion variable <code>Y</code>. Here’s a way to rearrange that output into a useful format for plotting.</p>
<div class="sourceCode" id="cb2138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2138-1" data-line-number="1"><span class="co"># rearrange the output</span></a>
<a class="sourceLine" id="cb2138-2" data-line-number="2"><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb2138-3" data-line-number="3">  f[, , <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2138-4" data-line-number="4">  f[, , <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2138-5" data-line-number="5">  f[, , <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2138-6" data-line-number="6">  f[, , <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2138-7" data-line-number="7">  f[, , <span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2138-8" data-line-number="8">  f[, , <span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2138-9" data-line-number="9">  f[, , <span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2138-10" data-line-number="10">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-11" data-line-number="11"><span class="st">  </span><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb2138-12" data-line-number="12"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-13" data-line-number="13"><span class="st">  </span><span class="kw">set_names</span>(nd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(X_s)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter   =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>n_iter, <span class="dt">times =</span> <span class="dv">7</span>),</a>
<a class="sourceLine" id="cb2138-15" data-line-number="15">         <span class="dt">rating =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">each =</span> n_iter)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-16" data-line-number="16"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span><span class="kw">c</span>(iter, rating),</a>
<a class="sourceLine" id="cb2138-17" data-line-number="17">               <span class="dt">names_to =</span> <span class="st">&quot;X_s&quot;</span>,</a>
<a class="sourceLine" id="cb2138-18" data-line-number="18">               <span class="dt">names_ptypes =</span> <span class="kw">list</span>(<span class="dt">X_s =</span> <span class="kw">double</span>()),</a>
<a class="sourceLine" id="cb2138-19" data-line-number="19">               <span class="dt">values_to =</span> <span class="st">&quot;probability&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-20" data-line-number="20"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rating =</span> <span class="kw">str_c</span>(<span class="st">&quot;Y: &quot;</span>, rating)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-21" data-line-number="21"><span class="st">  </span></a>
<a class="sourceLine" id="cb2138-22" data-line-number="22"><span class="st">  </span><span class="co"># plot</span></a>
<a class="sourceLine" id="cb2138-23" data-line-number="23"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X_s, <span class="dt">y =</span> probability, </a>
<a class="sourceLine" id="cb2138-24" data-line-number="24">             <span class="dt">group =</span> <span class="kw">interaction</span>(iter, rating),</a>
<a class="sourceLine" id="cb2138-25" data-line-number="25">             <span class="dt">color =</span> rating)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2138-26" data-line-number="26"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb2138-27" data-line-number="27"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="dt">end =</span> <span class="fl">.85</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2138-28" data-line-number="28"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>),</a>
<a class="sourceLine" id="cb2138-29" data-line-number="29">                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2138-30" data-line-number="30"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>,</a>
<a class="sourceLine" id="cb2138-31" data-line-number="31">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2138-32" data-line-number="32"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>rating, <span class="dt">ncol =</span> <span class="dv">7</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-79-1.png" style="display: block; margin: auto;" /></p>
<p>So far, we’ve been plotting our model with the context of the default <code>scale = &quot;response&quot;</code> setting within <code>fitted()</code>. Within the context of the response variable <code>Y</code>, our model returns response probabilities. We can also look at the output within the context of <code>scale = &quot;linear&quot;</code>. We’ll plot these fitted lines across our <code>nd</code> values two different ways. For the first, <code>p1</code>, we’ll use summary statistics. For the second, <code>p2</code>, we’ll set <code>summary = T</code>.</p>
<div class="sourceCode" id="cb2139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2139-1" data-line-number="1"><span class="co"># adjust the nd</span></a>
<a class="sourceLine" id="cb2139-2" data-line-number="2">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">X_s =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">-2.5</span>, <span class="dt">to =</span> <span class="fl">2.5</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb2139-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2139-4" data-line-number="4"><span class="co"># use summary statistics</span></a>
<a class="sourceLine" id="cb2139-5" data-line-number="5">p1 &lt;-</a>
<a class="sourceLine" id="cb2139-6" data-line-number="6"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.9</span>, </a>
<a class="sourceLine" id="cb2139-7" data-line-number="7">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>,</a>
<a class="sourceLine" id="cb2139-8" data-line-number="8">         <span class="dt">newdata =</span> nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-9" data-line-number="9"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-10" data-line-number="10"><span class="st">  </span><span class="kw">bind_cols</span>(nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-11" data-line-number="11"><span class="st">  </span></a>
<a class="sourceLine" id="cb2139-12" data-line-number="12"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X_s, <span class="dt">y =</span> Estimate, <span class="dt">ymin =</span> Q2<span class="fl">.5</span>, <span class="dt">ymax =</span> Q97<span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2139-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>,</a>
<a class="sourceLine" id="cb2139-14" data-line-number="14">              <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2139-15" data-line-number="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;summary statistics&quot;</span>,</a>
<a class="sourceLine" id="cb2139-16" data-line-number="16">       <span class="dt">y =</span> <span class="st">&quot;underlying standard normal&quot;</span>)</a>
<a class="sourceLine" id="cb2139-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2139-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2139-19" data-line-number="19"><span class="co"># set `summary = F`</span></a>
<a class="sourceLine" id="cb2139-20" data-line-number="20"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2139-21" data-line-number="21">p2 &lt;-</a>
<a class="sourceLine" id="cb2139-22" data-line-number="22"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.9</span>, </a>
<a class="sourceLine" id="cb2139-23" data-line-number="23">         <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>,</a>
<a class="sourceLine" id="cb2139-24" data-line-number="24">         <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb2139-25" data-line-number="25">         <span class="dt">summary =</span> F,</a>
<a class="sourceLine" id="cb2139-26" data-line-number="26">         <span class="dt">nsamples =</span> n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-27" data-line-number="27"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-28" data-line-number="28"><span class="st">  </span><span class="kw">set_names</span>(nd <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(X_s)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-29" data-line-number="29"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span>n_iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-30" data-line-number="30"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="op">-</span>iter,</a>
<a class="sourceLine" id="cb2139-31" data-line-number="31">               <span class="dt">names_to =</span> <span class="st">&quot;X_s&quot;</span>,</a>
<a class="sourceLine" id="cb2139-32" data-line-number="32">               <span class="dt">names_ptypes =</span> <span class="kw">list</span>(<span class="dt">X_s =</span> <span class="kw">double</span>())) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2139-33" data-line-number="33"><span class="st">  </span></a>
<a class="sourceLine" id="cb2139-34" data-line-number="34"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X_s, <span class="dt">y =</span> value, <span class="dt">group =</span> iter)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2139-35" data-line-number="35"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2139-36" data-line-number="36"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2139-37" data-line-number="37"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;50 posterior draws&quot;</span>)</a>
<a class="sourceLine" id="cb2139-38" data-line-number="38"></a>
<a class="sourceLine" id="cb2139-39" data-line-number="39"><span class="co"># combine and plot!</span></a>
<a class="sourceLine" id="cb2139-40" data-line-number="40">p1 <span class="op">+</span><span class="st"> </span>p2 <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb2139-41" data-line-number="41"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb2139-42" data-line-number="42"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-80-1.png" style="display: block; margin: auto;" /></p>
<p>Both methods returned the fitted lines in the metric of the underlying standard normal distribution. The fitted lines are nonlinear in the metric of the raw data <code>Y</code>, but they’re linear in the metric of the presumed underlying distribution. If it helps, we’ll make a marginal plot of the standard normal distribution and tack it onto the right.</p>
<div class="sourceCode" id="cb2140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2140-1" data-line-number="1"><span class="co"># make Phi</span></a>
<a class="sourceLine" id="cb2140-2" data-line-number="2">p3 &lt;-</a>
<a class="sourceLine" id="cb2140-3" data-line-number="3"><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">.01</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2140-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">d =</span> <span class="kw">dnorm</span>(x)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2140-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2140-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">ymin =</span> <span class="dv">0</span>, <span class="dt">ymax =</span> d)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2140-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2140-8" data-line-number="8"><span class="st">  </span><span class="co"># add the thresholds!</span></a>
<a class="sourceLine" id="cb2140-9" data-line-number="9"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">posterior_summary</span>(fit23<span class="fl">.9</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span>], </a>
<a class="sourceLine" id="cb2140-10" data-line-number="10">             <span class="dt">color =</span> <span class="st">&quot;grey92&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2140-11" data-line-number="11"><span class="st">  </span><span class="co"># mark the thresholds with the axis breaks</span></a>
<a class="sourceLine" id="cb2140-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_reverse</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="kw">fixef</span>(fit23<span class="fl">.9</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2140-13" data-line-number="13">                  <span class="dt">labels =</span> <span class="kw">parse</span>(<span class="dt">text =</span> <span class="kw">str_c</span>(<span class="st">&quot;theta[&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="st">&quot;]&quot;</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2140-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2140-15" data-line-number="15"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="kw">expression</span>(<span class="kw">italic</span>(N)(<span class="dv">0</span>,<span class="dv">1</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb2140-16" data-line-number="16"><span class="st">  </span><span class="kw">coord_flip</span>(<span class="dt">xlim =</span> <span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2140-17" data-line-number="17"></a>
<a class="sourceLine" id="cb2140-18" data-line-number="18"><span class="co"># combine, format a bit, and plot</span></a>
<a class="sourceLine" id="cb2140-19" data-line-number="19">(</a>
<a class="sourceLine" id="cb2140-20" data-line-number="20">  ((p1 <span class="op">|</span><span class="st"> </span>p2 ) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2140-21" data-line-number="21"><span class="st">     </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">posterior_summary</span>(fit23<span class="fl">.9</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dv">1</span>], </a>
<a class="sourceLine" id="cb2140-22" data-line-number="22">                <span class="dt">color =</span> <span class="st">&quot;grey75&quot;</span>, <span class="dt">linetype =</span> <span class="dv">3</span>) <span class="op">&amp;</span></a>
<a class="sourceLine" id="cb2140-23" data-line-number="23"><span class="st">     </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="dv">-2</span><span class="op">:</span><span class="dv">2</span>) <span class="op">|</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2140-24" data-line-number="24"><span class="st">     </span>p3) <span class="op">&amp;</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2140-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a>
<a class="sourceLine" id="cb2140-26" data-line-number="26">) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2140-27" data-line-number="27"><span class="st">  </span><span class="kw">plot_layout</span>(<span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">1</span>))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-81-1.png" style="display: block; margin: auto;" /></p>
<p>The lines intersecting the plots are the posterior means for thresholds, <span class="math inline">\(\theta_1,...,\theta_6\)</span>.</p>
<p><em>But these still aren’t faithful depictions of the top panel of Figure 23.7</em>, you say. Okay, fine. One of the distinctive elements of that panel is the left-tilted bar-and-error plots. If you look closely at the vertical lines at their bases, you’ll see that the leftmost subplot starts at the minimum value of <code>X</code> and the rightmost subplot starts at the maximum value of <code>X</code>. Since our plots, so far, have been based on <code>X_s</code>, we’ll use the minimum and maximum values from that. Here are those values.</p>
<div class="sourceCode" id="cb2141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2141-1" data-line-number="1">(r &lt;-<span class="st"> </span><span class="kw">range</span>(my_data<span class="op">$</span>X_s))</a></code></pre></div>
<pre><code>## [1] -1.774444  1.750168</code></pre>
<p>To my eye, it appears that the three middle subplots are equally distributed between those at the ends. If we proceed under that assumption, here’s how we might use <code>fitted()</code> to get us rolling on computing the relevant values.</p>
<div class="sourceCode" id="cb2143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2143-1" data-line-number="1">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">X_s =</span> <span class="kw">seq</span>(<span class="dt">from =</span> r[<span class="dv">1</span>], <span class="dt">to =</span> r[<span class="dv">2</span>], <span class="dt">length.out =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb2143-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2143-3" data-line-number="3">f &lt;-</a>
<a class="sourceLine" id="cb2143-4" data-line-number="4"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb2143-5" data-line-number="5">         <span class="dt">newdata =</span> nd)</a>
<a class="sourceLine" id="cb2143-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2143-7" data-line-number="7"><span class="co"># inspect the output</span></a>
<a class="sourceLine" id="cb2143-8" data-line-number="8">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2143-9" data-line-number="9"><span class="st">  </span><span class="kw">str</span>()</a></code></pre></div>
<pre><code>##  num [1:5, 1:4, 1:7] 0.806616 0.443631 0.123985 0.015642 0.000916 ...
##  - attr(*, &quot;dimnames&quot;)=List of 3
##   ..$ : NULL
##   ..$ : chr [1:4] &quot;Estimate&quot; &quot;Est.Error&quot; &quot;Q2.5&quot; &quot;Q97.5&quot;
##   ..$ : chr [1:7] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</code></pre>
<p>Here we’ll rearrange the output to make it useful for plotting.</p>
<div class="sourceCode" id="cb2145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2145-1" data-line-number="1"><span class="co"># rearrange the output</span></a>
<a class="sourceLine" id="cb2145-2" data-line-number="2">f &lt;-</a>
<a class="sourceLine" id="cb2145-3" data-line-number="3"><span class="st">  </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb2145-4" data-line-number="4">    f[, , <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2145-5" data-line-number="5">    f[, , <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2145-6" data-line-number="6">    f[, , <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2145-7" data-line-number="7">    f[, , <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2145-8" data-line-number="8">    f[, , <span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2145-9" data-line-number="9">    f[, , <span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2145-10" data-line-number="10">    f[, , <span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2145-11" data-line-number="11">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2145-12" data-line-number="12"><span class="st">  </span><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb2145-13" data-line-number="13"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2145-14" data-line-number="14"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">expand</span>(nd, <span class="dt">Y =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, X_s))</a>
<a class="sourceLine" id="cb2145-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2145-16" data-line-number="16"><span class="kw">head</span>(f)</a></code></pre></div>
<pre><code>##       Estimate  Est.Error        Q2.5       Q97.5 Y         X_s
## 1 0.8066157820 0.04697296 0.704029954 0.889376843 1 -1.77444380
## 2 0.4436310447 0.04824394 0.349536653 0.537086920 1 -0.89329094
## 3 0.1239853476 0.02498454 0.079149727 0.176145937 1 -0.01213809
## 4 0.0156422414 0.00680478 0.005636675 0.031792247 1  0.86901477
## 5 0.0009155005 0.00082364 0.000108639 0.003022951 1  1.75016762
## 6 0.0924873574 0.02486244 0.051015307 0.147259251 2 -1.77444380</code></pre>
<p>Now we can make those bar-and-error plots.</p>
<div class="sourceCode" id="cb2147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2147-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2147-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">X_s =</span> <span class="kw">round</span>(X_s, <span class="dt">digits =</span> <span class="dv">3</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2147-3" data-line-number="3"><span class="st">    </span></a>
<a class="sourceLine" id="cb2147-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Y, <span class="dt">y =</span> Estimate,</a>
<a class="sourceLine" id="cb2147-5" data-line-number="5">             <span class="dt">ymin =</span> Q2<span class="fl">.5</span>, <span class="dt">ymax =</span> Q97<span class="fl">.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-6" data-line-number="6"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_pointrange</span>(<span class="dt">fatten =</span> <span class="fl">1.5</span>, <span class="dt">size =</span> <span class="dv">1</span>)  <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-8" data-line-number="8"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_y_reverse</span>(<span class="ot">NULL</span>, <span class="dt">position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb2147-10" data-line-number="10">                  <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.5</span>, <span class="dv">0</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;0&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-11" data-line-number="11"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2147-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>X_s, <span class="dt">ncol =</span> <span class="dv">7</span>, <span class="dt">strip.position =</span> <span class="st">&quot;bottom&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-85-1.png" style="display: block; margin: auto;" /></p>
<p>The <code>X_s</code> values are depicted in the panel strips on the bottom. The response probabilities are scaled based on the axis on the top. The points and leftmost sides of the bars are the posterior means. The thin, dark horizontal lines are the percentile-based 95% intervals. Here we reformat <code>f</code> a little more to put those bar-and-error plots in a format more similar to that of Figure 23.7.</p>
<div class="sourceCode" id="cb2148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2148-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2148-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Est.Error) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2148-3" data-line-number="3"><span class="st">  </span><span class="co"># rescale the probability summaries</span></a>
<a class="sourceLine" id="cb2148-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(Estimate<span class="op">:</span>Q97<span class="fl">.5</span>), <span class="op">~</span>. <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2148-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2148-6" data-line-number="6"><span class="st">  </span><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb2148-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> r[<span class="dv">1</span>], <span class="dt">to =</span> r[<span class="dv">2</span>], <span class="dt">length.out =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb2148-9" data-line-number="9">             <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-10" data-line-number="10"><span class="st">  </span><span class="co"># bar marking the Estimate</span></a>
<a class="sourceLine" id="cb2148-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X_s, <span class="dt">xend =</span> X_s <span class="op">-</span><span class="st"> </span>Estimate, </a>
<a class="sourceLine" id="cb2148-12" data-line-number="12">                   <span class="dt">y =</span> Y <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>, <span class="dt">yend =</span> Y <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb2148-13" data-line-number="13">               <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-14" data-line-number="14"><span class="st">  </span><span class="co"># bar marking the 95% interval</span></a>
<a class="sourceLine" id="cb2148-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> X_s <span class="op">-</span><span class="st"> </span>Q2<span class="fl">.5</span>, <span class="dt">xend =</span> X_s <span class="op">-</span><span class="st"> </span>Q97<span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb2148-16" data-line-number="16">                   <span class="dt">y =</span> Y <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>, <span class="dt">yend =</span> Y <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb2148-17" data-line-number="17">               <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-18" data-line-number="18"><span class="st">  </span><span class="co"># data</span></a>
<a class="sourceLine" id="cb2148-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2148-20" data-line-number="20">             <span class="kw">aes</span>(<span class="dt">x =</span> X_s, <span class="dt">y =</span> Y),</a>
<a class="sourceLine" id="cb2148-21" data-line-number="21">             <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Y&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">7.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-23" data-line-number="23"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.4</span>, <span class="fl">2.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2148-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) </a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-86-1.png" style="display: block; margin: auto;" /></p>
<p>I’m not going to attempt superimposing fitted lines on this plot the way Kruschke did. Given that our ordered-probit model is nonlinear on the scale of the criterion, it seems misleading to present linear fitted lines atop the raw data. If you’d like to do so, you’re on your own.</p>
<p>Now here’s the corresponding model is we treat the <code>y</code> data as metric with tricks from Chapter 17.</p>
<div class="sourceCode" id="cb2149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2149-1" data-line-number="1">sd_x &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb2149-2" data-line-number="2">sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2149-3" data-line-number="3">m_x  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>X)</a>
<a class="sourceLine" id="cb2149-4" data-line-number="4">m_y  &lt;-<span class="st"> </span><span class="kw">mean</span>(my_data<span class="op">$</span>Y)</a>
<a class="sourceLine" id="cb2149-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2149-6" data-line-number="6">beta_<span class="dv">0</span>_sigma &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(m_x <span class="op">*</span><span class="st"> </span>sd_y <span class="op">/</span><span class="st"> </span>sd_x)</a>
<a class="sourceLine" id="cb2149-7" data-line-number="7">beta_<span class="dv">1</span>_sigma &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">*</span><span class="st"> </span><span class="kw">abs</span>(sd_y <span class="op">/</span><span class="st"> </span>sd_x) </a>
<a class="sourceLine" id="cb2149-8" data-line-number="8"></a>
<a class="sourceLine" id="cb2149-9" data-line-number="9">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2149-10" data-line-number="10"><span class="st">  </span><span class="kw">stanvar</span>(beta_<span class="dv">0</span>_sigma, <span class="dt">name =</span> <span class="st">&quot;beta_0_sigma&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2149-11" data-line-number="11"><span class="st">  </span><span class="kw">stanvar</span>(beta_<span class="dv">1</span>_sigma, <span class="dt">name =</span> <span class="st">&quot;beta_1_sigma&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2149-12" data-line-number="12"><span class="st">  </span><span class="kw">stanvar</span>(sd_y, <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a>
<a class="sourceLine" id="cb2149-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2149-14" data-line-number="14">fit23<span class="fl">.10</span> &lt;-</a>
<a class="sourceLine" id="cb2149-15" data-line-number="15"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2149-16" data-line-number="16">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb2149-17" data-line-number="17">      Y <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>X,</a>
<a class="sourceLine" id="cb2149-18" data-line-number="18">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, beta_<span class="dv">0</span>_sigma), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2149-19" data-line-number="19">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, beta_<span class="dv">1</span>_sigma), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2149-20" data-line-number="20">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb2149-21" data-line-number="21">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2149-22" data-line-number="22">      <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb2149-23" data-line-number="23">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2149-24" data-line-number="24">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.10&quot;</span>)</a></code></pre></div>
<p>It may not have been readily apparent from Kruschke’s prose in the note for Figure 23.7, but his OLS model was based on the fully unstandardized data (i.e., using <code>X</code> as the predictor), not the partially standardized data he used in his JAGS code from 23.4.1. We followed the same sensibilities for <code>fit23.10</code>. Speaking of which, here are the summaries for the marginal posteriors.</p>
<div class="sourceCode" id="cb2150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2150-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit23<span class="fl">.10</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>##             Estimate Est.Error   Q2.5  Q97.5
## b_Intercept   -5.430     0.610 -6.614 -4.239
## b_X            6.711     0.427  5.876  7.537
## sigma          1.528     0.075  1.392  1.680</code></pre>
<p>These values are very close to those he reported at the bottom of page 690. Here are what the fitted lines from that model look like when superimposed on the data, when presuming both variables are metric.</p>
<div class="sourceCode" id="cb2152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2152-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2152-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2152-3" data-line-number="3"><span class="kw">conditional_effects</span>(fit23<span class="fl">.10</span>,</a>
<a class="sourceLine" id="cb2152-4" data-line-number="4">                    <span class="dt">spaghetti =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb2152-5" data-line-number="5">                    <span class="dt">nsamples =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2152-6" data-line-number="6"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">points =</span> T,</a>
<a class="sourceLine" id="cb2152-7" data-line-number="7">       <span class="dt">point_args =</span> <span class="kw">c</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb2152-8" data-line-number="8">       <span class="dt">line_args =</span> <span class="kw">c</span>(<span class="dt">size =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb2152-9" data-line-number="9">       <span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-88-1.png" style="display: block; margin: auto;" /></p>
<p>For the next example, we’ll load the <code>HappinessAssetsDebt.csv</code> data from Shi (<a href="https://www.icpsr.umich.edu/icpsrweb/DSDR/studies/21741">2009</a>).</p>
<div class="sourceCode" id="cb2153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2153-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/HappinessAssetsDebt.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2153-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2153-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 6,759
## Variables: 3
## $ Happiness &lt;dbl&gt; 3, 3, 3, 3, 1, 3, 2, 2, 4, 2, 3, 5, 3, 3, 4, 3, 3, 2, 4, 3, 4, 3, 3, 3, 5, 4, 3, 4, 4, 4,…
## $ Assets    &lt;dbl&gt; 0, 10000, 30000, 40000, 21000, 20000, 20000, 0, 0, 20000, 5000, 30000, 40000, 5500, 50000…
## $ Debt      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32000, 0, 0, 0…</code></pre>
<p>Here’s a quick scatter plot of the data. To help with the overplotting, the points have been horizontally jittered a bit. But as indicated in the text, <code>Happiness</code> is a discrete variable.</p>
<div class="sourceCode" id="cb2155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2155-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2155-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Assets, <span class="dt">y =</span> Happiness)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2155-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">4</span>, <span class="dt">height =</span> <span class="fl">.25</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2155-4" data-line-number="4"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-90-1.png" style="display: block; margin: auto;" /></p>
<p>Standardize our predictor.</p>
<div class="sourceCode" id="cb2156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2156-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb2156-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2156-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Assets_s =</span> (Assets <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Assets)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(Assets))</a></code></pre></div>
<p>Fit the model like before.</p>
<div class="sourceCode" id="cb2157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2157-1" data-line-number="1">fit23<span class="fl">.11</span> &lt;-</a>
<a class="sourceLine" id="cb2157-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2157-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2157-4" data-line-number="4">      Happiness <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Assets_s,</a>
<a class="sourceLine" id="cb2157-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2157-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb2157-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2157-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2157-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.11&quot;</span>)</a></code></pre></div>
<p>Check the summary.</p>
<div class="sourceCode" id="cb2158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2158-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.11</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = identity 
## Formula: Happiness ~ 1 + Assets_s 
##    Data: my_data (Number of observations: 6759) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]    -2.03      0.03    -2.10    -1.97 1.00     5453     5058
## Intercept[2]    -1.17      0.02    -1.20    -1.13 1.00     8415     6880
## Intercept[3]    -0.15      0.02    -0.18    -0.12 1.00     8055     6609
## Intercept[4]     1.48      0.02     1.44     1.53 1.00     8767     6806
## Assets_s         0.15      0.01     0.12     0.17 1.00     8513     5692
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract the posterior draws and compare the <strong>brms</strong> parameterization of <span class="math inline">\(\theta_{[i]}\)</span> with the parameterization in the text in an expanded version of the bottom panel of Figure 23.8.</p>
<div class="sourceCode" id="cb2160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2160-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2160-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.11</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2160-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb2160-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2160-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2160-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[4]</span><span class="st">`</span>, iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2160-7" data-line-number="7"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">4.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-93-1.png" style="display: block; margin: auto;" /></p>
<p>Behold the marginal distribution of <code>b_Assets_s</code>, our effect size for <code>Assets</code>.</p>
<div class="sourceCode" id="cb2161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2161-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2161-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> b_Assets_s, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2161-3" data-line-number="3"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2161-4" data-line-number="4">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2161-5" data-line-number="5">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb2161-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2161-7" data-line-number="7"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-94-1.png" style="display: block; margin: auto;" /></p>
<p>Here’s the <code>fitted()</code>-oriented preparatory work for our version of the top panel of Figure 23.8.</p>
<div class="sourceCode" id="cb2162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2162-1" data-line-number="1"><span class="co"># define the range for the predictor</span></a>
<a class="sourceLine" id="cb2162-2" data-line-number="2">r &lt;-<span class="st"> </span><span class="kw">range</span>(my_data<span class="op">$</span>Assets_s)</a>
<a class="sourceLine" id="cb2162-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2162-4" data-line-number="4"><span class="co"># re-define the new data</span></a>
<a class="sourceLine" id="cb2162-5" data-line-number="5">nd &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Assets_s =</span> <span class="kw">seq</span>(<span class="dt">from =</span> r[<span class="dv">1</span>], <span class="dt">to =</span> r[<span class="dv">2</span>], <span class="dt">length.out =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb2162-6" data-line-number="6"></a>
<a class="sourceLine" id="cb2162-7" data-line-number="7"><span class="co"># compute the fitted summaries</span></a>
<a class="sourceLine" id="cb2162-8" data-line-number="8">f &lt;-</a>
<a class="sourceLine" id="cb2162-9" data-line-number="9"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.11</span>,</a>
<a class="sourceLine" id="cb2162-10" data-line-number="10">         <span class="dt">newdata =</span> nd)</a>
<a class="sourceLine" id="cb2162-11" data-line-number="11"></a>
<a class="sourceLine" id="cb2162-12" data-line-number="12"><span class="co"># rearrange the output</span></a>
<a class="sourceLine" id="cb2162-13" data-line-number="13">f &lt;-</a>
<a class="sourceLine" id="cb2162-14" data-line-number="14"><span class="st">  </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb2162-15" data-line-number="15">    f[, , <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2162-16" data-line-number="16">    f[, , <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2162-17" data-line-number="17">    f[, , <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2162-18" data-line-number="18">    f[, , <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2162-19" data-line-number="19">    f[, , <span class="dv">5</span>]</a>
<a class="sourceLine" id="cb2162-20" data-line-number="20">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2162-21" data-line-number="21"><span class="st">  </span><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb2162-22" data-line-number="22"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2162-23" data-line-number="23"><span class="st">  </span><span class="kw">bind_cols</span>(<span class="kw">expand</span>(nd, <span class="dt">Happiness =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, Assets_s))</a>
<a class="sourceLine" id="cb2162-24" data-line-number="24"></a>
<a class="sourceLine" id="cb2162-25" data-line-number="25"><span class="co"># examine</span></a>
<a class="sourceLine" id="cb2162-26" data-line-number="26"><span class="kw">head</span>(f)</a></code></pre></div>
<pre><code>##       Estimate    Est.Error         Q2.5        Q97.5 Happiness   Assets_s
## 1 2.610257e-02 2.076201e-03 2.214070e-02 3.031010e-02         1 -0.5971712
## 2 3.150643e-03 7.127502e-04 1.975596e-03 4.707940e-03         1  4.7565107
## 3 2.318569e-04 1.305224e-04 7.004674e-05 5.510350e-04         1 10.1101925
## 4 1.127918e-05 1.309096e-05 1.090534e-06 4.334866e-05         1 15.4638743
## 5 4.055501e-07 9.716135e-07 7.173225e-09 2.291520e-06         1 20.8175561
## 6 1.147295e-01 4.137412e-03 1.065602e-01 1.229534e-01         2 -0.5971712</code></pre>
<p>Like with the same variant from Figure 23.7, we will not be superimposing linear fitted lines. The model is nonlinear on the scale of the data and I don’t want to confuse readers by pretending otherwise.</p>
<div class="sourceCode" id="cb2164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2164-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2164-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Est.Error) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2164-3" data-line-number="3"><span class="st">  </span><span class="co"># rescale the probability summaries</span></a>
<a class="sourceLine" id="cb2164-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(Estimate<span class="op">:</span>Q97<span class="fl">.5</span>), <span class="op">~</span>. <span class="op">*</span><span class="st"> </span><span class="fl">2.5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2164-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2164-6" data-line-number="6"><span class="st">  </span><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb2164-7" data-line-number="7"><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-8" data-line-number="8"><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="kw">seq</span>(<span class="dt">from =</span> r[<span class="dv">1</span>], <span class="dt">to =</span> r[<span class="dv">2</span>], <span class="dt">length.out =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb2164-9" data-line-number="9">             <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-10" data-line-number="10"><span class="st">  </span><span class="co"># bar marking the Estimate</span></a>
<a class="sourceLine" id="cb2164-11" data-line-number="11"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Assets_s, <span class="dt">xend =</span> Assets_s <span class="op">-</span><span class="st"> </span>Estimate, </a>
<a class="sourceLine" id="cb2164-12" data-line-number="12">                   <span class="dt">y =</span> Happiness <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>, <span class="dt">yend =</span> Happiness <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>),</a>
<a class="sourceLine" id="cb2164-13" data-line-number="13">               <span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">color =</span> <span class="st">&quot;grey67&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-14" data-line-number="14"><span class="st">  </span><span class="co"># bar marking the 95% interval</span></a>
<a class="sourceLine" id="cb2164-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Assets_s <span class="op">-</span><span class="st"> </span>Q2<span class="fl">.5</span>, <span class="dt">xend =</span> Assets_s <span class="op">-</span><span class="st"> </span>Q97<span class="fl">.5</span>,</a>
<a class="sourceLine" id="cb2164-16" data-line-number="16">                   <span class="dt">y =</span> Happiness <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>, <span class="dt">yend =</span> Happiness <span class="op">+</span><span class="st"> </span><span class="fl">0.2</span>),</a>
<a class="sourceLine" id="cb2164-17" data-line-number="17">               <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">color =</span> <span class="st">&quot;grey33&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-18" data-line-number="18"><span class="st">  </span><span class="co"># data</span></a>
<a class="sourceLine" id="cb2164-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2164-20" data-line-number="20">             <span class="kw">aes</span>(<span class="dt">x =</span> Assets_s, <span class="dt">y =</span> Happiness),</a>
<a class="sourceLine" id="cb2164-21" data-line-number="21">             <span class="dt">shape =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="st">&quot;Happiness&quot;</span>, <span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">5.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-23" data-line-number="23"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">24</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2164-24" data-line-number="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) </a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-96-1.png" style="display: block; margin: auto;" /></p>
<p>Now here’s the corresponding model is we treat <code>Happiness</code> as metric. Unlike our method for the corresponding model from Figure 23.7, <code>fit10</code>, we will use the standardized version of the predictor, <code>Assets_s</code>. The unstandardized values for <code>Happiness</code> and <code>Assets</code> are on vastly different scales, which can be difficulty for HMC with broad priors of the type Kruschke often uses. Standardizing the predictor helps.</p>
<div class="sourceCode" id="cb2165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2165-1" data-line-number="1">sd_y &lt;-<span class="st"> </span><span class="kw">sd</span>(my_data<span class="op">$</span>Happiness)</a>
<a class="sourceLine" id="cb2165-2" data-line-number="2">stanvars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2165-3" data-line-number="3"><span class="st">  </span><span class="kw">stanvar</span>(sd_y, <span class="dt">name =</span> <span class="st">&quot;sd_y&quot;</span>)</a>
<a class="sourceLine" id="cb2165-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2165-5" data-line-number="5">fit23<span class="fl">.12</span> &lt;-</a>
<a class="sourceLine" id="cb2165-6" data-line-number="6"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2165-7" data-line-number="7">      <span class="dt">family =</span> gaussian,</a>
<a class="sourceLine" id="cb2165-8" data-line-number="8">      Happiness <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Assets_s,</a>
<a class="sourceLine" id="cb2165-9" data-line-number="9">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="fl">3.5</span>, <span class="dv">5</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2165-10" data-line-number="10">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="dt">class =</span> b),</a>
<a class="sourceLine" id="cb2165-11" data-line-number="11">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, sd_y), <span class="dt">class =</span> sigma)),</a>
<a class="sourceLine" id="cb2165-12" data-line-number="12">      <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2165-13" data-line-number="13">      <span class="dt">stanvars =</span> stanvars, </a>
<a class="sourceLine" id="cb2165-14" data-line-number="14">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2165-15" data-line-number="15">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.12&quot;</span>)</a></code></pre></div>
<p>Here are the summaries for the marginal posteriors.</p>
<div class="sourceCode" id="cb2166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2166-1" data-line-number="1"><span class="kw">posterior_summary</span>(fit23<span class="fl">.12</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, ] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">6</span>)</a></code></pre></div>
<pre><code>##             Estimate Est.Error     Q2.5    Q97.5
## b_Intercept 3.484232  0.010015 3.465201 3.503668
## b_Assets_s  0.115662  0.010342 0.095176 0.135035
## sigma       0.847072  0.007229 0.832731 0.861195</code></pre>
<p>They’re just a bit different from those produced by OLS. Here are what the fitted lines from that model look like when superimposed on the data, when presuming both variables are metric.</p>
<div class="sourceCode" id="cb2168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2168-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">23</span>)</a>
<a class="sourceLine" id="cb2168-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2168-3" data-line-number="3"><span class="kw">conditional_effects</span>(fit23<span class="fl">.12</span>,</a>
<a class="sourceLine" id="cb2168-4" data-line-number="4">                    <span class="dt">spaghetti =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb2168-5" data-line-number="5">                    <span class="dt">nsamples =</span> <span class="dv">100</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2168-6" data-line-number="6"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">points =</span> T,</a>
<a class="sourceLine" id="cb2168-7" data-line-number="7">       <span class="dt">point_args =</span> <span class="kw">c</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">3</span>),</a>
<a class="sourceLine" id="cb2168-8" data-line-number="8">       <span class="dt">line_args =</span> <span class="kw">c</span>(<span class="dt">size =</span> <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb2168-9" data-line-number="9">       <span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-98-1.png" style="display: block; margin: auto;" /></p>
</div>
<div id="example-moviesthey-dont-make-em-like-they-used-to." class="section level3">
<h3><span class="header-section-number">23.4.3</span> Example: Movies–They don’t make ’em like they used to.</h3>
<p>For this section, we’ll load the <a href="https://amstat.tandfonline.com/doi/pdf/10.1080/10691898.2006.11910579?needAccess=true">Moore (2006)</a> <code>Movies.csv</code> data.</p>
<div class="sourceCode" id="cb2169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2169-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/Movies.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2169-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2169-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 100
## Variables: 6
## $ Title       &lt;chr&gt; &quot;A_Ticklish_Affair&quot;, &quot;Action_in_the_North_Atlantic&quot;, &quot;And_the_Ship_Sails_On&quot;, &quot;Autumn_S…
## $ Year        &lt;dbl&gt; 1963, 1943, 1984, 1978, 1931, 1930, 1950, 1989, 1940, 1947, 1970, 1940, 1976, 1985, 194…
## $ Length      &lt;dbl&gt; 89, 127, 138, 97, 77, 69, 93, 119, 70, 69, 101, 62, 97, 85, 62, 86, 112, 97, 93, 89, 90…
## $ Cast        &lt;dbl&gt; 5, 7, 7, 5, 6, 8, 5, 8, 9, 9, 9, 6, 10, 10, 9, 6, 10, 6, 12, 7, 5, 9, 6, 7, 6, 6, 12, 1…
## $ Rating      &lt;dbl&gt; 2.0, 3.0, 3.0, 3.0, 2.5, 2.5, 3.0, 2.5, 2.5, 2.0, 3.0, 2.0, 2.5, 1.0, 1.5, 2.5, 3.0, 2.…
## $ Description &lt;dbl&gt; 7, 9, 15, 11, 7, 10, 8, 15, 8, 8, 11, 10, 12, 13, 9, 7, 10, 11, 11, 8, 9, 9, 13, 9, 7, …</code></pre>
<p>In footnote #5 at the bottom of page 693, Kruschke explained that whereas the original <code>Ratings</code> data ranged from <code>1.0</code> to <code>4.0</code> in half-unit increments, he recoded them to range from <code>1</code> to <code>7</code>. Here we recode <code>Ratings</code> in the same way using <code>dplyr::recode()</code>. While we’re at it, we’ll make standardized versions of the predictors, too.</p>
<div class="sourceCode" id="cb2171"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2171-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb2171-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2171-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Rating   =</span> <span class="kw">recode</span>(Rating,</a>
<a class="sourceLine" id="cb2171-4" data-line-number="4">                           <span class="st">`</span><span class="dt">1.0</span><span class="st">`</span> =<span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb2171-5" data-line-number="5">                           <span class="st">`</span><span class="dt">1.5</span><span class="st">`</span> =<span class="st"> </span><span class="dv">2</span>,</a>
<a class="sourceLine" id="cb2171-6" data-line-number="6">                           <span class="st">`</span><span class="dt">2.0</span><span class="st">`</span> =<span class="st"> </span><span class="dv">3</span>,</a>
<a class="sourceLine" id="cb2171-7" data-line-number="7">                           <span class="st">`</span><span class="dt">2.5</span><span class="st">`</span> =<span class="st"> </span><span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2171-8" data-line-number="8">                           <span class="st">`</span><span class="dt">3.0</span><span class="st">`</span> =<span class="st"> </span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb2171-9" data-line-number="9">                           <span class="st">`</span><span class="dt">3.5</span><span class="st">`</span> =<span class="st"> </span><span class="dv">6</span>,</a>
<a class="sourceLine" id="cb2171-10" data-line-number="10">                           <span class="st">`</span><span class="dt">4.0</span><span class="st">`</span> =<span class="st"> </span><span class="dv">7</span>),</a>
<a class="sourceLine" id="cb2171-11" data-line-number="11">         <span class="dt">Year_s   =</span> (Year   <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Year))   <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(Year),</a>
<a class="sourceLine" id="cb2171-12" data-line-number="12">         <span class="dt">Length_s =</span> (Length <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Length)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(Length))</a></code></pre></div>
<p>Here’s a scatter plot of the data, with points colored by <code>Rating</code>.</p>
<div class="sourceCode" id="cb2172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2172-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2172-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Rating =</span> <span class="kw">factor</span>(Rating)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2172-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb2172-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Length)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2172-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Rating),</a>
<a class="sourceLine" id="cb2172-6" data-line-number="6">             <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2172-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Rating),</a>
<a class="sourceLine" id="cb2172-8" data-line-number="8">            <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2172-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2172-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-101-1.png" style="display: block; margin: auto;" /></p>
<p>Fitting the multivariable ordered-probit model with <strong>brms</strong> is about as simple as fitting any other multivariable model. Just tack on predictors with the <code>+</code> operator.</p>
<div class="sourceCode" id="cb2173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2173-1" data-line-number="1">fit23<span class="fl">.13</span> &lt;-</a>
<a class="sourceLine" id="cb2173-2" data-line-number="2"><span class="st">  </span><span class="kw">brm</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2173-3" data-line-number="3">      <span class="dt">family =</span> <span class="kw">cumulative</span>(probit),</a>
<a class="sourceLine" id="cb2173-4" data-line-number="4">      Rating <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Year_s <span class="op">+</span><span class="st"> </span>Length_s,</a>
<a class="sourceLine" id="cb2173-5" data-line-number="5">      <span class="dt">prior =</span> <span class="kw">c</span>(<span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> Intercept),</a>
<a class="sourceLine" id="cb2173-6" data-line-number="6">                <span class="kw">prior</span>(<span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">4</span>), <span class="dt">class =</span> b)),</a>
<a class="sourceLine" id="cb2173-7" data-line-number="7">      <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2173-8" data-line-number="8">      <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2173-9" data-line-number="9">      <span class="dt">file =</span> <span class="st">&quot;fits/fit23.13&quot;</span>)</a></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb2174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2174-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.13</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = identity 
## Formula: Rating ~ 1 + Year_s + Length_s 
##    Data: my_data (Number of observations: 100) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]    -1.69      0.20    -2.10    -1.30 1.00     6278     5749
## Intercept[2]    -0.92      0.15    -1.22    -0.63 1.00     8828     6906
## Intercept[3]    -0.22      0.14    -0.49     0.04 1.00     9497     7033
## Intercept[4]     0.61      0.14     0.34     0.88 1.00     8672     6636
## Intercept[5]     1.69      0.20     1.30     2.09 1.00     8388     6817
## Intercept[6]     2.58      0.37     1.95     3.39 1.00     8610     6190
## Year_s          -0.49      0.12    -0.73    -0.24 1.00     6986     6285
## Length_s         0.62      0.13     0.36     0.88 1.00     7117     6358
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract the posterior draws and compare the <strong>brms</strong> parameterization of <span class="math inline">\(\theta_{[i]}\)</span> with the parameterization in the text in an expanded version of the bottom panel of Figure 23.9.</p>
<div class="sourceCode" id="cb2176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2176-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2176-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.13</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2176-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb2176-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2176-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2176-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>, iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2176-7" data-line-number="7"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">6.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-103-1.png" style="display: block; margin: auto;" /></p>
<p>To sate any curiosity, here are the Pearson’s correlation coefficients for the parameters.</p>
<div class="sourceCode" id="cb2177"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2177-1" data-line-number="1"><span class="kw">vcov</span>(fit23<span class="fl">.13</span>, <span class="dt">correlation =</span> T) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">round</span>(<span class="dt">digits =</span> <span class="dv">2</span>)</a></code></pre></div>
<pre><code>##              Intercept[1] Intercept[2] Intercept[3] Intercept[4] Intercept[5] Intercept[6] Year_s Length_s
## Intercept[1]         1.00         0.51         0.26         0.10        -0.01         0.01   0.16    -0.21
## Intercept[2]         0.51         1.00         0.54         0.25         0.06         0.04   0.11    -0.20
## Intercept[3]         0.26         0.54         1.00         0.48         0.17         0.08   0.02    -0.06
## Intercept[4]         0.10         0.25         0.48         1.00         0.40         0.15  -0.12     0.16
## Intercept[5]        -0.01         0.06         0.17         0.40         1.00         0.38  -0.15     0.21
## Intercept[6]         0.01         0.04         0.08         0.15         0.38         1.00  -0.10     0.05
## Year_s               0.16         0.11         0.02        -0.12        -0.15        -0.10   1.00    -0.56
## Length_s            -0.21        -0.20        -0.06         0.16         0.21         0.05  -0.56     1.00</code></pre>
<p>Now behold the marginal distribution of our two effect-size parameters.</p>
<div class="sourceCode" id="cb2179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2179-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2179-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">ends_with</span>(<span class="st">&quot;_s&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2179-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name,</a>
<a class="sourceLine" id="cb2179-4" data-line-number="4">                       <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_Year_s&quot;</span>, <span class="st">&quot;b_Length_s&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2179-5" data-line-number="5"><span class="st">  </span></a>
<a class="sourceLine" id="cb2179-6" data-line-number="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2179-7" data-line-number="7"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2179-8" data-line-number="8">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2179-9" data-line-number="9">                     <span class="dt">breaks =</span> <span class="dv">40</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2179-10" data-line-number="10">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2179-11" data-line-number="11"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2179-12" data-line-number="12"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;effect size&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2179-13" data-line-number="13"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2179-14" data-line-number="14"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-105-1.png" style="display: block; margin: auto;" /></p>
<p>Before we make the top panel from Figure 23.9, I’d like to wander a bit and look at something related. We’ll use <code>fitted()</code>.</p>
<div class="sourceCode" id="cb2180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2180-1" data-line-number="1"><span class="co"># define the new data</span></a>
<a class="sourceLine" id="cb2180-2" data-line-number="2">nd &lt;-<span class="st"> </span><span class="kw">crossing</span>(<span class="dt">Year_s   =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.25</span>), </a>
<a class="sourceLine" id="cb2180-3" data-line-number="3">               <span class="dt">Length_s =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-3</span>, <span class="dt">to =</span> <span class="dv">3</span>, <span class="dt">by =</span> <span class="fl">0.25</span>))</a>
<a class="sourceLine" id="cb2180-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2180-5" data-line-number="5"><span class="co"># compute the `Response` probabilities</span></a>
<a class="sourceLine" id="cb2180-6" data-line-number="6">f &lt;-</a>
<a class="sourceLine" id="cb2180-7" data-line-number="7"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.13</span>,</a>
<a class="sourceLine" id="cb2180-8" data-line-number="8">         <span class="dt">newdata =</span> nd)</a>
<a class="sourceLine" id="cb2180-9" data-line-number="9"></a>
<a class="sourceLine" id="cb2180-10" data-line-number="10"><span class="co"># rearrange the output</span></a>
<a class="sourceLine" id="cb2180-11" data-line-number="11">f &lt;-</a>
<a class="sourceLine" id="cb2180-12" data-line-number="12"><span class="st">  </span><span class="kw">rbind</span>(</a>
<a class="sourceLine" id="cb2180-13" data-line-number="13">    f[, , <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2180-14" data-line-number="14">    f[, , <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2180-15" data-line-number="15">    f[, , <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2180-16" data-line-number="16">    f[, , <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2180-17" data-line-number="17">    f[, , <span class="dv">5</span>],</a>
<a class="sourceLine" id="cb2180-18" data-line-number="18">    f[, , <span class="dv">6</span>],</a>
<a class="sourceLine" id="cb2180-19" data-line-number="19">    f[, , <span class="dv">7</span>]</a>
<a class="sourceLine" id="cb2180-20" data-line-number="20">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2180-21" data-line-number="21"><span class="st">  </span><span class="co"># wrangle</span></a>
<a class="sourceLine" id="cb2180-22" data-line-number="22"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2180-23" data-line-number="23"><span class="st">  </span><span class="kw">bind_cols</span>(</a>
<a class="sourceLine" id="cb2180-24" data-line-number="24">    nd <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2180-25" data-line-number="25"><span class="st">      </span><span class="kw">expand</span>(<span class="dt">Rating =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">7</span>,</a>
<a class="sourceLine" id="cb2180-26" data-line-number="26">             <span class="kw">nesting</span>(Year_s, Length_s))</a>
<a class="sourceLine" id="cb2180-27" data-line-number="27">  )</a>
<a class="sourceLine" id="cb2180-28" data-line-number="28"></a>
<a class="sourceLine" id="cb2180-29" data-line-number="29"><span class="co"># what did we do?</span></a>
<a class="sourceLine" id="cb2180-30" data-line-number="30"><span class="kw">head</span>(f)</a></code></pre></div>
<pre><code>##     Estimate  Est.Error        Q2.5      Q97.5 Rating Year_s Length_s
## 1 0.11532071 0.07599288 0.019689571 0.30456668      1     -3    -3.00
## 2 0.08905917 0.06214321 0.014015527 0.24637847      1     -3    -2.75
## 3 0.06756787 0.05001020 0.009707207 0.19483558      1     -3    -2.50
## 4 0.05039363 0.03967474 0.006268840 0.15365951      1     -3    -2.25
## 5 0.03698018 0.03108531 0.004020302 0.12046791      1     -3    -2.00
## 6 0.02672997 0.02409835 0.002497780 0.09142248      1     -3    -1.75</code></pre>
<p>We just computed the response probabilities across the two-dimensional grid of the predictor values. Now plot using the posterior means.</p>
<div class="sourceCode" id="cb2182"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2182-1" data-line-number="1">f <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2182-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">strip =</span> <span class="kw">str_c</span>(<span class="st">&quot;Rating: &quot;</span>, Rating)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2182-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb2182-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year_s, <span class="dt">y =</span> Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> Estimate),</a>
<a class="sourceLine" id="cb2182-6" data-line-number="6">              <span class="dt">interpolate =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">strip =</span> <span class="kw">str_c</span>(<span class="st">&quot;Rating: &quot;</span>, Rating)),</a>
<a class="sourceLine" id="cb2182-8" data-line-number="8">            <span class="kw">aes</span>(<span class="dt">label =</span> Rating),</a>
<a class="sourceLine" id="cb2182-9" data-line-number="9">            <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="st">&quot;probability&quot;</span>, <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </a>
<a class="sourceLine" id="cb2182-11" data-line-number="11">                       <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">.5</span>, <span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;.5&quot;</span>, <span class="st">&quot;1&quot;</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-12" data-line-number="12"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-2</span>, <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">by =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb2182-13" data-line-number="13">                     <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-14" data-line-number="14"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-2</span>, <span class="dt">to =</span> <span class="dv">2</span>, <span class="dt">by =</span> <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb2182-15" data-line-number="15">                     <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-16" data-line-number="16"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2182-17" data-line-number="17"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>strip, <span class="dt">nrow =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-107-1.png" style="display: block; margin: auto;" /></p>
<p>This model didn’t do a great job capturing the <code>Response</code> probabilities. If you’re curious, you’ll find you can do a little bit better if you allow the two predictors to interact (i.e., add <code>+ Year_s:Length_s</code> to the <code>formula</code> line). Even then, the model isn’t great. I leave that as an exercise for the interested reader.</p>
<p>For this model, however, we will follow Kruschke and make a more faithful version of the top panel of Figure 23.9. We’ll need to wrangle our <code>post</code> data a bit to get things ready. Here’s the work.</p>
<div class="sourceCode" id="cb2183"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2183-1" data-line-number="1">post &lt;-</a>
<a class="sourceLine" id="cb2183-2" data-line-number="2"><span class="st">  </span>post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2183-3" data-line-number="3"><span class="st">  </span><span class="co"># we just need the data from three steps in the HMC chain</span></a>
<a class="sourceLine" id="cb2183-4" data-line-number="4"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2183-5" data-line-number="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.factor</span>(),</a>
<a class="sourceLine" id="cb2183-6" data-line-number="6">         <span class="dt">b1   =</span> b_Year_s,</a>
<a class="sourceLine" id="cb2183-7" data-line-number="7">         <span class="dt">b2   =</span> b_Length_s) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2183-8" data-line-number="8"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(iter, b1, b2, <span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[2]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[3]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[4]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[5]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb2183-9" data-line-number="9">         <span class="co"># because these are straight lines, two extreme x1-values are all we need</span></a>
<a class="sourceLine" id="cb2183-10" data-line-number="10">         <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2183-11" data-line-number="11"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">contains</span>(<span class="st">&quot;[&quot;</span>),</a>
<a class="sourceLine" id="cb2183-12" data-line-number="12">               <span class="dt">names_to =</span> <span class="st">&quot;theta&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2183-13" data-line-number="13"><span class="st">  </span><span class="co"># use Kruschke&#39;s Formula 23.5</span></a>
<a class="sourceLine" id="cb2183-14" data-line-number="14"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x2       =</span> (value <span class="op">/</span><span class="st"> </span>b2) <span class="op">+</span><span class="st"> </span>(<span class="op">-</span>b1 <span class="op">/</span><span class="st"> </span>b2) <span class="op">*</span><span class="st"> </span>x1,</a>
<a class="sourceLine" id="cb2183-15" data-line-number="15">         <span class="co"># this just renames our x variables for easy plotting</span></a>
<a class="sourceLine" id="cb2183-16" data-line-number="16">         <span class="dt">Year_s   =</span> x1,</a>
<a class="sourceLine" id="cb2183-17" data-line-number="17">         <span class="dt">Length_s =</span> x2) </a>
<a class="sourceLine" id="cb2183-18" data-line-number="18"></a>
<a class="sourceLine" id="cb2183-19" data-line-number="19"><span class="kw">glimpse</span>(post)</a></code></pre></div>
<pre><code>## Observations: 36
## Variables: 9
## $ iter     &lt;fct&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, …
## $ b1       &lt;dbl&gt; -0.5999177, -0.5999177, -0.5999177, -0.5999177, -0.5999177, -0.5999177, -0.5999177, -0.599…
## $ b2       &lt;dbl&gt; 0.5127384, 0.5127384, 0.5127384, 0.5127384, 0.5127384, 0.5127384, 0.5127384, 0.5127384, 0.…
## $ x1       &lt;dbl&gt; -10, -10, -10, -10, -10, -10, 10, 10, 10, 10, 10, 10, -10, -10, -10, -10, -10, -10, 10, 10…
## $ theta    &lt;chr&gt; &quot;b_Intercept[1]&quot;, &quot;b_Intercept[2]&quot;, &quot;b_Intercept[3]&quot;, &quot;b_Intercept[4]&quot;, &quot;b_Intercept[5]&quot;, …
## $ value    &lt;dbl&gt; -1.54348589, -0.86731565, -0.30290614, 0.71001624, 1.59991220, 2.72062779, -1.54348589, -0…
## $ x2       &lt;dbl&gt; -14.710549, -13.391806, -12.291031, -10.315516, -8.579941, -6.394195, 8.689989, 10.008733,…
## $ Year_s   &lt;dbl&gt; -10, -10, -10, -10, -10, -10, 10, 10, 10, 10, 10, 10, -10, -10, -10, -10, -10, -10, 10, 10…
## $ Length_s &lt;dbl&gt; -14.710549, -13.391806, -12.291031, -10.315516, -8.579941, -6.394195, 8.689989, 10.008733,…</code></pre>
<p>Now just plot.</p>
<div class="sourceCode" id="cb2185"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2185-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2185-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year_s, <span class="dt">y =</span> Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2185-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(iter, theta), <span class="dt">color =</span> theta, <span class="dt">linetype =</span> iter)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2185-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2185-5" data-line-number="5">            <span class="kw">aes</span>(<span class="dt">label =</span> Rating)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2185-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="kw">expression</span>(theta), <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">end =</span> <span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb2185-7" data-line-number="7">                        <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2185-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Year_s),</a>
<a class="sourceLine" id="cb2185-9" data-line-number="9">                  <span class="dt">ylim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2185-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-110-1.png" style="display: block; margin: auto;" /></p>
<p>It might be easier to see Kruschke’s main point if we facet by <code>iter</code>.</p>
<div class="sourceCode" id="cb2186"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2186-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2186-2" data-line-number="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year_s, <span class="dt">y =</span> Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2186-3" data-line-number="3"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(iter, theta), <span class="dt">color =</span> theta, <span class="dt">linetype =</span> iter)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2186-4" data-line-number="4"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2186-5" data-line-number="5">            <span class="kw">aes</span>(<span class="dt">label =</span> Rating)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2186-6" data-line-number="6"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="kw">expression</span>(theta), <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">end =</span> <span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb2186-7" data-line-number="7">                        <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2186-8" data-line-number="8"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Year_s),</a>
<a class="sourceLine" id="cb2186-9" data-line-number="9">                  <span class="dt">ylim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2186-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</a>
<a class="sourceLine" id="cb2186-11" data-line-number="11">        <span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">75</span>, <span class="fl">.25</span>),</a>
<a class="sourceLine" id="cb2186-12" data-line-number="12">        <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2186-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>iter, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-111-1.png" style="display: block; margin: auto;" /></p>
<p>Both our versions of the plot show what Kruschke pointed out in the text:</p>
<blockquote>
<p>Threshold lines from the same step in the chain must be parallel because the regression coefficients are constant at that step, but are different at another step. The threshold lines in Figure 23.9 are level contours on the underlying metric planar surface, and the lines reveal that the ratings increase toward the top left, that is, as <span class="math inline">\(x_1\)</span> decreases and <span class="math inline">\(x_2\)</span> increases. (p. 693)</p>
</blockquote>
<p>Before we move on to the next section, what these diagonal 2-dimensional threshold lines also hint at is that when we use two predictors to describe ordinal data as having been produces by an underlying unit Gaussian distribution, that underlying distribution is actually bivariate Gaussian. Here we’ll use <code>fitted()</code> one more time to depict that bivariate-Gaussian distribution with a little <code>geom_raster()</code>.</p>
<div class="sourceCode" id="cb2187"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2187-1" data-line-number="1"><span class="co"># define the new data</span></a>
<a class="sourceLine" id="cb2187-2" data-line-number="2">nd &lt;-<span class="st"> </span><span class="kw">crossing</span>(<span class="dt">Year_s   =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.1</span>), </a>
<a class="sourceLine" id="cb2187-3" data-line-number="3">               <span class="dt">Length_s =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-5</span>, <span class="dt">to =</span> <span class="dv">5</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb2187-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2187-5" data-line-number="5"><span class="kw">fitted</span>(fit23<span class="fl">.13</span>,</a>
<a class="sourceLine" id="cb2187-6" data-line-number="6">       <span class="dt">newdata =</span> nd,</a>
<a class="sourceLine" id="cb2187-7" data-line-number="7">       <span class="co"># this will yield z-scores</span></a>
<a class="sourceLine" id="cb2187-8" data-line-number="8">       <span class="dt">scale =</span> <span class="st">&quot;linear&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2187-9" data-line-number="9"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2187-10" data-line-number="10"><span class="st">  </span><span class="kw">bind_cols</span>(nd) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2187-11" data-line-number="11"><span class="st">  </span><span class="co"># convert the z-scores to density values</span></a>
<a class="sourceLine" id="cb2187-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">density =</span> <span class="kw">dnorm</span>(Estimate, <span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2187-13" data-line-number="13"></a>
<a class="sourceLine" id="cb2187-14" data-line-number="14"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year_s, <span class="dt">y =</span> Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2187-15" data-line-number="15"><span class="st">  </span><span class="kw">geom_raster</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> density),</a>
<a class="sourceLine" id="cb2187-16" data-line-number="16">              <span class="dt">interpolate =</span> T) <span class="op">+</span></a>
<a class="sourceLine" id="cb2187-17" data-line-number="17"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2187-18" data-line-number="18">            <span class="kw">aes</span>(<span class="dt">label =</span> Rating),</a>
<a class="sourceLine" id="cb2187-19" data-line-number="19">            <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2187-20" data-line-number="20"><span class="st">  </span><span class="kw">scale_fill_viridis_c</span>(<span class="st">&quot;density&quot;</span>, <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2187-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2187-22" data-line-number="22"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) </a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-112-1.png" style="display: block; margin: auto;" /></p>
<p>As with many of our previous approaches with <code>geom_raster()</code>, this plot is based on the posterior means in each cell and, therefore, does a poor job depicting the uncertainty in the posterior distribution.</p>
</div>
<div id="why-are-some-thresholds-outside-the-data" class="section level3">
<h3><span class="header-section-number">23.4.4</span> Why are some thresholds outside the data?</h3>
<p>Now load Kruschke’s simulated data.</p>
<div class="sourceCode" id="cb2188"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2188-1" data-line-number="1">my_data &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data.R/OrdinalProbitData-Movies.csv&quot;</span>)</a>
<a class="sourceLine" id="cb2188-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2188-3" data-line-number="3"><span class="kw">glimpse</span>(my_data)</a></code></pre></div>
<pre><code>## Observations: 400
## Variables: 3
## $ Year   &lt;dbl&gt; 1959, 1946, 1964, 1938, 1946, 1971, 1957, 1970, 1968, 1962, 1929, 1962, 1978, 1972, 1964, 19…
## $ Length &lt;dbl&gt; 88, 117, 130, 85, 111, 105, 93, 119, 78, 77, 138, 107, 70, 60, 138, 122, 72, 109, 71, 61, 60…
## $ Rating &lt;dbl&gt; 4, 5, 5, 4, 5, 4, 3, 4, 3, 3, 7, 4, 2, 2, 5, 5, 3, 4, 3, 2, 2, 3, 5, 3, 5, 5, 5, 4, 5, 4, 4,…</code></pre>
<blockquote>
<p>These data imitate the movie ratings, but with two key differences. First and foremost, the artificial data have much smaller noise, with <span class="math inline">\(\sigma = 0.20\)</span> as opposed to <span class="math inline">\(\sigma \approx 1.25\)</span> in the real data. Second, the artificial data have points that span the entire range of both predictors, unlike the real data which had points mostly in the central region. (p. 695)</p>
</blockquote>
<p>Like with the real movie data, we’ll inspect these data with a colored scatter plot.</p>
<div class="sourceCode" id="cb2190"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2190-1" data-line-number="1">my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2190-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Rating =</span> <span class="kw">factor</span>(Rating)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2190-3" data-line-number="3"><span class="st">  </span></a>
<a class="sourceLine" id="cb2190-4" data-line-number="4"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Length)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2190-5" data-line-number="5"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">color =</span> Rating),</a>
<a class="sourceLine" id="cb2190-6" data-line-number="6">             <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2190-7" data-line-number="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> Rating),</a>
<a class="sourceLine" id="cb2190-8" data-line-number="8">            <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2190-9" data-line-number="9"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb2190-10" data-line-number="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-114-1.png" style="display: block; margin: auto;" /></p>
<p>Unlike in last section, there appears to be a clear trend in Kruschke’s simulated data. Kruschke’s simulated critic liked his movies old and long. Time to standardize the predictors.</p>
<div class="sourceCode" id="cb2191"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2191-1" data-line-number="1">my_data &lt;-</a>
<a class="sourceLine" id="cb2191-2" data-line-number="2"><span class="st">  </span>my_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2191-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year_s   =</span> (Year   <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Year))   <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(Year),</a>
<a class="sourceLine" id="cb2191-4" data-line-number="4">         <span class="dt">Length_s =</span> (Length <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(Length)) <span class="op">/</span><span class="st"> </span><span class="kw">sd</span>(Length))</a></code></pre></div>
<p>Fitting the multivariable ordered-probit model with <strong>brms</strong> is about as simple as fitting any other multivariable model. Just tack on predictors with the <code>+</code> operator.</p>
<div class="sourceCode" id="cb2192"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2192-1" data-line-number="1">fit23<span class="fl">.14</span> &lt;-</a>
<a class="sourceLine" id="cb2192-2" data-line-number="2"><span class="st">  </span><span class="kw">update</span>(fit23<span class="fl">.13</span>,</a>
<a class="sourceLine" id="cb2192-3" data-line-number="3">         <span class="dt">newdata =</span> my_data,</a>
<a class="sourceLine" id="cb2192-4" data-line-number="4">         <span class="dt">iter =</span> <span class="dv">3000</span>, <span class="dt">warmup =</span> <span class="dv">1000</span>, <span class="dt">chains =</span> <span class="dv">4</span>, <span class="dt">cores =</span> <span class="dv">4</span>,</a>
<a class="sourceLine" id="cb2192-5" data-line-number="5">         <span class="dt">seed =</span> <span class="dv">23</span>,</a>
<a class="sourceLine" id="cb2192-6" data-line-number="6">         <span class="dt">file =</span> <span class="st">&quot;fits/fit23.14&quot;</span>)</a></code></pre></div>
<p>Check the model summary.</p>
<div class="sourceCode" id="cb2193"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2193-1" data-line-number="1"><span class="kw">print</span>(fit23<span class="fl">.14</span>)</a></code></pre></div>
<pre><code>##  Family: cumulative 
##   Links: mu = probit; disc = identity 
## Formula: Rating ~ 1 + Year_s + Length_s 
##    Data: my_data (Number of observations: 400) 
## Samples: 4 chains, each with iter = 3000; warmup = 1000; thin = 1;
##          total post-warmup samples = 8000
## 
## Population-Level Effects: 
##              Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
## Intercept[1]    -9.79      0.68   -11.17    -8.51 1.00     1604     2263
## Intercept[2]    -5.98      0.43    -6.86    -5.17 1.00     1803     2365
## Intercept[3]    -2.25      0.21    -2.68    -1.84 1.00     2880     4416
## Intercept[4]     2.42      0.21     2.03     2.85 1.00     2606     4081
## Intercept[5]     7.80      0.55     6.74     8.92 1.00     1721     2456
## Intercept[6]    10.89      0.76     9.45    12.45 1.00     1778     2322
## Year_s          -2.80      0.20    -3.20    -2.41 1.00     1699     2504
## Length_s         4.74      0.32     4.14     5.39 1.00     1627     2261
## 
## Samples were drawn using sampling(NUTS). For each parameter, Bulk_ESS
## and Tail_ESS are effective sample size measures, and Rhat is the potential
## scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
<p>Extract the posterior draws and use <code>compare_thresholds()</code> to make our expanded version of the bottom panel of Figure 23.10.</p>
<div class="sourceCode" id="cb2195"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2195-1" data-line-number="1">post &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2195-2" data-line-number="2"><span class="st">  </span><span class="kw">posterior_samples</span>(fit23<span class="fl">.14</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2195-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>())</a>
<a class="sourceLine" id="cb2195-4" data-line-number="4"></a>
<a class="sourceLine" id="cb2195-5" data-line-number="5">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2195-6" data-line-number="6"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>, iter) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2195-7" data-line-number="7"><span class="st">  </span><span class="kw">compare_thresholds</span>(<span class="dt">lb =</span> <span class="fl">1.5</span>, <span class="dt">ub =</span> <span class="fl">6.5</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-117-1.png" style="display: block; margin: auto;" /></p>
<p>Make the marginal distribution of our two effect-size parameters.</p>
<div class="sourceCode" id="cb2196"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2196-1" data-line-number="1">post <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2196-2" data-line-number="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">ends_with</span>(<span class="st">&quot;_s&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2196-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">name =</span> <span class="kw">factor</span>(name, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;b_Year_s&quot;</span>, <span class="st">&quot;b_Length_s&quot;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2196-4" data-line-number="4"><span class="st">  </span></a>
<a class="sourceLine" id="cb2196-5" data-line-number="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> value, <span class="dt">y =</span> <span class="dv">0</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2196-6" data-line-number="6"><span class="st">  </span><span class="kw">stat_histintervalh</span>(<span class="dt">point_interval =</span> mode_hdi, <span class="dt">.width =</span> <span class="fl">.95</span>,</a>
<a class="sourceLine" id="cb2196-7" data-line-number="7">                     <span class="dt">fill =</span> <span class="st">&quot;grey67&quot;</span>, <span class="dt">slab_color =</span> <span class="st">&quot;grey92&quot;</span>,</a>
<a class="sourceLine" id="cb2196-8" data-line-number="8">                     <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">slab_size =</span> <span class="fl">.25</span>, <span class="dt">outline_bars =</span> T,</a>
<a class="sourceLine" id="cb2196-9" data-line-number="9">                     <span class="dt">normalize =</span> <span class="st">&quot;panels&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2196-10" data-line-number="10"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="ot">NULL</span>, <span class="dt">breaks =</span> <span class="ot">NULL</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2196-11" data-line-number="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;effect size&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2196-12" data-line-number="12"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()) <span class="op">+</span></a>
<a class="sourceLine" id="cb2196-13" data-line-number="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>name, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>)</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-118-1.png" style="display: block; margin: auto;" /></p>
<p>Make the top panel for Figure 23.10 just like we did for its analogue in Figure 23.9.</p>
<div class="sourceCode" id="cb2197"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2197-1" data-line-number="1"><span class="co"># extract the posterior draws and wrangle</span></a>
<a class="sourceLine" id="cb2197-2" data-line-number="2"><span class="kw">posterior_samples</span>(fit23<span class="fl">.14</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2197-3" data-line-number="3"><span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2197-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">iter =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">n</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.factor</span>(),</a>
<a class="sourceLine" id="cb2197-5" data-line-number="5">         <span class="dt">b1   =</span> b_Year_s,</a>
<a class="sourceLine" id="cb2197-6" data-line-number="6">         <span class="dt">b2   =</span> b_Length_s) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2197-7" data-line-number="7"><span class="st">  </span><span class="kw">expand</span>(<span class="kw">nesting</span>(iter, b1, b2, <span class="st">`</span><span class="dt">b_Intercept[1]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[2]</span><span class="st">`</span>, </a>
<a class="sourceLine" id="cb2197-8" data-line-number="8">                 <span class="st">`</span><span class="dt">b_Intercept[3]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[4]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[5]</span><span class="st">`</span>, <span class="st">`</span><span class="dt">b_Intercept[6]</span><span class="st">`</span>),</a>
<a class="sourceLine" id="cb2197-9" data-line-number="9">         <span class="dt">x1 =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2197-10" data-line-number="10"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">contains</span>(<span class="st">&quot;[&quot;</span>),</a>
<a class="sourceLine" id="cb2197-11" data-line-number="11">               <span class="dt">names_to =</span> <span class="st">&quot;theta&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2197-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">x2       =</span> (value <span class="op">/</span><span class="st"> </span>b2) <span class="op">+</span><span class="st"> </span>(<span class="op">-</span>b1 <span class="op">/</span><span class="st"> </span>b2) <span class="op">*</span><span class="st"> </span>x1,</a>
<a class="sourceLine" id="cb2197-13" data-line-number="13">         <span class="dt">Year_s   =</span> x1,</a>
<a class="sourceLine" id="cb2197-14" data-line-number="14">         <span class="dt">Length_s =</span> x2) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2197-15" data-line-number="15"><span class="st">  </span></a>
<a class="sourceLine" id="cb2197-16" data-line-number="16"><span class="st">  </span><span class="co"># plot!</span></a>
<a class="sourceLine" id="cb2197-17" data-line-number="17"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Year_s, <span class="dt">y =</span> Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2197-18" data-line-number="18"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> <span class="kw">interaction</span>(iter, theta), <span class="dt">color =</span> theta, <span class="dt">linetype =</span> iter)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2197-19" data-line-number="19"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> my_data,</a>
<a class="sourceLine" id="cb2197-20" data-line-number="20">            <span class="kw">aes</span>(<span class="dt">label =</span> Rating)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2197-21" data-line-number="21"><span class="st">  </span><span class="kw">scale_color_viridis_d</span>(<span class="kw">expression</span>(theta), <span class="dt">option =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">end =</span> <span class="fl">.9</span>,</a>
<a class="sourceLine" id="cb2197-22" data-line-number="22">                        <span class="dt">labels =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb2197-23" data-line-number="23"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Year_s),</a>
<a class="sourceLine" id="cb2197-24" data-line-number="24">                  <span class="dt">ylim =</span> <span class="kw">range</span>(my_data<span class="op">$</span>Length_s)) <span class="op">+</span></a>
<a class="sourceLine" id="cb2197-25" data-line-number="25"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-119-1.png" style="display: block; margin: auto;" /></p>
<p>Those are some tight thresholds. They “very clearly cleave parallel regions of distinct ordinal values. The example demonstrates that the threshold lines <em>do</em> make intuitive sense when there is low noise and a broad range of data” (p. 695, <em>emphasis</em> in the original).</p>
<p>With our various bonus plots, we’ve been anticipating Figure 23.11 for some time, now. The thresholds from <code>fit23.14</code> result in beautifully nonlinear probability curves for the <code>Rating</code> levels. Take a quick look with <code>conditional_effects()</code>.</p>
<div class="sourceCode" id="cb2198"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2198-1" data-line-number="1"><span class="kw">conditional_effects</span>(fit23<span class="fl">.14</span>, <span class="dt">categorical =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2198-2" data-line-number="2"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-120-1.png" style="display: block; margin: auto;" /><img src="23_files/figure-gfm/unnamed-chunk-120-2.png" style="display: block; margin: auto;" /></p>
<p>Because the model had two predictors, we got two plots. What <code>brms::conditional_effects()</code> called <code>Probability</code> on the y-axis is the same as what Kruschke called <span class="math inline">\(p(y)\)</span> on his. Rather than generic predictors <span class="math inline">\(x\)</span> on the x-axis, our plots had either <code>Year_s</code> or <code>Length_s</code>. Whereas Kruschke marked off his different outcomes by line styles, ours were marked by color. Since we don’t have the data Kruschke used to make Figure 23.11, we won’t be able to reproduce it exactly. However, you’ll note that our plot for <code>Length_s</code> corresponded nicely with his subplot on the top (i.e., the one for which <span class="math inline">\(\sigma = 0.1\)</span>). If we set <code>effects = &quot;Length_s&quot;</code>, we can use <code>conditional_effects()</code> to make a similar plot to Kruschke’s subplot for which <span class="math inline">\(\sigma = 1\)</span>.</p>
<div class="sourceCode" id="cb2199"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2199-1" data-line-number="1"><span class="kw">conditional_effects</span>(fit23<span class="fl">.13</span>, </a>
<a class="sourceLine" id="cb2199-2" data-line-number="2">                    <span class="dt">categorical =</span> T, </a>
<a class="sourceLine" id="cb2199-3" data-line-number="3">                    <span class="dt">effects =</span> <span class="st">&quot;Length_s&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2199-4" data-line-number="4"><span class="st">  </span><span class="kw">plot</span>(<span class="dt">theme =</span> <span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>()))</a></code></pre></div>
<p><img src="23_files/figure-gfm/unnamed-chunk-121-1.png" style="display: block; margin: auto;" /></p>
<p>“You can see that each outcome has maximum probability within its corresponding interval, but there is considerable smearing of outcomes into adjacent intervals” (p. 695).</p>
<p>Finishing off, Kruschke’s discussion in the text</p>
<blockquote>
<p>referred to <span class="math inline">\(\sigma\)</span> as “noise” merely for linguistic ease. Calling the outcomes “noisy” does not mean the underlying generator of the outcomes is inherently wildly random. <em>The “noise” is merely variation in the outcome that cannot be accounted for by the particular model we have chosen with the particular predictors we have chosen</em>. A different model and/or different predictors might account for the outcomes well with little residual noise. In this sense, the noise is in the model, not in the data. (p. 698, <em>emphasis</em> in the original)</p>
</blockquote>
<p>Through this lens, noisy-looking data are a symptom of weak theory and/or poor data-collection methods.</p>
</div>
</div>
<div id="posterior-prediction" class="section level2">
<h2><span class="header-section-number">23.5</span> Posterior prediction</h2>
<p>The cumulative-normal model makes posterior predictions for the probabilities of the <span class="math inline">\(K\)</span> categories in the criterion variable by computing <span class="math inline">\(p (y | \mu (x), \sigma, \{ \theta_k \} )\)</span> in each step in the HMC chain. In this equation, <span class="math inline">\(\mu (x) = \beta_0 + \sum_j \beta_j x_j\)</span>. Though recall that with our <strong>brms</strong> parameterization, we have <span class="math inline">\(\beta_0\)</span> fixed at 0. Kruschke framed part of his discussion in this chapter in terms of a single-predictor model, such as was entertained in Figure 23.8. Recall that corresponds to our <code>fit11</code>. Here’s that <code>formula</code>.</p>
<div class="sourceCode" id="cb2200"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2200-1" data-line-number="1">fit23<span class="fl">.11</span><span class="op">$</span>formula</a></code></pre></div>
<pre><code>## Happiness ~ 1 + Assets_s</code></pre>
<p>With <strong>brms</strong>, you can get this information with <code>fitted()</code>. Let’s say we wanted to focus on response probabilities for <code>Assets_s = -1)</code>. Here’s what we get.</p>
<div class="sourceCode" id="cb2202"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2202-1" data-line-number="1"><span class="kw">fitted</span>(fit23<span class="fl">.11</span>, </a>
<a class="sourceLine" id="cb2202-2" data-line-number="2">       <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">Assets_s =</span> <span class="dv">-1</span>))</a></code></pre></div>
<pre><code>## , , 1
## 
##        Estimate  Est.Error       Q2.5      Q97.5
## [1,] 0.02995493 0.00241341 0.02533022 0.03491371
## 
## , , 2
## 
##       Estimate   Est.Error      Q2.5     Q97.5
## [1,] 0.1247132 0.004739187 0.1154823 0.1341841
## 
## , , 3
## 
##       Estimate   Est.Error      Q2.5     Q97.5
## [1,] 0.3437033 0.006293002 0.3313739 0.3561012
## 
## , , 4
## 
##       Estimate   Est.Error      Q2.5     Q97.5
## [1,] 0.4503483 0.007018188 0.4365616 0.4639018
## 
## , , 5
## 
##        Estimate   Est.Error       Q2.5      Q97.5
## [1,] 0.05128031 0.002880035 0.04573983 0.05720883</code></pre>
<p>As is typical of <strong>brms</strong>, those probability summaries were in terms of the posterior mean and percentile-based 95% intervals. If you’re like Kruschke and prefer posterior modes and HDIs, you’ll need to set <code>summary = F</code> and wrangle a bit.</p>
<div class="sourceCode" id="cb2204"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2204-1" data-line-number="1">f &lt;-</a>
<a class="sourceLine" id="cb2204-2" data-line-number="2"><span class="st">  </span><span class="kw">fitted</span>(fit23<span class="fl">.11</span>, </a>
<a class="sourceLine" id="cb2204-3" data-line-number="3">         <span class="dt">newdata =</span> <span class="kw">tibble</span>(<span class="dt">Assets_s =</span> <span class="dv">-1</span>),</a>
<a class="sourceLine" id="cb2204-4" data-line-number="4">         <span class="dt">summary =</span> F)</a>
<a class="sourceLine" id="cb2204-5" data-line-number="5"></a>
<a class="sourceLine" id="cb2204-6" data-line-number="6"><span class="kw">cbind</span>(</a>
<a class="sourceLine" id="cb2204-7" data-line-number="7">  f[, , <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb2204-8" data-line-number="8">  f[, , <span class="dv">2</span>],</a>
<a class="sourceLine" id="cb2204-9" data-line-number="9">  f[, , <span class="dv">3</span>],</a>
<a class="sourceLine" id="cb2204-10" data-line-number="10">  f[, , <span class="dv">4</span>],</a>
<a class="sourceLine" id="cb2204-11" data-line-number="11">  f[, , <span class="dv">5</span>]</a>
<a class="sourceLine" id="cb2204-12" data-line-number="12">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2204-13" data-line-number="13"><span class="st">  </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2204-14" data-line-number="14"><span class="st">  </span><span class="kw">set_names</span>(<span class="kw">str_c</span>(<span class="st">&quot;p(Happiness = &quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="st">&quot; | Assets_s = -1)&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2204-15" data-line-number="15"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="kw">everything</span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2204-16" data-line-number="16"><span class="st">  </span><span class="kw">group_by</span>(name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2204-17" data-line-number="17"><span class="st">  </span><span class="kw">mode_hdi</span>(value) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb2204-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate_if</span>(is.double, round, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 7
##   name                              value .lower .upper .width .point .interval
##   &lt;chr&gt;                             &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;    
## 1 p(Happiness = 1 | Assets_s = -1) 0.03   0.0252 0.0347   0.95 mode   hdi      
## 2 p(Happiness = 2 | Assets_s = -1) 0.125  0.115  0.134    0.95 mode   hdi      
## 3 p(Happiness = 3 | Assets_s = -1) 0.342  0.332  0.356    0.95 mode   hdi      
## 4 p(Happiness = 4 | Assets_s = -1) 0.451  0.437  0.464    0.95 mode   hdi      
## 5 p(Happiness = 5 | Assets_s = -1) 0.0514 0.0453 0.0566   0.95 mode   hdi</code></pre>
</div>
<div id="generalizations-and-extensions" class="section level2">
<h2><span class="header-section-number">23.6</span> Generalizations and extensions</h2>
<p>In this section, Kruschke mentioned extensions of this class of models might include using the cumulative <span class="math inline">\(t\)</span> function to handle outliers or adding a guessing parameter. Full disclosure: I have not fit models like these. Based on my knowledge of <strong>brms</strong>, I suspect they’re possible. For insights how, you might review Bürkner’s <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_customfamilies.html"><em>Define Custom Response Distributions with brms</em></a> and <a href="https://cran.r-project.org/web/packages/brms/vignettes/brms_nonlinear.html"><em>Estimating Non-Linear Models with brms</em></a> vignettes.</p>
<p>In addition, there are other likelihoods one might use to model ordinal data using <strong>brms</strong>. Your first stop should be Bürkner and Vourre’s <a href="https://psyarxiv.com/x8swp/"><em>Ordinal Regression Models in Psychology: A Tutorial</em></a>, where, in addition to the cumulative normal model, they cover the sequential and adjacent category models. You might also check out <a href="https://bookdown.org/connect/#/apps/1850/access">Chapter 11</a> of my project recoding McElreath’s <a href="https://xcelab.net/rm/statistical-rethinking/"><em>Statistical Rethinking</em></a> text, wherein I show how one might use the logit link (i.e., <code>family = cumulative(logit)</code>) to fit ordered-categorical models with <strong>brms</strong>.</p>
</div>
<div id="reference-22" class="section level2 unnumbered">
<h2>Reference</h2>
<p><a href="https://sites.google.com/site/doingbayesiandataanalysis/">Kruschke, J. K. (2015). <em>Doing Bayesian data analysis, Second Edition: A tutorial with R, JAGS, and Stan.</em> Burlington, MA: Academic Press/Elsevier.</a></p>
</div>
<div id="session-info-22" class="section level2 unnumbered">
<h2>Session info</h2>
<div class="sourceCode" id="cb2206"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2206-1" data-line-number="1"><span class="kw">sessionInfo</span>()</a></code></pre></div>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-apple-darwin15.6.0 (64-bit)
## Running under: macOS High Sierra 10.13.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] tidybayes_2.0.1.9000 brms_2.11.5          Rcpp_1.0.3           patchwork_1.0.0      forcats_0.4.0       
##  [6] stringr_1.4.0        dplyr_0.8.4          purrr_0.3.3          readr_1.3.1          tidyr_1.0.2         
## [11] tibble_2.1.3         ggplot2_3.2.1        tidyverse_1.3.0     
## 
## loaded via a namespace (and not attached):
##   [1] colorspace_1.4-1          ellipsis_0.3.0            ggridges_0.5.2            rsconnect_0.8.16         
##   [5] markdown_1.1              base64enc_0.1-3           fs_1.3.1                  rstudioapi_0.10          
##   [9] farver_2.0.3              rstan_2.19.2              svUnit_0.7-12             DT_0.11                  
##  [13] fansi_0.4.1               mvtnorm_1.0-12            lubridate_1.7.4           xml2_1.2.2               
##  [17] bridgesampling_0.8-1      knitr_1.26                shinythemes_1.1.2         bayesplot_1.7.1          
##  [21] jsonlite_1.6.1            broom_0.5.3               dbplyr_1.4.2              shiny_1.4.0              
##  [25] compiler_3.6.2            httr_1.4.1                backports_1.1.5           assertthat_0.2.1         
##  [29] Matrix_1.2-18             fastmap_1.0.1             lazyeval_0.2.2            cli_2.0.1                
##  [33] later_1.0.0               htmltools_0.4.0           prettyunits_1.1.1         tools_3.6.2              
##  [37] igraph_1.2.4.2            coda_0.19-3               gtable_0.3.0              glue_1.3.1               
##  [41] reshape2_1.4.3            cellranger_1.1.0          vctrs_0.2.2               nlme_3.1-142             
##  [45] crosstalk_1.0.0           xfun_0.12                 ps_1.3.0                  rvest_0.3.5              
##  [49] mime_0.8                  miniUI_0.1.1.1            lifecycle_0.1.0           gtools_3.8.1             
##  [53] zoo_1.8-7                 scales_1.1.0              colourpicker_1.0          hms_0.5.3                
##  [57] promises_1.1.0            Brobdingnag_1.2-6         parallel_3.6.2            inline_0.3.15            
##  [61] shinystan_2.5.0           yaml_2.2.1                gridExtra_2.3             loo_2.2.0                
##  [65] StanHeaders_2.19.0        stringi_1.4.5             dygraphs_1.1.1.6          pkgbuild_1.0.6           
##  [69] rlang_0.4.4               pkgconfig_2.0.3           matrixStats_0.55.0        HDInterval_0.2.0         
##  [73] evaluate_0.14             lattice_0.20-38           rstantools_2.0.0          htmlwidgets_1.5.1        
##  [77] labeling_0.3              tidyselect_1.0.0          processx_3.4.1            plyr_1.8.5               
##  [81] magrittr_1.5              R6_2.4.1                  generics_0.0.2            DBI_1.1.0                
##  [85] pillar_1.4.3              haven_2.2.0               withr_2.1.2               xts_0.12-0               
##  [89] abind_1.4-5               modelr_0.1.5              crayon_1.3.4              arrayhelpers_1.0-20160527
##  [93] utf8_1.1.4                rmarkdown_2.0             grid_3.6.2                readxl_1.3.1             
##  [97] callr_3.4.1               threejs_0.3.3             reprex_0.3.0              digest_0.6.23            
## [101] xtable_1.8-4              httpuv_1.5.2              stats4_3.6.2              munsell_0.5.0            
## [105] viridisLite_0.3.0         shinyjs_1.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="nominal-predicted-variable.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="count-predicted-variable.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
